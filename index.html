<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Courtside Liberia - Promoting Excellence in Liberian Basketball</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #0f1b3c 0%, #1a237e 100%);
            --secondary-gradient: linear-gradient(45deg, #2196F3, #1976D2);
            --accent-color: #FF6B35;
            --text-light: #ffffff;
            --text-dark: #333333;
            --card-bg: rgba(255, 255, 255, 0.1);
            --card-hover-bg: rgba(255, 255, 255, 0.15);
            --border-radius: 16px;
            --box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--primary-gradient);
            color: var(--text-light);
            line-height: 1.6;
        }
        /* Stage Indicators */
        .stage-indicator {
            display: inline-block;
            padding: 0.3rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .stage-completed {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
        }
        .stage-ongoing {
            background: linear-gradient(45deg, #FF9800, #F57C00);
            color: white;
            animation: pulse 2s infinite;
        }
        .stage-upcoming {
            background: linear-gradient(45deg, #2196F3, #1976D2);
            color: white;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        /* Progress Timeline */
        .progress-timeline {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 2rem 0;
            padding: 2rem;
            background: var(--card-bg);
            border-radius: var(--border-radius);
            position: relative;
        }
        .progress-timeline::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 5%;
            right: 5%;
            height: 4px;
            background: linear-gradient(90deg, #4CAF50, #FF9800, #2196F3);
            border-radius: 2px;
            z-index: 1;
        }
        .timeline-stage {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            background: var(--primary-gradient);
            padding: 1rem;
            border-radius: 50%;
            z-index: 2;
            position: relative;
            min-width: 100px;
            text-align: center;
        }
        .timeline-icon {
            font-size: 1.5rem;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 0.5rem;
        }
        .timeline-completed .timeline-icon {
            background: #4CAF50;
        }
        .timeline-active .timeline-icon {
            background: #FF9800;
            animation: pulse 2s infinite;
        }
        .timeline-upcoming .timeline-icon {
            background: rgba(255, 255, 255, 0.2);
        }
        /* Header & Navigation */
        .header {
            background: rgba(15, 27, 60, 0.95);
            backdrop-filter: blur(20px);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            padding: 1rem 0;
            box-shadow: var(--box-shadow);
        }
        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        .logo {
            width: 50px;
            height: 50px;
            background: var(--secondary-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            transition: transform 0.3s ease;
            overflow: hidden;
        }
        .logo:hover {
            transform: scale(1.1);
        }
        .logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }
        .site-title {
            font-size: 1.5rem;
            font-weight: bold;
            background: linear-gradient(45deg, #ffffff, #64B5F6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .nav-menu {
            display: flex;
            list-style: none;
            gap: 2rem;
            align-items: center;
        }
        .nav-item a {
            color: var(--text-light);
            text-decoration: none;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 500;
        }
        .nav-item a:hover,
        .nav-item a.active {
            background: var(--card-bg);
            transform: translateY(-2px);
        }
        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }
        .admin-btn {
            background: var(--secondary-gradient);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            display: none;
        }
        .admin-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(33, 150, 243, 0.3);
        }
        body.admin-mode .admin-btn {
            display: block;
        }
        /* Hero Section */
        .hero {
            margin-top: 80px;
            background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.5)), 
                        url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 600'%3E%3Crect fill='%23001122' width='1200' height='600'/%3E%3Ccircle cx='600' cy='300' r='80' fill='none' stroke='%23ffffff' stroke-width='2' opacity='0.1'/%3E%3Ccircle cx='600' cy='300' r='120' fill='none' stroke='%23FF6B35' stroke-width='3' opacity='0.3'/%3E%3Cpath d='M300,50 L300,550 M900,50 L900,550 M200,150 L1000,150 M200,450 L1000,450' stroke='%23ffffff' stroke-width='1' opacity='0.1'/%3E%3C/svg%3E");
            background-size: cover;
            background-position: center;
            text-align: center;
            padding: 4rem 0 6rem;
        }
        .hero-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }
        .hero h1 {
            font-size: clamp(2.5rem, 6vw, 4rem);
            margin-bottom: 1rem;
            background: linear-gradient(45deg, #ffffff, #FF6B35, #2196F3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
        }
        .hero-subtitle {
            font-size: clamp(1.2rem, 3vw, 1.5rem);
            margin-bottom: 2rem;
            opacity: 0.9;
        }
        .cover-photo {
            max-width: 100%;
            width: 800px;
            height: 300px;
            margin: 2rem auto;
            border-radius: var(--border-radius);
            background: var(--card-bg);
            display: none;
            align-items: center;
            justify-content: center;
            border: 2px solid rgba(255, 255, 255, 0.2);
            overflow: hidden;
            box-shadow: var(--box-shadow);
        }
        .cover-photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: var(--border-radius);
        }
        .cover-photo.show {
            display: flex;
        }
        /* Main Content */
        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }
        .section {
            padding: 3rem 0;
            display: none;
        }
        .section.active {
            display: block;
        }
        .section-title {
            font-size: 2.5rem;
            text-align: center;
            margin-bottom: 3rem;
            position: relative;
        }
        .section-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: var(--accent-color);
            border-radius: 2px;
        }
        /* Grid Layouts */
        .grid {
            display: grid;
            gap: 2rem;
        }
        .grid-2 {
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }
        .grid-3 {
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        }
        .grid-4 {
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }
        /* Cards */
        .card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        @media (max-width: 768px) {
            .card {
                padding: 1rem;
            }
        }
        .card:hover {
            background: var(--card-hover-bg);
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
        }
        .card-title {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .card-content {
            opacity: 0.9;
            line-height: 1.6;
        }
        /* Team Cards */
        .team-card {
            text-align: center;
        }
        .team-logo {
            width: 80px;
            height: 80px;
            background: white;
            border-radius: 50%;
            margin: 0 auto 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--text-dark);
            font-size: 1.5rem;
            overflow: hidden;
            border: 3px solid rgba(255, 255, 255, 0.2);
        }
        .team-logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }
        .team-logo-small {
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--text-dark);
            font-size: 0.8rem;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.2);
            margin-right: 0.5rem;
        }
        .team-logo-small img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }
        /* News Cards */
        .news-card {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        .news-image {
            width: 100%;
            height: 200px;
            background: var(--card-hover-bg);
            border-radius: var(--border-radius);
            margin-bottom: 1rem;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .news-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .news-meta {
            font-size: 0.9rem;
            opacity: 0.7;
            margin-bottom: 0.5rem;
        }
        .news-excerpt {
            flex-grow: 1;
            margin-bottom: 1rem;
        }
        /* Match Cards */
        .match-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .match-header {
            background: white;
            color: var(--text-dark);
            padding: 1rem;
            border-radius: var(--border-radius) var(--border-radius) 0 0;
            margin: -1.5rem -1.5rem 1rem;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .team-vs {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
            margin: 1rem 0;
        }
        .team-info {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            flex: 1;
        }
        .vs-divider {
            font-weight: bold;
            font-size: 1.2rem;
            color: var(--accent-color);
            padding: 0.5rem 1rem;
            background: rgba(255, 107, 53, 0.1);
            border-radius: 25px;
        }
        .match-result {
            text-align: center;
            margin-top: 1rem;
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius);
        }
        /* Tables */
        .table-container {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            overflow: hidden;
            margin: 2rem 0;
            overflow-x: auto;
        }
        .table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
        }
        .table th,
        .table td {
            padding: 0.6rem 0.4rem;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.85rem;
        }
        @media (max-width: 768px) {
            .table th,
            .table td {
                padding: 0.5rem 0.3rem;
                font-size: 0.8rem;
            }
        }
        .table th {
            background: white;
            color: var(--text-dark);
            font-weight: bold;
            font-size: 0.9rem;
            padding: 0.5rem 0.4rem;
        }
        @media (max-width: 768px) {
            .table th {
                font-size: 0.8rem;
                padding: 0.4rem 0.3rem;
            }
        }
        .table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        /* Forms */
        .form-group {
            margin-bottom: 1.5rem;
        }
        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }
        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 1rem;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }
        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--accent-color);
        }
        .form-textarea {
            resize: vertical;
            min-height: 120px;
        }
        /* Buttons */
        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            margin: 0.5rem;
            font-size: 1rem;
            text-decoration: none;
        }
        .btn-primary {
            background: var(--secondary-gradient);
            color: white;
        }
        .btn-success {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
        }
        .btn-danger {
            background: linear-gradient(45deg, #f44336, #d32f2f);
            color: white;
        }
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            backdrop-filter: blur(10px);
        }
        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--primary-gradient);
            padding: 2rem;
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        .modal-close {
            background: none;
            border: none;
            font-size: 2rem;
            color: white;
            cursor: pointer;
            transition: color 0.3s ease;
        }
        .modal-close:hover {
            color: var(--accent-color);
        }
        /* Admin Panel */
        .admin-panel {
            background: rgba(0, 0, 0, 0.9);
            border-radius: var(--border-radius);
            padding: 2rem;
            margin: 2rem 0;
            border: 2px solid rgba(255, 255, 255, 0.2);
            display: none;
        }
        .admin-panel.show {
            display: block;
        }
        .admin-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        .admin-tab {
            padding: 1rem 1.5rem;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        .admin-tab.active {
            background: var(--secondary-gradient);
            border-color: #2196F3;
        }
        .admin-content {
            display: none;
        }
        .admin-content.active {
            display: block;
        }
        /* Filters */
        .filter-section {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        /* Status indicators */
        .status-win {
            color: #4CAF50;
        }
        .status-loss {
            color: #f44336;
        }
        .status-forfeit {
            color: #FF9800;
        }
        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-menu {
                position: fixed;
                top: 80px;
                left: -100%;
                width: 100%;
                height: calc(100vh - 80px);
                background: rgba(15, 27, 60, 0.98);
                flex-direction: column;
                padding: 2rem;
                transition: left 0.3s ease;
            }
            .nav-menu.show {
                left: 0;
            }
            .hero {
                padding: 2rem 0 4rem;
            }
            .section {
                padding: 2rem 0;
            }
            .main-content {
                padding: 0 1rem;
            }
            .team-vs {
                flex-direction: column;
                text-align: center;
                gap: 1rem;
            }
            .vs-divider {
                order: 2;
            }
            .table-container {
                overflow-x: auto;
            }
            .modal-content {
                width: 95%;
                padding: 1rem;
                max-height: 85vh;
            }
            .admin-tabs {
                flex-direction: column;
            }
            .grid {
                gap: 1rem;
            }
            .card {
                padding: 1.2rem;
            }
            .team-logo {
                width: 50px;
                height: 50px;
            }
            .team-logo-small {
                width: 25px;
                height: 25px;
                font-size: 0.7rem;
            }
            .modal-content h2 {
                font-size: 1.3rem;
            }
            .modal-content h3 {
                font-size: 1.1rem;
                margin-bottom: 0.8rem;
            }
            .scrollable-container {
                max-height: 250px;
            }
        }
        /* Loading States */
        .loading {
            text-align: center;
            padding: 2rem;
            opacity: 0.7;
        }
        .spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--accent-color);
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        /* Utility Classes */
        .text-center { text-align: center; }
        .hidden { display: none !important; }
        .mb-1 { margin-bottom: 1rem; }
        .mb-2 { margin-bottom: 2rem; }
        .mt-1 { margin-top: 1rem; }
        .mt-2 { margin-top: 2rem; }
        /* Image Upload Styling */
        .image-preview {
            width: 100%;
            max-width: 300px;
            height: 200px;
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 1rem 0;
            background: rgba(255, 255, 255, 0.05);
            position: relative;
            overflow: hidden;
        }
        .image-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .image-preview.has-image {
            border-style: solid;
            border-color: var(--accent-color);
        }
        /* Admin Access */
        .admin-access {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 2rem;
            border-radius: var(--border-radius);
            border: 2px solid var(--accent-color);
            display: none;
            z-index: 3000;
            text-align: center;
        }
        /* Player Stats Section */
        .player-stats-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .player-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        .player-photo {
            width: 60px;
            height: 60px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--text-dark);
            font-size: 1.2rem;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        .player-photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }
        .player-info h3 {
            margin-bottom: 0.2rem;
        }
        .player-info p {
            opacity: 0.7;
            font-size: 0.9rem;
        }
        .player-stats-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 0.5rem;
            margin-top: 1rem;
        }
        .player-stat-item {
            text-align: center;
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--border-radius);
        }
        .player-stat-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--accent-color);
        }
        .player-stat-label {
            font-size: 0.8rem;
            opacity: 0.7;
        }
        /* Game Stats Entry */
        .game-stats-form {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin: 1rem 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .game-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        .game-stat-input {
            text-align: center;
        }
        .game-stat-input input {
            width: 100%;
            text-align: center;
            padding: 0.5rem;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
        }
        /* Scrollable containers for mobile */
        .scrollable-container {
            overflow-x: auto;
            padding-bottom: 1rem;
        }
        /* Smaller table fonts for mobile */
        @media (max-width: 768px) {
            .table th, .table td {
                font-size: 0.85rem;
                padding: 0.6rem 0.4rem;
            }
            .section-title {
                font-size: 1.8rem;
            }
            .card-title {
                font-size: 1.2rem;
            }
            .team-logo {
                width: 60px;
                height: 60px;
            }
            .team-logo-small {
                width: 30px;
                height: 30px;
                font-size: 0.7rem;
            }
            .modal-content h2 {
                font-size: 1.5rem;
            }
            .modal-content h3 {
                font-size: 1.2rem;
            }
        }
        /* Improved modal for mobile */
        .modal-content {
            padding: 1.5rem;
            max-height: 85vh;
        }
        @media (max-width: 768px) {
            .modal-content {
                padding: 1rem;
                margin: 1rem;
                max-height: 80vh;
            }
            .modal-header {
                margin-bottom: 1rem;
            }
            .table-container {
                font-size: 0.9rem;
            }
            .scrollable-container {
                max-height: 300px;
                overflow-y: auto;
            }
        }
        /* Scrollable game results */
        .game-results-container {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 1rem;
            padding-right: 5px;
        }
        @media (max-width: 768px) {
            .game-results-container {
                max-height: 250px;
            }
        }
        /* Compact table container */
        .table-container {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            overflow: hidden;
            margin: 1.5rem 0;
            max-height: none !important;
        }
        /* Remove horizontal scrolling on mobile */
        @media (max-width: 768px) {
            .table-container {
                overflow-x: hidden !important;
            }
            /* Make table columns narrower */
            .table th:nth-child(1), .table td:nth-child(1) { /* Pos */
                width: 5%;
            }
            .table th:nth-child(2), .table td:nth-child(2) { /* Team */
                width: 25%;
            }
            .table th:nth-child(3), .table td:nth-child(3) { /* P */
                width: 5%;
            }
            .table th:nth-child(4), .table td:nth-child(4) { /* W */
                width: 5%;
            }
            .table th:nth-child(5), .table td:nth-child(5) { /* L */
                width: 5%;
            }
            .table th:nth-child(6), .table td:nth-child(6) { /* F */
                width: 5%;
            }
            .table th:nth-child(7), .table td:nth-child(7) { /* PF */
                width: 8%;
            }
            .table th:nth-child(8), .table td:nth-child(8) { /* PA */
                width: 8%;
            }
            .table th:nth-child(9), .table td:nth-child(9) { /* PD */
                width: 8%;
            }
            .table th:nth-child(10), .table td:nth-child(10) { /* Pts */
                width: 8%;
            }
            .table th:nth-child(11), .table td:nth-child(11) { /* Status */
                width: 18%;
            }
        }
        /* Notification Styles */
        .notification {
            background: white;
            color: var(--text-dark);
            padding: 1rem;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            margin-bottom: 1rem;
            animation: slideInRight 0.3s ease-out;
            border-left: 4px solid var(--accent-color);
            position: relative;
            overflow: hidden;
        }
        .notification.success {
            border-left-color: #4CAF50;
        }
        .notification.info {
            border-left-color: #2196F3;
        }
        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        .notification-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
            font-weight: bold;
        }
        .notification-close {
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            color: #999;
            padding: 0;
            margin: 0;
        }
        .notification-close:hover {
            color: #333;
        }
        .notification-content {
            font-size: 0.9rem;
            line-height: 1.5;
        }
        .notification-time {
            font-size: 0.8rem;
            opacity: 0.7;
            margin-top: 0.5rem;
        }
        /* Notification Badge for Mobile Menu */
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--accent-color);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
        }
        /* Notification Bell Icon */
        .nav-notification {
            position: relative;
            padding: 0.8rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-light);
            text-decoration: none;
            border-radius: 25px;
            transition: all 0.3s ease;
        }
        .nav-notification:hover {
            background: var(--card-bg);
            transform: translateY(-2px);
        }
        .nav-notification.active {
            background: var(--card-bg);
        }
        /* Notification Animations */
        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        @keyframes slideOutRight {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }
        /* Comments Section */
        .comment-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .comment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        .comment-author {
            font-weight: bold;
            font-size: 1.1rem;
        }
        .comment-date {
            font-size: 0.8rem;
            opacity: 0.7;
        }
        .comment-content {
            line-height: 1.6;
            margin-bottom: 0.5rem;
        }
        .comment-reply {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--accent-color);
            cursor: pointer;
            font-size: 0.9rem;
        }
        .comment-reply:hover {
            text-decoration: underline;
        }
        .comment-form {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        .comment-reply-input {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }
        .comment-reply-btn {
            padding: 0.5rem 1rem;
            background: var(--accent-color);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .comment-reply-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 53, 0.3);
        }
        /* Loading States for Comments */
        .comments-loading {
            text-align: center;
            padding: 2rem;
            opacity: 0.7;
        }
        .comments-spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--accent-color);
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 1rem;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        /* Error Message Styling */
        .error-message {
            color: #f44336;
            text-align: center;
            padding: 1rem;
            background: rgba(244, 67, 54, 0.1);
            border-radius: var(--border-radius);
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="nav-container">
            <div class="logo-section">
                <div class="logo" id="main-logo" ondblclick="adminAccess()">
                    CL
                </div>
                <h2 class="site-title">Courtside Liberia</h2>
            </div>
            <nav>
                <ul class="nav-menu" id="nav-menu">
                    <li class="nav-item"><a href="#" class="nav-link active" data-section="home"><i class="fas fa-home"></i> Home</a></li>
                    <li class="nav-item"><a href="#" class="nav-link" data-section="news"><i class="fas fa-newspaper"></i> News</a></li>
                    <li class="nav-item"><a href="#" class="nav-link" data-section="divisions"><i class="fas fa-trophy"></i> Divisions</a></li>
                    <li class="nav-item"><a href="#" class="nav-link" data-section="fixtures"><i class="fas fa-calendar-alt"></i> Fixtures</a></li>
                    <li class="nav-item">
                        <a href="#" class="nav-link nav-notification" data-section="results" id="results-notification">
                            <i class="fas fa-clipboard-check"></i> Results
                            <span id="notification-badge" class="notification-badge hidden">0</span>
                        </a>
                    </li>
                    <li class="nav-item"><a href="#" class="nav-link" data-section="players"><i class="fas fa-basketball"></i> Player Stats</a></li>
                </ul>
            </nav>
            <button class="mobile-menu-toggle" id="mobile-menu-toggle">
                <i class="fas fa-bars"></i>
            </button>
            <button class="admin-btn" onclick="toggleAdmin()">
                <i class="fas fa-cog"></i> Admin Panel
            </button>
        </div>
    </header>
    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1>Courtside Liberia</h1>
            <p class="hero-subtitle">Promoting Excellence in Liberian Basketball Association</p>
            <p>Dedicated to developing talent and bringing professional basketball to communities across Liberia</p>
            <div id="cover-photo" class="cover-photo">
                <img id="cover-image" src="" alt="Courtside Liberia Cover">
            </div>
        </div>
    </section>
    <!-- Main Content -->
    <main class="main-content">
        <!-- Home Section -->
        <section id="home" class="section active">
            <div class="section-title">Welcome to Courtside Liberia! We Live For The Culture! 231</div>
            <!-- Progress Timeline for First Division -->
            <div class="progress-timeline">
                <div class="timeline-stage timeline-completed">
                    <div class="timeline-icon"><i class="fas fa-flag-checkered"></i></div>
                    <span class="stage-indicator stage-completed">Regular Season</span>
                    <small>Complete</small>
                </div>
                <div class="timeline-stage timeline-active">
                    <div class="timeline-icon"><i class="fas fa-trophy"></i></div>
                    <span class="stage-indicator stage-ongoing">Big Six</span>
                    <small>Starts Today 5:30 PM</small>
                </div>
                <div class="timeline-stage timeline-upcoming">
                    <div class="timeline-icon"><i class="fas fa-crown"></i></div>
                    <span class="stage-indicator stage-upcoming">Finals</span>
                    <small>Coming Soon</small>
                </div>
            </div>
            <!-- Division Cards with Status -->
            <div class="grid grid-3">
                <div class="card" onclick="showSection('divisions')">
                    <div class="card-title">
                        <i class="fas fa-users"></i>
                        Second Division
                    </div>
                    <div class="card-content">
                        Eighteen teams in two sub-divisions. Top teams advance to Super Six.
                        <div class="mt-1">
                            <span class="stage-indicator stage-ongoing">Season Ongoing</span>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Big Six Announcement -->
            <div class="card text-center mt-2">
                <div class="card-title">
                    <i class="fas fa-fire"></i>
                    First Division Big Six
                </div>
                <div class="card-content">
                    <h3>Big Six Round Robin Starts Today at 5:30 PM!</h3>
                    <p style="margin: 1rem 0;">Top 6 teams from regular season compete for Big Four playoff spots. Top 4 teams advance.</p>
                    <span class="stage-indicator stage-ongoing">Live Today</span>
                </div>
            </div>
            <!-- Latest News Preview -->
            <div id="home-news-preview">
                <h3 style="margin: 3rem 0 2rem; text-align: center;">Latest News</h3>
                <div id="home-news-grid" class="grid grid-3"></div>
            </div>
            <!-- Quick Stats -->
            <div style="margin-top: 3rem;">
                <h3 style="text-align: center; margin-bottom: 2rem;">League Statistics</h3>
                <div class="grid grid-4" id="quick-stats">
                    <div class="card text-center">
                        <div class="card-title">
                            <i class="fas fa-users"></i>
                            Total Teams
                        </div>
                        <div class="card-content">
                            <span id="total-teams" style="font-size: 2rem; font-weight: bold; color: var(--accent-color);">0</span>
                        </div>
                    </div>
                    <div class="card text-center">
                        <div class="card-title">
                            <i class="fas fa-gamepad"></i>
                            Games Played
                        </div>
                        <div class="card-content">
                            <span id="total-games" style="font-size: 2rem; font-weight: bold; color: var(--accent-color);">0</span>
                        </div>
                    </div>
                    <div class="card text-center">
                        <div class="card-title">
                            <i class="fas fa-calendar"></i>
                            Upcoming Matches
                        </div>
                        <div class="card-content">
                            <span id="total-fixtures" style="font-size: 2rem; font-weight: bold; color: var(--accent-color);">0</span>
                        </div>
                    </div>
                    <div class="card text-center">
                        <div class="card-title">
                            <i class="fas fa-trophy"></i>
                            Active Divisions
                        </div>
                        <div class="card-content">
                            <span id="total-divisions" style="font-size: 2rem; font-weight: bold; color: var(--accent-color);">5</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- News Section -->
        <section id="news" class="section">
            <div class="section-title">Latest News</div>
            <div id="news-grid" class="grid grid-3"></div>
        </section>
        <!-- Divisions Section -->
        <section id="divisions" class="section">
            <div class="section-title">League Divisions</div>
            <div class="grid grid-3">
                <div class="card" onclick="showDivisionDetails('first')">
                    <div class="card-title">
                        <i class="fas fa-medal"></i>
                        First Division
                    </div>
                    <div class="card-content">
                        Premier teams competing at the highest level of Liberian basketball
                        <div class="mt-1">
                            <span class="stage-indicator stage-completed">Regular Season Complete</span>
                            <span class="stage-indicator stage-ongoing">Big Six Active</span>
                        </div>
                    </div>
                </div>
                <div class="card" onclick="showDivisionDetails('second')">
                    <div class="card-title">
                        <i class="fas fa-medal"></i>
                        Second Division
                    </div>
                    <div class="card-content">
                        Rising teams seeking promotion to the premier division
                        <div class="mt-1">
                            <span class="stage-indicator stage-ongoing">Season Ongoing</span>
                        </div>
                    </div>
                </div>
                <div class="card" onclick="showDivisionDetails('female')">
                    <div class="card-title">
                        <i class="fas fa-female"></i>
                        Female Division
                    </div>
                    <div class="card-content">
                        Women's professional basketball league promoting female excellence
                        <div class="mt-1">
                            <span class="stage-indicator stage-ongoing">Season Ongoing</span>
                        </div>
                    </div>
                </div>
                <div class="card" onclick="showDivisionDetails('third-jj')">
                    <div class="card-title">
                        <i class="fas fa-medal"></i>
                        Third Division - JJ Roberts
                    </div>
                    <div class="card-content">
                        Development league - JJ Roberts Conference for emerging talent
                        <div class="mt-1">
                            <span class="stage-indicator stage-ongoing">Season Ongoing</span>
                        </div>
                    </div>
                </div>
                <div class="card" onclick="showDivisionDetails('third-ej')">
                    <div class="card-title">
                        <i class="fas fa-medal"></i>
                        Third Division - EJ Roye
                    </div>
                    <div class="card-content">
                        Development league - EJ Roye Conference for emerging talent
                        <div class="mt-1">
                            <span class="stage-indicator stage-ongoing">Season Ongoing</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- Division Details Section -->
        <section id="division-details" class="section">
            <button class="btn btn-secondary mb-2" onclick="showSection('divisions')">
                <i class="fas fa-arrow-left"></i> Back to Divisions
            </button>
            <div id="division-title" class="section-title">Division Details</div>
            <!-- Playoff Progression Container -->
            <div id="playoff-progression" class="hidden">
                <!-- Regular Season Final Standings -->
                <div class="card mb-2">
                    <div class="card-title">
                        <i class="fas fa-chart-line"></i>
                        Regular Season Final Standings
                    </div>
                    <div class="scrollable-container">
                        <div class="table-container">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Pos</th>
                                        <th>Team</th>
                                        <th>P</th>
                                        <th>W</th>
                                        <th>L</th>
                                        <th>F</th>
                                        <th>PF</th>
                                        <th>PA</th>
                                        <th>PD</th>
                                        <th>Pts</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="regular-season-table">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- Current Playoff Stage -->
                <div class="card mb-2">
                    <div class="card-title">
                        <i class="fas fa-trophy"></i>
                        <span id="current-stage-title">Big Six Round Robin</span>
                        <span class="stage-indicator stage-ongoing">Active</span>
                    </div>
                    <div class="card-content">
                        <p id="current-stage-description">Top 6 teams compete in round robin format. Top 4 advance to Big Four playoffs.</p>
                        <div class="scrollable-container">
                            <div class="table-container">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Seed</th>
                                            <th>Team</th>
                                            <th>Regular Season</th>
                                            <th>Big Six Record</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody id="current-stage-table">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Next Playoff Stage -->
                <div class="card mb-2">
                    <div class="card-title">
                        <i class="fas fa-fire"></i>
                        <span id="next-stage-title">Big Four Playoffs</span>
                        <span class="stage-indicator stage-upcoming">Upcoming</span>
                    </div>
                    <div class="card-content">
                        <p id="next-stage-description">Best of 3 or 5 series format. Top 2 teams advance to finals.</p>
                        <div class="text-center">
                            <p><em>Teams will be determined from Big Six results</em></p>
                        </div>
                    </div>
                </div>
                <!-- Finals Stage -->
                <div class="card mb-2">
                    <div class="card-title">
                        <i class="fas fa-crown"></i>
                        Championship Finals
                        <span class="stage-indicator stage-upcoming">Upcoming</span>
                    </div>
                    <div class="card-content">
                        <p>Best of 3 or 5 series to determine the division champion.</p>
                        <div class="text-center">
                            <p><em>Finalists will be determined from Big Four playoffs</em></p>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Regular Teams Display -->
            <div id="division-teams" class="grid grid-4"></div>
            <button id="standings-btn" class="btn btn-primary mt-2">
                <i class="fas fa-chart-line"></i> View Standings
            </button>
        </section>
        <!-- Fixtures Section -->
        <section id="fixtures" class="section">
            <div class="section-title">Upcoming Fixtures</div>
            <div class="filter-section">
                <div class="form-group">
                    <label class="form-label">Filter by Division</label>
                    <select id="fixtures-division-filter" class="form-select" onchange="filterFixtures()">
                        <option value="all">All Divisions</option>
                        <option value="first">First Division</option>
                        <option value="second">Second Division</option>
                        <option value="female">Female Division</option>
                        <option value="third-jj">Third Division - JJ Roberts</option>
                        <option value="third-ej">Third Division - EJ Roye</option>
                    </select>
                </div>
            </div>
            <div id="fixtures-list"></div>
        </section>
        <!-- Results Section -->
        <section id="results" class="section">
            <div class="section-title">Match Results</div>
            <div class="filter-section">
                <div class="form-group">
                    <label class="form-label">Filter by Division</label>
                    <select id="results-division-filter" class="form-select" onchange="filterResults()">
                        <option value="all">All Divisions</option>
                        <option value="first">First Division</option>
                        <option value="second">Second Division</option>
                        <option value="female">Female Division</option>
                        <option value="third-jj">Third Division - JJ Roberts</option>
                        <option value="third-ej">Third Division - EJ Roye</option>
                    </select>
                </div>
            </div>
            <div id="results-list"></div>
        </section>
        <!-- Players Stats Section -->
        <section id="players" class="section">
            <div class="section-title">Player Statistics</div>
            <div class="filter-section">
                <div class="form-group">
                    <label class="form-label">Filter by Division</label>
                    <select id="players-division-filter" class="form-select" onchange="filterPlayers()">
                        <option value="all">All Divisions</option>
                        <option value="first">First Division</option>
                        <option value="second">Second Division</option>
                        <option value="female">Female Division</option>
                        <option value="third-jj">Third Division - JJ Roberts</option>
                        <option value="third-ej">Third Division - EJ Roye</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Filter by Team</label>
                    <select id="players-team-filter" class="form-select" onchange="filterPlayers()">
                        <option value="all">All Teams</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Sort by Statistic</label>
                    <select id="players-sort-filter" class="form-select" onchange="filterPlayers()">
                        <option value="points">Points Per Game</option>
                        <option value="rebounds">Rebounds Per Game</option>
                        <option value="assists">Assists Per Game</option>
                        <option value="steals">Steals Per Game</option>
                        <option value="blocks">Blocks Per Game</option>
                    </select>
                </div>
            </div>
            <div class="grid grid-3 mb-2">
                <div class="card text-center">
                    <div class="card-title">
                        <i class="fas fa-fire"></i>
                        Points Leader
                    </div>
                    <div id="points-leader" class="card-content">
                        <div class="team-logo" style="margin: 0 auto 1rem; width: 60px; height: 60px;">
                            <i class="fas fa-user"></i>
                        </div>
                        <h3 id="points-leader-name">-</h3>
                        <p id="points-leader-stats">-</p>
                    </div>
                </div>
                <div class="card text-center">
                    <div class="card-title">
                        <i class="fas fa-hand-paper"></i>
                        Rebounds Leader
                    </div>
                    <div id="rebounds-leader" class="card-content">
                        <div class="team-logo" style="margin: 0 auto 1rem; width: 60px; height: 60px;">
                            <i class="fas fa-user"></i>
                        </div>
                        <h3 id="rebounds-leader-name">-</h3>
                        <p id="rebounds-leader-stats">-</p>
                    </div>
                </div>
                <div class="card text-center">
                    <div class="card-title">
                        <i class="fas fa-handshake"></i>
                        Assists Leader
                    </div>
                    <div id="assists-leader" class="card-content">
                        <div class="team-logo" style="margin: 0 auto 1rem; width: 60px; height: 60px;">
                            <i class="fas fa-user"></i>
                        </div>
                        <h3 id="assists-leader-name">-</h3>
                        <p id="assists-leader-stats">-</p>
                    </div>
                </div>
            </div>
            <div class="scrollable-container">
                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Player</th>
                                <th>Team</th>
                                <th>Pos</th>
                                <th>GP</th>
                                <th>PPG</th>
                                <th>RPG</th>
                                <th>APG</th>
                                <th>SPG</th>
                                <th>BPG</th>
                            </tr>
                        </thead>
                        <tbody id="players-stats-table">
                            <tr>
                                <td colspan="10" class="text-center">Loading player statistics...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
        <!-- Admin Panel -->
        <div id="admin-panel" class="admin-panel">
            <h2 class="section-title">Admin Panel</h2>
            <div class="admin-tabs">
                <button class="admin-tab active" onclick="showAdminTab('news')">
                    <i class="fas fa-newspaper"></i> Manage News
                </button>
                <button class="admin-tab" onclick="showAdminTab('teams')">
                    <i class="fas fa-users"></i> Manage Teams
                </button>
                <button class="admin-tab" onclick="showAdminTab('fixtures')">
                    <i class="fas fa-calendar-plus"></i> Add Fixtures
                </button>
                <button class="admin-tab" onclick="showAdminTab('matches')">
                    <i class="fas fa-trophy"></i> Add Results
                </button>
                <button class="admin-tab" onclick="showAdminTab('players')">
                    <i class="fas fa-basketball"></i> Manage Players
                </button>
                <button class="admin-tab" onclick="showAdminTab('results')">
                    <i class="fas fa-clipboard-list"></i> Manage Results
                </button>
                <button class="admin-tab" onclick="showAdminTab('settings')">
                    <i class="fas fa-cog"></i> Settings
                </button>
            </div>
            <!-- News Management -->
            <div id="admin-news" class="admin-content active">
                <h3><i class="fas fa-newspaper"></i> News Management</h3>
                <div class="grid grid-2 mb-2">
                    <div class="card">
                        <h4>Add New Article</h4>
                        <form id="news-form">
                            <div class="form-group">
                                <label class="form-label">Article Title</label>
                                <input type="text" id="news-title" class="form-input" placeholder="Enter article title">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Article Content</label>
                                <textarea id="news-content" class="form-textarea" placeholder="Enter article content"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Article Image (Base64)</label>
                                <input type="file" id="news-image" class="form-input" accept="image/*" onchange="handleImageUpload('news-image', 'news-preview')">
                                <div id="news-preview" class="image-preview">
                                    <span>Select an image</span>
                                </div>
                            </div>
                            <button type="button" class="btn btn-success" onclick="addNews()">
                                <i class="fas fa-plus"></i> Add Article
                            </button>
                        </form>
                    </div>
                </div>
                <div id="admin-news-list"></div>
            </div>
            <!-- Teams Management -->
            <div id="admin-teams" class="admin-content">
                <h3><i class="fas fa-users"></i> Team Management</h3>
                <div class="grid grid-2 mb-2">
                    <div class="card">
                        <h4>Add New Team</h4>
                        <div class="form-group">
                            <label class="form-label">Division</label>
                            <select id="team-division" class="form-select">
                                <option value="first">First Division</option>
                                <option value="second">Second Division</option>
                                <option value="female">Female Division</option>
                                <option value="third-jj">Third Division - JJ Roberts</option>
                                <option value="third-ej">Third Division - EJ Roye</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Team Name</label>
                            <input type="text" id="team-name" class="form-input" placeholder="Enter team name">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Team Logo (Base64)</label>
                            <input type="file" id="team-logo" class="form-input" accept="image/*" onchange="handleImageUpload('team-logo', 'team-logo-preview')">
                            <div id="team-logo-preview" class="image-preview">
                                <span>Select team logo</span>
                            </div>
                        </div>
                        <button class="btn btn-success" onclick="addTeam()">
                            <i class="fas fa-plus"></i> Add Team
                        </button>
                    </div>
                </div>
                <div id="admin-teams-list"></div>
            </div>
            <!-- Fixtures Management -->
            <div id="admin-fixtures" class="admin-content">
                <h3><i class="fas fa-calendar-plus"></i> Add Fixture</h3>
                <div class="grid grid-2 mb-2">
                    <div class="card">
                        <div class="form-group">
                            <label class="form-label">Division</label>
                            <select id="fixture-division" class="form-select" onchange="updateFixtureTeams()">
                                <option value="first">First Division</option>
                                <option value="second">Second Division</option>
                                <option value="female">Female Division</option>
                                <option value="third-jj">Third Division - JJ Roberts</option>
                                <option value="third-ej">Third Division - EJ Roye</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Home Team</label>
                            <select id="fixture-home-team" class="form-select"></select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Away Team</label>
                            <select id="fixture-away-team" class="form-select"></select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Match Date</label>
                            <input type="date" id="fixture-date" class="form-input">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Match Time</label>
                            <input type="time" id="fixture-time" class="form-input">
                        </div>
                        <button class="btn btn-success" onclick="addFixture()">
                            <i class="fas fa-plus"></i> Add Fixture
                        </button>
                    </div>
                </div>
                <div id="admin-fixtures-list"></div>
            </div>
            <!-- Match Results Management -->
            <div id="admin-matches" class="admin-content">
                <h3><i class="fas fa-trophy"></i> Add Match Result</h3>
                <div class="grid grid-2 mb-2">
                    <div class="card">
                        <div class="form-group">
                            <label class="form-label">Division</label>
                            <select id="match-division" class="form-select" onchange="updateMatchTeams()">
                                <option value="first">First Division</option>
                                <option value="second">Second Division</option>
                                <option value="female">Female Division</option>
                                <option value="third-jj">Third Division - JJ Roberts</option>
                                <option value="third-ej">Third Division - EJ Roye</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Home Team</label>
                            <select id="match-home-team" class="form-select"></select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Away Team</label>
                            <select id="match-away-team" class="form-select"></select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Match Date</label>
                            <input type="date" id="match-date" class="form-input">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Result Type</label>
                            <select id="match-result-type" class="form-select" onchange="toggleMatchInputs()">
                                <option value="normal">Normal Game</option>
                                <option value="forfeit">Forfeit</option>
                            </select>
                        </div>
                        <div id="match-normal-inputs">
                            <div class="form-group">
                                <label class="form-label">Home Score</label>
                                <input type="number" id="match-home-score" class="form-input" min="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Away Score</label>
                                <input type="number" id="match-away-score" class="form-input" min="0">
                            </div>
                        </div>
                        <div id="match-forfeit-inputs" class="hidden">
                            <div class="form-group">
                                <label class="form-label">Team that Forfeited</label>
                                <select id="match-forfeit-team" class="form-select">
                                    <option value="home">Home Team</option>
                                    <option value="away">Away Team</option>
                                </select>
                            </div>
                        </div>
                        <button class="btn btn-success" onclick="addMatchResult()">
                            <i class="fas fa-plus"></i> Add Result
                        </button>
                    </div>
                </div>
            </div>
            <!-- Players Management -->
            <div id="admin-players" class="admin-content">
                <h3><i class="fas fa-basketball"></i> Player Management</h3>
                <div class="grid grid-2 mb-2">
                    <div class="card">
                        <h4>Add New Player</h4>
                        <div class="form-group">
                            <label class="form-label">Division</label>
                            <select id="player-division" class="form-select" onchange="updatePlayerTeams()">
                                <option value="first">First Division</option>
                                <option value="second">Second Division</option>
                                <option value="female">Female Division</option>
                                <option value="third-jj">Third Division - JJ Roberts</option>
                                <option value="third-ej">Third Division - EJ Roye</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Team</label>
                            <select id="player-team" class="form-select">
                                <option value="">Select Team</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Player Name</label>
                            <input type="text" id="player-name" class="form-input" placeholder="Enter player's full name">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Jersey Number</label>
                            <input type="number" id="player-number" class="form-input" placeholder="Enter jersey number" min="0" max="99">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Position</label>
                            <select id="player-position" class="form-select">
                                <option value="PG">Point Guard (PG)</option>
                                <option value="SG">Shooting Guard (SG)</option>
                                <option value="SF">Small Forward (SF)</option>
                                <option value="PF">Power Forward (PF)</option>
                                <option value="C">Center (C)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Player Photo (Base64)</label>
                            <input type="file" id="player-photo" class="form-input" accept="image/*" onchange="handleImageUpload('player-photo', 'player-photo-preview')">
                            <div id="player-photo-preview" class="image-preview">
                                <span>Select player photo</span>
                            </div>
                        </div>
                        <button class="btn btn-success" onclick="addPlayer()">
                            <i class="fas fa-plus"></i> Add Player
                        </button>
                    </div>
                </div>
                <div id="admin-players-list"></div>
            </div>
            <!-- Results Management -->
            <div id="admin-results" class="admin-content">
                <h3><i class="fas fa-clipboard-list"></i> Results Management</h3>
                <div class="filter-section">
                    <div class="form-group">
                        <label class="form-label">Filter by Division</label>
                        <select id="admin-results-division-filter" class="form-select" onchange="renderAdminResults()">
                            <option value="all">All Divisions</option>
                            <option value="first">First Division</option>
                            <option value="second">Second Division</option>
                            <option value="female">Female Division</option>
                            <option value="third-jj">Third Division - JJ Roberts</option>
                            <option value="third-ej">Third Division - EJ Roye</option>
                        </select>
                    </div>
                </div>
                <div id="admin-results-list"></div>
            </div>
            <!-- Settings Management -->
            <div id="admin-settings" class="admin-content">
                <h3><i class="fas fa-cog"></i> Website Settings</h3>
                <div class="grid grid-2">
                    <div class="card">
                        <h4>Main Logo</h4>
                        <div class="form-group">
                            <label class="form-label">Upload Main Logo (Base64)</label>
                            <input type="file" id="main-logo-upload" class="form-input" accept="image/*" onchange="handleImageUpload('main-logo-upload', 'main-logo-preview')">
                            <div id="main-logo-preview" class="image-preview">
                                <span>Select main logo</span>
                            </div>
                            <button class="btn btn-primary" onclick="uploadMainLogo()">
                                <i class="fas fa-upload"></i> Update Logo
                            </button>
                        </div>
                    </div>
                    <div class="card">
                        <h4>Cover Photo</h4>
                        <div class="form-group">
                            <label class="form-label">Upload Cover Photo (Base64)</label>
                            <input type="file" id="cover-photo-upload" class="form-input" accept="image/*" onchange="handleImageUpload('cover-photo-upload', 'cover-photo-preview')">
                            <div id="cover-photo-preview" class="image-preview">
                                <span>Select cover photo</span>
                            </div>
                            <button class="btn btn-primary" onclick="uploadCoverPhoto()">
                                <i class="fas fa-upload"></i> Update Cover
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <!-- Modals -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">Details</h2>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div id="modal-body"></div>
        </div>
    </div>
    <!-- Player Stats Modal -->
    <div id="player-stats-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="player-stats-modal-title">Record Player Stats</h2>
                <button class="modal-close" onclick="closePlayerStatsModal()">&times;</button>
            </div>
            <div id="player-stats-modal-body"></div>
        </div>
    </div>
    <!-- Notification Container -->
    <div id="notification-container" style="position: fixed; top: 80px; right: 20px; z-index: 3000; max-width: 350px;"></div>
    <!-- Notification Sound (Optional) -->
    <audio id="notification-sound" src="data:audio/wav;base64,UklGRl9vT19XQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YU" preload="auto"></audio>
    <!-- Admin Access -->
    <div id="admin-access" class="admin-access">
        <h3><i class="fas fa-lock"></i> Admin Access</h3>
        <p>Double-click the logo 5 times to access admin panel</p>
        <p id="click-counter">Clicks: 0/5</p>
    </div>
    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAlwLvdfEVwDatmIcmdjdAu-0t0ALY6XIc",
            authDomain: "courtside-liberia-52aa8.firebaseapp.com",
            databaseURL: "https://courtside-liberia-52aa8-default-rtdb.firebaseio.com",
            projectId: "courtside-liberia-52aa8",
            storageBucket: "courtside-liberia-52aa8.firebasestorage.app",
            messagingSenderId: "154829379760",
            appId: "1:154829379760:web:000df31f9245329d990375",
            measurementId: "G-QPJHY0QLE8"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        // Global Data Storage
        let appData = {
            teams: {
                first: [],
                second: [],
                female: [],
                'third-jj': [],
                'third-ej': []
            },
            fixtures: [],
            results: [],
            news: [],
            players: [],
            settings: {
                mainLogo: null,
                coverPhoto: null,
                teamLogos: {}
            }
        };
        let adminClickCount = 0;
        let currentImageData = {};
        let currentMatchForStats = null;
        // Initialization
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
        });
        function initializeApp() {
            loadAllData();
            showSection('home');
            // Add event listener for player stats section
            document.querySelector('[data-section="players"]')?.addEventListener('click', function() {
                setTimeout(() => {
                    renderPlayerStats();
                }, 100);
            });
        }
        function setupEventListeners() {
            // Navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    showSection(this.dataset.section);
                });
            });
            // Mobile menu
            document.getElementById('mobile-menu-toggle').addEventListener('click', function() {
                document.getElementById('nav-menu').classList.toggle('show');
            });
            // Close mobile menu when clicking on a link
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function() {
                    document.getElementById('nav-menu').classList.remove('show');
                });
            });
            // Modal close
            window.addEventListener('click', function(event) {
                const modal = document.getElementById('modal');
                if (event.target === modal) {
                    closeModal();
                }
                const playerStatsModal = document.getElementById('player-stats-modal');
                if (event.target === playerStatsModal) {
                    closePlayerStatsModal();
                }
            });
            // Notification bell click
            const notificationBell = document.getElementById('results-notification');
            if (notificationBell) {
                notificationBell.addEventListener('click', function(e) {
                    e.preventDefault();
                    showSection('results');
                    // Clear notification count when viewing results
                    notificationCount = 0;
                    const badge = document.getElementById('notification-badge');
                    badge.classList.add('hidden');
                    // Clear all notifications
                    const container = document.getElementById('notification-container');
                    container.innerHTML = '';
                });
            }
        }
        // Navigation Functions
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            // Show target section
            document.getElementById(sectionName).classList.add('active');
            // Update navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            const targetLink = document.querySelector(`[data-section="${sectionName}"]`);
            if (targetLink) targetLink.classList.add('active');
            // Load section-specific data
            switch(sectionName) {
                case 'home':
                    loadHomeData();
                    break;
                case 'news':
                    renderNews();
                    break;
                case 'fixtures':
                    renderFixtures();
                    break;
                case 'results':
                    renderResults();
                    break;
                case 'players':
                    setTimeout(() => {
                        renderPlayerStats();
                    }, 100);
                    break;
            }
        }
        function showDivisionDetails(division) {
            document.getElementById('division-title').innerHTML = `<i class="fas fa-trophy"></i> ${getDivisionName(division)}`;
            // Show playoff progression for First Division (regular season complete)
            if (division === 'first') {
                showPlayoffProgression(division);
            } else {
                hidePlayoffProgression();
                renderDivisionTeams(division);
            }
            const standingsBtn = document.getElementById('standings-btn');
            standingsBtn.onclick = function() { showDivisionStandings(division); };
            showSection('division-details');
        }
        function showPlayoffProgression(division) {
            document.getElementById('playoff-progression').classList.remove('hidden');
            document.getElementById('division-teams').classList.add('hidden');
            document.getElementById('standings-btn').classList.add('hidden');
            // Load and display regular season final standings
            loadRegularSeasonStandings(division);
            // Update stage info based on division
            updatePlayoffStageInfo(division);
        }
        function hidePlayoffProgression() {
            document.getElementById('playoff-progression').classList.add('hidden');
            document.getElementById('division-teams').classList.remove('hidden');
            document.getElementById('standings-btn').classList.remove('hidden');
        }
        function updatePlayoffStageInfo(division) {
            const currentStageTitle = document.getElementById('current-stage-title');
            const currentStageDescription = document.getElementById('current-stage-description');
            const nextStageTitle = document.getElementById('next-stage-title');
            const nextStageDescription = document.getElementById('next-stage-description');
            if (division === 'first') {
                currentStageTitle.textContent = 'Big Six Round Robin';
                currentStageDescription.textContent = 'Top 6 teams from regular season compete in round robin format. Top 4 teams advance to Big Four playoffs.';
                nextStageTitle.textContent = 'Big Four Playoffs';
                nextStageDescription.textContent = 'Best of 3 or 5 series format. Top 2 teams advance to championship finals.';
            }
        }
        function loadRegularSeasonStandings(division) {
            const teams = appData.teams[division] || [];
            const divisionResults = appData.results.filter(r => r.division === division && r.played);
            // Calculate final standings
            const standings = teams.map(team => {
                const teamName = team.name;
                const teamResults = divisionResults.filter(result => 
                    result.homeTeam === teamName || result.awayTeam === teamName
                );
                let wins = 0, losses = 0, forfeits = 0, pointsFor = 0, pointsAgainst = 0;
                teamResults.forEach(result => {
                    const isHome = result.homeTeam === teamName;
                    const teamScore = isHome ? result.homeScore : result.awayScore;
                    const opponentScore = isHome ? result.awayScore : result.homeScore;
                    pointsFor += teamScore;
                    pointsAgainst += opponentScore;
                    if (result.forfeit) {
                        if ((isHome && result.forfeitTeam === 'home') || (!isHome && result.forfeitTeam === 'away')) {
                            forfeits++;
                        } else {
                            wins++;
                        }
                    } else {
                        if (teamScore > opponentScore) {
                            wins++;
                        } else {
                            losses++;
                        }
                    }
                });
                const totalPoints = (wins * 2) + (losses * 1) + (forfeits * 0);
                return {
                    team: teamName,
                    played: teamResults.length,
                    wins,
                    losses,
                    forfeits,
                    pointsFor,
                    pointsAgainst,
                    pointsDiff: pointsFor - pointsAgainst,
                    points: totalPoints
                };
            });
            // Sort standings
            standings.sort((a, b) => {
                if (b.points !== a.points) return b.points - a.points;
                if (b.pointsDiff !== a.pointsDiff) return b.pointsDiff - a.pointsDiff;
                return b.pointsFor - a.pointsFor;
            });
            // Display regular season table
            displayRegularSeasonTable(standings, division);
            // Display current playoff stage teams
            if (division === 'first') {
                displayBigSixTable(standings.slice(0, 6));
            }
        }
        function displayRegularSeasonTable(standings, division) {
            const container = document.getElementById('regular-season-table');
            let html = '';
            standings.forEach((team, index) => {
                let statusBadge = '';
                if (division === 'first') {
                    if (index < 6) {
                        statusBadge = '<span class="stage-indicator stage-ongoing">Big Six</span>';
                    } else {
                        statusBadge = '<span style="opacity: 0.5;">Eliminated</span>';
                    }
                }
                html += `
                    <tr style="cursor: pointer;" onclick="showTeamDetails('${division}', '${team.team}')">
                        <td><strong>${index + 1}</strong></td>
                        <td>
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                ${getTeamLogo(division, team.team)}
                                <span>${team.team}</span>
                            </div>
                        </td>
                        <td>${team.played}</td>
                        <td class="status-win">${team.wins}</td>
                        <td class="status-loss">${team.losses}</td>
                        <td class="status-forfeit">${team.forfeits}</td>
                        <td>${team.pointsFor}</td>
                        <td>${team.pointsAgainst}</td>
                        <td class="${team.pointsDiff >= 0 ? 'status-win' : 'status-loss'}">${team.pointsDiff >= 0 ? '+' : ''}${team.pointsDiff}</td>
                        <td style="font-weight: bold; color: var(--accent-color);">${team.points}</td>
                        <td>${statusBadge}</td>
                    </tr>
                `;
            });
            container.innerHTML = html;
        }
        function displayBigSixTable(bigSixTeams) {
            const container = document.getElementById('current-stage-table');
            let html = '';
            bigSixTeams.forEach((team, index) => {
                html += `
                    <tr>
                        <td><strong>${index + 1}</strong></td>
                        <td>
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                ${getTeamLogo('first', team.team)}
                                <span>${team.team}</span>
                            </div>
                        </td>
                        <td>${team.wins}-${team.losses}-${team.forfeits}</td>
                        <td><em>TBD</em></td>
                        <td><span class="stage-indicator stage-ongoing">Big Six</span></td>
                    </tr>
                `;
            });
            container.innerHTML = html;
        }
        // Data Loading Functions
        function loadAllData() {
            try {
                loadTeams();
                loadFixtures();
                loadResults();
                loadNews();
                loadSettings();
                loadPlayers();
                // Initialize comments collection
                initializeComments();
            } catch (error) {
                console.error("Error loading ", error);
                alert("Error loading data. Please try again later.");
            }
        }
        function loadTeams() {
            db.collection("teams").onSnapshot((snapshot) => {
                Object.keys(appData.teams).forEach(division => {
                    appData.teams[division] = [];
                });
                snapshot.forEach((doc) => {
                    const team = { id: doc.id, ...doc.data() };
                    if (appData.teams[team.division]) {
                        appData.teams[team.division].push(team);
                        if (team.logo) {
                            appData.settings.teamLogos[`${team.division}-${team.name}`] = team.logo;
                        }
                    }
                });
                renderAdminTeams();
                updateTeamSelects();
                updatePlayerTeams();
                updateQuickStats();
            });
        }
        function loadFixtures() {
            db.collection("fixtures").where("played", "==", false).onSnapshot((snapshot) => {
                appData.fixtures = [];
                snapshot.forEach((doc) => {
                    appData.fixtures.push({ id: doc.id, ...doc.data() });
                });
                renderFixtures();
                renderAdminFixtures();
                updateQuickStats();
            });
        }
        function loadResults() {
            db.collection("fixtures")
                .where("played", "==", true)
                .onSnapshot((snapshot) => {
                    appData.results = [];
                    snapshot.forEach((doc) => {
                        appData.results.push({ id: doc.id, ...doc.data() });
                    });
                    appData.results.sort((a, b) => new Date(b.date) - new Date(a.date));
                    renderResults();
                    renderAdminResults();
                    updateQuickStats();
                });
        }
        function loadNews() {
            db.collection("news").orderBy("timestamp", "desc").onSnapshot((snapshot) => {
                appData.news = [];
                snapshot.forEach((doc) => {
                    appData.news.push({ id: doc.id, ...doc.data() });
                });
                renderNews();
                renderAdminNews();
                loadHomeData();
            });
        }
        function loadSettings() {
            db.collection("settings").doc("mainLogo").get().then((doc) => {
                if (doc.exists && doc.data().data) {
                    appData.settings.mainLogo = doc.data().data;
                    updateMainLogo(doc.data().data);
                }
            });
            db.collection("settings").doc("coverPhoto").get().then((doc) => {
                if (doc.exists && doc.data().data) {
                    appData.settings.coverPhoto = doc.data().data;
                    updateCoverPhoto(doc.data().data);
                }
            });
        }
        function loadPlayers() {
            db.collection("players").onSnapshot((snapshot) => {
                appData.players = [];
                snapshot.forEach((doc) => {
                    appData.players.push({ id: doc.id, ...doc.data() });
                });
                renderAdminPlayers();
                renderPlayerStats();
            });
        }
        // Image Handling
        function handleImageUpload(inputId, previewId) {
            const input = document.getElementById(inputId);
            const preview = document.getElementById(previewId);
            const file = input.files[0];
            if (file) {
                if (file.size > 5 * 1024 * 1024) {
                    alert('File size must be less than 5MB');
                    input.value = '';
                    return;
                }
                const reader = new FileReader();
                reader.onload = function(e) {
                    const base64Data = e.target.result;
                    currentImageData[inputId] = base64Data;
                    preview.innerHTML = `<img src="${base64Data}" alt="Preview">`;
                    preview.classList.add('has-image');
                };
                reader.readAsDataURL(file);
            }
        }
        function updateMainLogo(base64Data) {
            const logoElement = document.getElementById('main-logo');
            logoElement.innerHTML = `<img src="${base64Data}" alt="Courtside Liberia">`;
        }
        function updateCoverPhoto(base64Data) {
            const coverPhoto = document.getElementById('cover-photo');
            const coverImage = document.getElementById('cover-image');
            coverImage.src = base64Data;
            coverPhoto.classList.add('show');
        }
        // News Functions
        async function addNews() {
            const title = document.getElementById('news-title').value.trim();
            const content = document.getElementById('news-content').value.trim();
            const imageData = currentImageData['news-image'];
            if (!title || !content) {
                alert('Please fill in title and content');
                return;
            }
            try {
                await db.collection("news").add({
                    title,
                    content,
                    image: imageData || null,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    date: new Date().toISOString().split('T')[0],
                    commentCount: 0 // Initialize comment count
                });
                // Clear form
                document.getElementById('news-title').value = '';
                document.getElementById('news-content').value = '';
                document.getElementById('news-image').value = '';
                document.getElementById('news-preview').innerHTML = '<span>Select an image</span>';
                document.getElementById('news-preview').classList.remove('has-image');
                delete currentImageData['news-image'];
                alert('News article added successfully!');
            } catch (error) {
                console.error("Error adding news:", error);
                alert('Error adding news article. Please try again.');
            }
        }
        async function removeNews(newsId) {
            if (!confirm('Are you sure you want to remove this news article?')) {
                return;
            }
            try {
                await db.collection("news").doc(newsId).delete();
                alert('News article removed successfully!');
            } catch (error) {
                console.error("Error removing news:", error);
                alert('Error removing news article. Please try again.');
            }
        }
        function renderNews() {
            const container = document.getElementById('news-grid');
            let html = '';
            if (appData.news.length === 0) {
                html = '<div class="loading"><div class="spinner"></div><p>Loading news...</p></div>';
            } else {
                appData.news.forEach(article => {
                    html += `
                        <div class="card news-card" onclick="showNewsDetails('${article.id}')">
                            <div class="news-image">
                                ${article.image ? `<img src="${article.image}" alt="${article.title}">` : '<i class="fas fa-newspaper" style="font-size: 3rem; opacity: 0.3;"></i>'}
                            </div>
                            <div class="news-meta">
                                <i class="fas fa-calendar-alt"></i> ${article.date || 'No date'}
                            </div>
                            <h3>${article.title}</h3>
                            <div class="news-excerpt">
                                ${article.content.substring(0, 150)}${article.content.length > 150 ? '...' : ''}
                            </div>
                            <div style="color: var(--accent-color); font-weight: bold;">
                                Read More <i class="fas fa-arrow-right"></i>
                            </div>
                        </div>
                    `;
                });
            }
            container.innerHTML = html;
        }
        function renderAdminNews() {
            const container = document.getElementById('admin-news-list');
            let html = '<h4><i class="fas fa-list"></i> Published Articles:</h4>';
            if (appData.news.length === 0) {
                html += '<p style="text-align: center; opacity: 0.7;">No news articles yet.</p>';
            } else {
                appData.news.forEach(article => {
                    html += `
                        <div class="card" style="margin-bottom: 1rem;">
                            <div style="display: flex; justify-content: space-between; align-items: flex-start; gap: 1rem;">
                                <div style="flex: 1;">
                                    <h4>${article.title}</h4>
                                    <p style="opacity: 0.7; margin: 0.5rem 0;">${article.date}</p>
                                    <p>${article.content.substring(0, 100)}${article.content.length > 100 ? '...' : ''}</p>
                                </div>
                                <div style="display: flex; gap: 0.5rem;">
                                    <button class="btn btn-danger" style="padding: 0.5rem 1rem; font-size: 0.8rem;" onclick="removeNews('${article.id}')">
                                        <i class="fas fa-trash"></i> Remove
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                });
            }
            container.innerHTML = html;
        }
        // Comments Functions
        function initializeComments() {
            // Create comments collection if it doesn't exist
            db.collection("comments").get().then((snapshot) => {
                console.log("Comments collection initialized");
            }).catch((error) => {
                console.log("Comments collection created:", error);
            });
        }
        
        async function addComment(newsId) {
            const nameInput = document.getElementById(`comment-name-${newsId}`);
            const contentInput = document.getElementById(`comment-content-${newsId}`);
            const name = nameInput.value.trim();
            const content = contentInput.value.trim();
            
            if (!name || !content) {
                alert('Please enter your name and comment');
                return;
            }
            
            try {
                // Add comment to Firestore
                const commentRef = await db.collection("comments").add({
                    newsId: newsId,
                    name: name,
                    content: content,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    date: new Date().toISOString().split('T')[0]
                });
                
                // Clear form
                nameInput.value = '';
                contentInput.value = '';
                
                // Update comment count for the news article
                const newsRef = db.collection("news").doc(newsId);
                await newsRef.update({
                    commentCount: firebase.firestore.FieldValue.increment(1)
                });
                
                // Reload comments
                loadComments(newsId);
                
                // Show success message
                alert('Comment added successfully!');
            } catch (error) {
                console.error("Error adding comment:", error);
                alert('Error adding comment. Please try again.');
            }
        }
        
        async function loadComments(newsId) {
            const commentsContainer = document.getElementById(`comments-list-${newsId}`);
            const loadingElement = document.getElementById(`comments-loading-${newsId}`);
            
            // Clear previous content
            if (commentsContainer) {
                commentsContainer.innerHTML = '';
            }
            
            try {
                // Get comments for this news article
                const commentsSnapshot = await db.collection("comments")
                    .where("newsId", "==", newsId)
                    .orderBy("timestamp", "asc")
                    .get();
                
                let html = '';
                
                if (commentsSnapshot.empty) {
                    html = '<p style="text-align: center; opacity: 0.7;">No comments yet. Be the first to comment!</p>';
                } else {
                    commentsSnapshot.forEach(doc => {
                        const comment = doc.data();
                        html += `
                            <div class="comment-card">
                                <div class="comment-header">
                                    <span class="comment-author">${comment.name}</span>
                                    <span class="comment-date">${comment.date}</span>
                                </div>
                                <div class="comment-content">${comment.content}</div>
                            </div>
                        `;
                    });
                }
                
                if (commentsContainer) {
                    commentsContainer.innerHTML = html;
                }
                
                if (loadingElement) {
                    loadingElement.style.display = 'none';
                }
            } catch (error) {
                console.error("Error loading comments:", error);
                if (commentsContainer) {
                    commentsContainer.innerHTML = '<div class="error-message">Comments system is initializing. Please try again in a few moments.</div>';
                }
                if (loadingElement) {
                    loadingElement.style.display = 'none';
                }
            }
        }
        
        function showNewsDetails(newsId) {
            const article = appData.news.find(n => n.id === newsId);
            if (!article) return;
            
            // Set up modal content
            document.getElementById('modal-title').innerHTML = `<i class="fas fa-newspaper"></i> ${article.title}`;
            
            // Create the HTML content
            let html = `
                <div style="margin-bottom: 1rem;">
                    ${article.image ? `<img src="${article.image}" alt="${article.title}" style="width: 100%; border-radius: var(--border-radius); margin-bottom: 1rem;">` : ''}
                    <p style="opacity: 0.7;"><i class="fas fa-calendar-alt"></i> ${article.date}</p>
                </div>
                <div style="line-height: 1.8; white-space: pre-line;">
                    ${article.content}
                </div>
            `;
            
            // Add comments section
            html += `
                <div style="border-top: 1px solid rgba(255, 255, 255, 0.2); padding-top: 2rem; margin-top: 2rem;">
                    <h3 style="margin-bottom: 1.5rem;"><i class="fas fa-comments"></i> Comments (${article.commentCount || 0})</h3>
                    
                    <!-- Add Comment Form -->
                    <div class="card" style="margin-bottom: 2rem;">
                        <h4 style="margin-bottom: 1rem;">Add a Comment</h4>
                        <div class="form-group">
                            <input type="text" id="comment-name-${newsId}" class="form-input" placeholder="Your Name" style="margin-bottom: 1rem;">
                            <textarea id="comment-content-${newsId}" class="form-textarea" placeholder="Write your comment here..." style="margin-bottom: 1rem;"></textarea>
                            <button class="btn btn-primary" onclick="addComment('${newsId}')">
                                <i class="fas fa-paper-plane"></i> Post Comment
                            </button>
                        </div>
                    </div>
                    
                    <!-- Comments List -->
                    <div id="comments-list-${newsId}" style="max-height: 400px; overflow-y: auto;">
                        <div class="comments-loading" id="comments-loading-${newsId}">
                            <div class="comments-spinner"></div>
                            <p>Loading comments...</p>
                        </div>
                    </div>
                </div>
            `;
            
            // Set the modal body content
            document.getElementById('modal-body').innerHTML = html;
            document.getElementById('modal').style.display = 'block';
            
            // Load comments for this article
            setTimeout(() => {
                loadComments(newsId);
            }, 500);
        }
        
        // Update your loadNews function to include comment counts
        function renderNews() {
            const container = document.getElementById('news-grid');
            let html = '';
            if (appData.news.length === 0) {
                html = '<div class="loading"><div class="spinner"></div><p>Loading news...</p></div>';
            } else {
                appData.news.forEach(article => {
                    html += `
                        <div class="card news-card" onclick="showNewsDetails('${article.id}')">
                            <div class="news-image">
                                ${article.image ? `<img src="${article.image}" alt="${article.title}">` : '<i class="fas fa-newspaper" style="font-size: 3rem; opacity: 0.3;"></i>'}
                            </div>
                            <div class="news-meta">
                                <i class="fas fa-calendar-alt"></i> ${article.date || 'No date'}
                            </div>
                            <h3>${article.title}</h3>
                            <div class="news-excerpt">
                                ${article.content.substring(0, 150)}${article.content.length > 150 ? '...' : ''}
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 1rem;">
                                <div style="color: var(--accent-color); font-weight: bold;">
                                    Read More <i class="fas fa-arrow-right"></i>
                                </div>
                                <div style="background: rgba(255, 255, 255, 0.1); padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.8rem;">
                                    <i class="fas fa-comments"></i> ${article.commentCount || 0} Comments
                                </div>
                            </div>
                        </div>
                    `;
                });
            }
            container.innerHTML = html;
        }
        
        // Update your renderAdminNews function
        function renderAdminNews() {
            const container = document.getElementById('admin-news-list');
            let html = '<h4><i class="fas fa-list"></i> Published Articles:</h4>';
            if (appData.news.length === 0) {
                html += '<p style="text-align: center; opacity: 0.7;">No news articles yet.</p>';
            } else {
                appData.news.forEach(article => {
                    html += `
                        <div class="card" style="margin-bottom: 1rem;">
                            <div style="display: flex; justify-content: space-between; align-items: flex-start; gap: 1rem;">
                                <div style="flex: 1;">
                                    <h4>${article.title}</h4>
                                    <p style="opacity: 0.7; margin: 0.5rem 0;">${article.date}</p>
                                    <p>${article.content.substring(0, 100)}${article.content.length > 100 ? '...' : ''}</p>
                                    <p style="font-size: 0.9rem; margin-top: 0.5rem;">
                                        <i class="fas fa-comments"></i> ${article.commentCount || 0} Comments
                                    </p>
                                </div>
                                <div style="display: flex; gap: 0.5rem;">
                                    <button class="btn btn-danger" style="padding: 0.5rem 1rem; font-size: 0.8rem;" onclick="removeNews('${article.id}')">
                                        <i class="fas fa-trash"></i> Remove
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                });
            }
            container.innerHTML = html;
        }
        
        // Update your showNewsDetails function in the home page preview
        function renderHomeNewsPreview() {
            const container = document.getElementById('home-news-grid');
            const latestNews = appData.news.slice(0, 3); // Show latest 3 articles
            let html = '';
            if (latestNews.length === 0) {
                html = '<div class="loading"><p>No news articles yet.</p></div>';
            } else {
                latestNews.forEach(article => {
                    html += `
                        <div class="card news-card" onclick="showNewsDetails('${article.id}')">
                            <div class="news-image">
                                ${article.image ? `<img src="${article.image}" alt="${article.title}">` : '<i class="fas fa-newspaper" style="font-size: 3rem; opacity: 0.3;"></i>'}
                            </div>
                            <div class="news-meta">
                                <i class="fas fa-calendar-alt"></i> ${article.date || 'No date'}
                            </div>
                            <h3>${article.title}</h3>
                            <div class="news-excerpt">
                                ${article.content.substring(0, 100)}${article.content.length > 100 ? '...' : ''}
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 1rem;">
                                <div style="color: var(--accent-color); font-weight: bold;">
                                    Read More <i class="fas fa-arrow-right"></i>
                                </div>
                                <div style="background: rgba(255, 255, 255, 0.1); padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.8rem;">
                                    <i class="fas fa-comments"></i> ${article.commentCount || 0} Comments
                                </div>
                            </div>
                        </div>
                    `;
                });
            }
            container.innerHTML = html;
        }
        
        // Team Functions
        async function addTeam() {
            const division = document.getElementById('team-division').value;
            const name = document.getElementById('team-name').value.trim();
            const logoData = currentImageData['team-logo'];
            if (!name) {
                alert('Please enter a team name');
                return;
            }
            const existingTeam = appData.teams[division].find(team => team.name === name);
            if (existingTeam) {
                alert('Team name already exists in this division');
                return;
            }
            try {
                await db.collection("teams").add({
                    division,
                    name,
                    logo: logoData || null,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });
                document.getElementById('team-name').value = '';
                document.getElementById('team-logo').value = '';
                document.getElementById('team-logo-preview').innerHTML = '<span>Select team logo</span>';
                document.getElementById('team-logo-preview').classList.remove('has-image');
                delete currentImageData['team-logo'];
                alert('Team added successfully!');
            } catch (error) {
                console.error("Error adding team:", error);
                alert('Error adding team. Please try again.');
            }
        }
        async function removeTeam(teamId) {
            if (!confirm('Are you sure you want to remove this team?')) {
                return;
            }
            try {
                await db.collection("teams").doc(teamId).delete();
                alert('Team removed successfully!');
            } catch (error) {
                console.error("Error removing team:", error);
                alert('Error removing team. Please try again.');
            }
        }
        function renderDivisionTeams(division) {
            const container = document.getElementById('division-teams');
            const teams = appData.teams[division] || [];
            let html = '';
            if (teams.length === 0) {
                html = '<div class="loading"><p>No teams in this division yet.</p></div>';
            } else {
                teams.forEach(team => {
                    const logoKey = `${division}-${team.name}`;
                    const logoSrc = appData.settings.teamLogos[logoKey];
                    html += `
                        <div class="card team-card" onclick="showTeamDetails('${division}', '${team.name}')">
                            <div class="team-logo">
                                ${logoSrc ? `<img src="${logoSrc}" alt="${team.name}">` : team.name.charAt(0)}
                            </div>
                            <h4>${team.name}</h4>
                        </div>
                    `;
                });
            }
            container.innerHTML = html;
        }
        function renderAdminTeams() {
            const container = document.getElementById('admin-teams-list');
            let html = '<h4><i class="fas fa-list"></i> Current Teams:</h4>';
            let hasTeams = false;
            Object.keys(appData.teams).forEach(division => {
                if (appData.teams[division].length > 0) {
                    hasTeams = true;
                    html += `<h5>${getDivisionName(division)}:</h5>`;
                    appData.teams[division].forEach(team => {
                        html += `
                            <div class="card" style="margin-bottom: 0.5rem;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div style="display: flex; align-items: center; gap: 1rem;">
                                        <div class="team-logo-small">
                                            ${team.logo ? `<img src="${team.logo}" alt="${team.name}">` : team.name.charAt(0)}
                                        </div>
                                        <span>${team.name}</span>
                                    </div>
                                    <button class="btn btn-danger" style="padding: 0.5rem 1rem; font-size: 0.8rem;" onclick="removeTeam('${team.id}')">
                                        <i class="fas fa-trash"></i> Remove
                                    </button>
                                </div>
                            </div>
                        `;
                    });
                }
            });
            if (!hasTeams) {
                html += '<p style="text-align: center; opacity: 0.7;">No teams added yet.</p>';
            }
            container.innerHTML = html;
        }
        function updateTeamSelects() {
            updateFixtureTeams();
            updateMatchTeams();
        }
        function updateFixtureTeams() {
            const division = document.getElementById('fixture-division').value;
            const homeSelect = document.getElementById('fixture-home-team');
            const awaySelect = document.getElementById('fixture-away-team');
            homeSelect.innerHTML = '';
            awaySelect.innerHTML = '';
            const teams = appData.teams[division] || [];
            teams.forEach(team => {
                homeSelect.innerHTML += `<option value="${team.name}">${team.name}</option>`;
                awaySelect.innerHTML += `<option value="${team.name}">${team.name}</option>`;
            });
        }
        function updateMatchTeams() {
            const division = document.getElementById('match-division').value;
            const homeSelect = document.getElementById('match-home-team');
            const awaySelect = document.getElementById('match-away-team');
            homeSelect.innerHTML = '';
            awaySelect.innerHTML = '';
            const teams = appData.teams[division] || [];
            teams.forEach(team => {
                homeSelect.innerHTML += `<option value="${team.name}">${team.name}</option>`;
                awaySelect.innerHTML += `<option value="${team.name}">${team.name}</option>`;
            });
        }
        // Player Functions
        async function addPlayer() {
            const division = document.getElementById('player-division').value;
            const team = document.getElementById('player-team').value;
            const name = document.getElementById('player-name').value.trim();
            const number = document.getElementById('player-number').value;
            const position = document.getElementById('player-position').value;
            const photoData = currentImageData['player-photo'];
            if (!division || !team) {
                alert('Please select a division and team');
                return;
            }
            if (!name) {
                alert('Please enter a player name');
                return;
            }
            try {
                await db.collection("players").add({
                    division,
                    team,
                    name,
                    number: number ? parseInt(number, 10) : null,
                    position,
                    photo: photoData || null,
                    gamesPlayed: 0,
                    totalPoints: 0,
                    totalRebounds: 0,
                    totalAssists: 0,
                    totalSteals: 0,
                    totalBlocks: 0,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });
                // Reset form
                document.getElementById('player-name').value = '';
                document.getElementById('player-number').value = '';
                document.getElementById('player-position').value = 'PG';
                document.getElementById('player-photo').value = '';
                document.getElementById('player-photo-preview').innerHTML = '<span>Select player photo</span>';
                document.getElementById('player-photo-preview').classList.remove('has-image');
                delete currentImageData['player-photo'];
                alert('Player added successfully!');
                renderAdminPlayers();
            } catch (error) {
                console.error("Error adding player:", error);
                alert('Error adding player. Please try again.');
            }
        }
        async function removePlayer(playerId) {
            if (!confirm('Are you sure you want to remove this player?')) {
                return;
            }
            try {
                await db.collection("players").doc(playerId).delete();
                alert('Player removed successfully!');
                renderAdminPlayers();
            } catch (error) {
                console.error("Error removing player:", error);
                alert('Error removing player. Please try again.');
            }
        }
        function renderAdminPlayers() {
            const container = document.getElementById('admin-players-list');
            let html = '<h4><i class="fas fa-list"></i> Current Players:</h4>';
            if (!appData.players || appData.players.length === 0) {
                html += '<p style="text-align: center; opacity: 0.7;">No players added yet.</p>';
            } else {
                // Group players by division and team
                const playersByDivision = {};
                appData.players.forEach(player => {
                    if (!playersByDivision[player.division]) {
                        playersByDivision[player.division] = {};
                    }
                    if (!playersByDivision[player.division][player.team]) {
                        playersByDivision[player.division][player.team] = [];
                    }
                    playersByDivision[player.division][player.team].push(player);
                });
                Object.keys(playersByDivision).forEach(division => {
                    html += `<h5>${getDivisionName(division)}:</h5>`;
                    Object.keys(playersByDivision[division]).forEach(team => {
                        html += `<h6 style="margin: 1rem 0 0.5rem;">${team}:</h6>`;
                        playersByDivision[division][team].forEach(player => {
                            html += `
                                <div class="card" style="margin-bottom: 0.5rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div style="display: flex; align-items: center; gap: 1rem;">
                                            ${player.photo ? 
                                                `<div class="team-logo-small"><img src="${player.photo}" alt="${player.name}"></div>` : 
                                                `<div class="team-logo-small">${player.name.charAt(0)}</div>`}
                                            <div>
                                                <strong>${player.name}</strong>
                                                ${player.number ? `(#${player.number})` : ''}
                                                <br>
                                                <small>${player.position} | ${player.gamesPlayed} games</small>
                                            </div>
                                        </div>
                                        <button class="btn btn-danger" style="padding: 0.5rem 1rem; font-size: 0.8rem;" onclick="removePlayer('${player.id}')">
                                            <i class="fas fa-trash"></i> Remove
                                        </button>
                                    </div>
                                </div>
                            `;
                        });
                    });
                });
            }
            container.innerHTML = html;
        }
        function updatePlayerTeams() {
            const division = document.getElementById('player-division').value;
            const teamSelect = document.getElementById('player-team');
            if (!teamSelect) return;
            teamSelect.innerHTML = '<option value="">Select Team</option>';
            const teams = appData.teams[division] || [];
            teams.forEach(team => {
                teamSelect.innerHTML += `<option value="${team.name}">${team.name}</option>`;
            });
        }
        // Fixture Functions
        async function addFixture() {
            const division = document.getElementById('fixture-division').value;
            const homeTeam = document.getElementById('fixture-home-team').value;
            const awayTeam = document.getElementById('fixture-away-team').value;
            const date = document.getElementById('fixture-date').value;
            const time = document.getElementById('fixture-time').value;
            if (!homeTeam || !awayTeam || !date || !time) {
                alert('Please fill in all fields');
                return;
            }
            if (homeTeam === awayTeam) {
                alert('Home and Away teams cannot be the same!');
                return;
            }
            try {
                await db.collection("fixtures").add({
                    division,
                    homeTeam,
                    awayTeam,
                    date,
                    time,
                    played: false,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });
                document.getElementById('fixture-date').value = '';
                document.getElementById('fixture-time').value = '';
                alert("Fixture added successfully!");
            } catch (error) {
                console.error("Error adding fixture:", error);
                alert("Error adding fixture. Please try again.");
            }
        }
        async function removeFixture(fixtureId) {
            if (!confirm('Are you sure you want to remove this fixture?')) {
                return;
            }
            try {
                await db.collection("fixtures").doc(fixtureId).delete();
                alert("Fixture removed successfully!");
            } catch (error) {
                console.error("Error removing fixture:", error);
                alert("Error removing fixture. Please try again.");
            }
        }
        function filterFixtures() {
            const selectedDivision = document.getElementById('fixtures-division-filter').value;
            renderFixtures(selectedDivision);
        }
        function renderFixtures(filterDivision = 'all') {
            const container = document.getElementById('fixtures-list');
            let fixtures = appData.fixtures.filter(f => !f.played);
            if (filterDivision !== 'all') {
                fixtures = fixtures.filter(f => f.division === filterDivision);
            }
            fixtures = fixtures.sort((a, b) => new Date(a.date) - new Date(b.date));
            let html = '';
            if (fixtures.length === 0) {
                html = '<div class="loading"><p>No fixtures scheduled for this division.</p></div>';
            } else {
                fixtures.forEach(fixture => {
                    html += `
                        <div class="match-card">
                            <div class="match-header">
                                <span><i class="fas fa-medal"></i> ${getDivisionName(fixture.division)}</span>
                                <span><i class="fas fa-calendar-alt"></i> ${fixture.date} <i class="fas fa-clock"></i> ${fixture.time}</span>
                            </div>
                            <div class="team-vs">
                                <div class="team-info">
                                    ${getTeamLogo(fixture.division, fixture.homeTeam)}
                                    <strong>${fixture.homeTeam}</strong>
                                    <small style="opacity: 0.7;">(Home)</small>
                                </div>
                                <div class="vs-divider">VS</div>
                                <div class="team-info" style="text-align: right;">
                                    <small style="opacity: 0.7;">(Away)</small>
                                    <strong>${fixture.awayTeam}</strong>
                                    ${getTeamLogo(fixture.division, fixture.awayTeam)}
                                </div>
                            </div>
                        </div>
                    `;
                });
            }
            container.innerHTML = html;
        }
        function renderAdminFixtures() {
            const container = document.getElementById('admin-fixtures-list');
            const upcomingFixtures = appData.fixtures.filter(f => !f.played).sort((a, b) => new Date(a.date) - new Date(b.date));
            let html = '<h4><i class="fas fa-calendar-alt"></i> Upcoming Fixtures:</h4>';
            if (upcomingFixtures.length === 0) {
                html += '<p style="text-align: center; opacity: 0.7;">No upcoming fixtures scheduled.</p>';
            } else {
                upcomingFixtures.forEach(fixture => {
                    html += `
                        <div class="card" style="margin-bottom: 1rem;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <strong><i class="fas fa-medal"></i> ${getDivisionName(fixture.division)}</strong><br>
                                    <span>${fixture.homeTeam} vs ${fixture.awayTeam}</span><br>
                                    <small><i class="fas fa-calendar-alt"></i> ${fixture.date} <i class="fas fa-clock"></i> ${fixture.time}</small>
                                </div>
                                <button class="btn btn-danger" style="padding: 0.5rem 1rem; font-size: 0.8rem;" onclick="removeFixture('${fixture.id}')">
                                    <i class="fas fa-trash"></i> Remove
                                </button>
                            </div>
                        </div>
                    `;
                });
            }
            container.innerHTML = html;
        }
        // Match Result Functions
        function toggleMatchInputs() {
            const resultType = document.getElementById('match-result-type').value;
            const normalInputs = document.getElementById('match-normal-inputs');
            const forfeitInputs = document.getElementById('match-forfeit-inputs');
            if (resultType === 'forfeit') {
                normalInputs.classList.add('hidden');
                forfeitInputs.classList.remove('hidden');
            } else {
                normalInputs.classList.remove('hidden');
                forfeitInputs.classList.add('hidden');
            }
        }
        async function addMatchResult() {
            const division = document.getElementById('match-division').value;
            const homeTeam = document.getElementById('match-home-team').value;
            const awayTeam = document.getElementById('match-away-team').value;
            const date = document.getElementById('match-date').value;
            const resultType = document.getElementById('match-result-type').value;
            if (!homeTeam || !awayTeam || !date) {
                alert('Please fill in all required fields');
                return;
            }
            let resultData = {
                division,
                homeTeam,
                awayTeam,
                date,
                played: true,
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            };
            if (resultType === 'normal') {
                const homeScore = parseInt(document.getElementById('match-home-score').value, 10);
                const awayScore = parseInt(document.getElementById('match-away-score').value, 10);
                if (isNaN(homeScore) || isNaN(awayScore)) {
                    alert("Please enter both scores");
                    return;
                }
                resultData.homeScore = homeScore;
                resultData.awayScore = awayScore;
            } else if (resultType === 'forfeit') {
                const forfeitTeam = document.getElementById('match-forfeit-team').value;
                resultData.forfeit = true;
                resultData.forfeitTeam = forfeitTeam;
                resultData.homeScore = forfeitTeam === "home" ? 0 : 20;
                resultData.awayScore = forfeitTeam === "away" ? 0 : 20;
            }
            try {
                let docRef;
                const querySnapshot = await db.collection("fixtures")
                    .where("division", "==", division)
                    .where("homeTeam", "==", homeTeam)
                    .where("awayTeam", "==", awayTeam)
                    .where("date", "==", date)
                    .limit(1)
                    .get();
                if (!querySnapshot.empty) {
                    docRef = querySnapshot.docs[0].ref;
                    await docRef.update(resultData);
                } else {
                    docRef = await db.collection("fixtures").add(resultData);
                }
                // If this is a normal game (not forfeit), ask for player stats
                if (resultType === 'normal') {
                    currentMatchForStats = {
                        id: docRef.id,
                        division: division,
                        homeTeam: homeTeam,
                        awayTeam: awayTeam,
                        date: date
                    };
                    setTimeout(() => {
                        showPlayerStatsModal();
                    }, 500);
                }
                // Show notification for new result
                let resultText, winnerText;
                if (resultType === 'forfeit') {
                    const forfeitingTeam = resultData.forfeitTeam === 'home' ? homeTeam : awayTeam;
                    const winningTeam = resultData.forfeitTeam === 'home' ? awayTeam : homeTeam;
                    resultText = 'FORFEIT';
                    winnerText = `${winningTeam} wins by forfeit`;
                } else {
                    resultText = `${resultData.homeScore} - ${resultData.awayScore}`;
                    const winner = resultData.homeScore > resultData.awayScore ? homeTeam : 
                                  resultData.homeScore < resultData.awayScore ? awayTeam : 'Draw';
                    winnerText = winner === 'Draw' ? 'Match ended in a draw' : `${winner} wins`;
                }
                
                showNotification(
                    '🏀 New Match Result!',
                    `${homeTeam} ${resultData.homeScore} - ${resultData.awayScore} ${awayTeam}<br><strong>${winnerText}</strong><br><em>${getDivisionName(division)}</em>`,
                    'success'
                );
                
                document.getElementById('match-home-score').value = '';
                document.getElementById('match-away-score').value = '';
                document.getElementById('match-date').value = '';
                alert("Match result recorded successfully!");
            } catch (error) {
                console.error("Error recording match result:", error);
                alert("Error recording match result. Please try again.");
            }
        }
        function showPlayerStatsModal() {
            if (!currentMatchForStats) return;
            const { division, homeTeam, awayTeam } = currentMatchForStats;
            // Get players for both teams
            const homePlayers = appData.players.filter(p => p.team === homeTeam && p.division === division);
            const awayPlayers = appData.players.filter(p => p.team === awayTeam && p.division === division);
            let html = `
                <h3><i class="fas fa-basketball"></i> Record Player Stats for ${homeTeam} vs ${awayTeam}</h3>
                <p>Enter stats for players who participated in this match:</p>
                <input type="hidden" id="stats-match-id" value="${currentMatchForStats.id}">
                <h4 style="margin: 2rem 0 1rem;">${homeTeam} Players</h4>
            `;
            if (homePlayers.length === 0) {
                html += '<p style="opacity: 0.7;">No players added for this team yet.</p>';
            } else {
                html += '<div class="game-stats-form">';
                homePlayers.forEach(player => {
                    html += `
                        <div class="player-stats-card">
                            <div class="player-header">
                                ${player.photo ? 
                                    `<div class="player-photo"><img src="${player.photo}" alt="${player.name}"></div>` : 
                                    `<div class="player-photo">${player.name.charAt(0)}</div>`}
                                <div class="player-info">
                                    <h3>${player.name}</h3>
                                    <p>${player.position} ${player.number ? `(#${player.number})` : ''}</p>
                                </div>
                            </div>
                            <div class="game-stats-grid">
                                <div class="game-stat-input">
                                    <label class="form-label">Points</label>
                                    <input type="number" class="form-input" id="stats-${player.id}-points" placeholder="0" min="0" value="0">
                                </div>
                                <div class="game-stat-input">
                                    <label class="form-label">Rebounds</label>
                                    <input type="number" class="form-input" id="stats-${player.id}-rebounds" placeholder="0" min="0" value="0">
                                </div>
                                <div class="game-stat-input">
                                    <label class="form-label">Assists</label>
                                    <input type="number" class="form-input" id="stats-${player.id}-assists" placeholder="0" min="0" value="0">
                                </div>
                                <div class="game-stat-input">
                                    <label class="form-label">Steals</label>
                                    <input type="number" class="form-input" id="stats-${player.id}-steals" placeholder="0" min="0" value="0">
                                </div>
                                <div class="game-stat-input">
                                    <label class="form-label">Blocks</label>
                                    <input type="number" class="form-input" id="stats-${player.id}-blocks" placeholder="0" min="0" value="0">
                                </div>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
            }
            html += `
                <h4 style="margin: 2rem 0 1rem;">${awayTeam} Players</h4>
            `;
            if (awayPlayers.length === 0) {
                html += '<p style="opacity: 0.7;">No players added for this team yet.</p>';
            } else {
                html += '<div class="game-stats-form">';
                awayPlayers.forEach(player => {
                    html += `
                        <div class="player-stats-card">
                            <div class="player-header">
                                ${player.photo ? 
                                    `<div class="player-photo"><img src="${player.photo}" alt="${player.name}"></div>` : 
                                    `<div class="player-photo">${player.name.charAt(0)}</div>`}
                                <div class="player-info">
                                    <h3>${player.name}</h3>
                                    <p>${player.position} ${player.number ? `(#${player.number})` : ''}</p>
                                </div>
                            </div>
                            <div class="game-stats-grid">
                                <div class="game-stat-input">
                                    <label class="form-label">Points</label>
                                    <input type="number" class="form-input" id="stats-${player.id}-points" placeholder="0" min="0" value="0">
                                </div>
                                <div class="game-stat-input">
                                    <label class="form-label">Rebounds</label>
                                    <input type="number" class="form-input" id="stats-${player.id}-rebounds" placeholder="0" min="0" value="0">
                                </div>
                                <div class="game-stat-input">
                                    <label class="form-label">Assists</label>
                                    <input type="number" class="form-input" id="stats-${player.id}-assists" placeholder="0" min="0" value="0">
                                </div>
                                <div class="game-stat-input">
                                    <label class="form-label">Steals</label>
                                    <input type="number" class="form-input" id="stats-${player.id}-steals" placeholder="0" min="0" value="0">
                                </div>
                                <div class="game-stat-input">
                                    <label class="form-label">Blocks</label>
                                    <input type="number" class="form-input" id="stats-${player.id}-blocks" placeholder="0" min="0" value="0">
                                </div>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
            }
            html += `
                <div style="margin-top: 2rem; text-align: center;">
                    <button class="btn btn-success" onclick="savePlayerStats()">
                        <i class="fas fa-save"></i> Save Player Stats
                    </button>
                    <button class="btn btn-secondary" onclick="closePlayerStatsModal()">
                        <i class="fas fa-times"></i> Skip for now
                    </button>
                </div>
            `;
            document.getElementById('player-stats-modal-title').innerHTML = `<i class="fas fa-basketball"></i> Player Statistics`;
            document.getElementById('player-stats-modal-body').innerHTML = html;
            document.getElementById('player-stats-modal').style.display = 'block';
        }
        async function savePlayerStats() {
            if (!currentMatchForStats) return;
            const matchId = currentMatchForStats.id;
            const division = currentMatchForStats.division;
            const homeTeam = currentMatchForStats.homeTeam;
            const awayTeam = currentMatchForStats.awayTeam;
            // Get all players for both teams
            const homePlayers = appData.players.filter(p => p.team === homeTeam && p.division === division);
            const awayPlayers = appData.players.filter(p => p.team === awayTeam && p.division === division);
            const allPlayers = [...homePlayers, ...awayPlayers];
            try {
                // Create a batch write for all player updates
                const batch = db.batch();
                allPlayers.forEach(player => {
                    const points = parseInt(document.getElementById(`stats-${player.id}-points`).value) || 0;
                    const rebounds = parseInt(document.getElementById(`stats-${player.id}-rebounds`).value) || 0;
                    const assists = parseInt(document.getElementById(`stats-${player.id}-assists`).value) || 0;
                    const steals = parseInt(document.getElementById(`stats-${player.id}-steals`).value) || 0;
                    const blocks = parseInt(document.getElementById(`stats-${player.id}-blocks`).value) || 0;
                    // Only update if any stats were entered
                    if (points > 0 || rebounds > 0 || assists > 0 || steals > 0 || blocks > 0) {
                        const playerRef = db.collection("players").doc(player.id);
                        batch.update(playerRef, {
                            gamesPlayed: firebase.firestore.FieldValue.increment(1),
                            totalPoints: firebase.firestore.FieldValue.increment(points),
                            totalRebounds: firebase.firestore.FieldValue.increment(rebounds),
                            totalAssists: firebase.firestore.FieldValue.increment(assists),
                            totalSteals: firebase.firestore.FieldValue.increment(steals),
                            totalBlocks: firebase.firestore.FieldValue.increment(blocks)
                        });
                        // Also save individual game stats
                        db.collection("playerStats").add({
                            playerId: player.id,
                            playerName: player.name,
                            team: player.team,
                            division: player.division,
                            matchId: matchId,
                            opponent: player.team === homeTeam ? awayTeam : homeTeam,
                            points,
                            rebounds,
                            assists,
                            steals,
                            blocks,
                            date: currentMatchForStats.date,
                            timestamp: firebase.firestore.FieldValue.serverTimestamp()
                        });
                    }
                });
                await batch.commit();
                closePlayerStatsModal();
                currentMatchForStats = null;
                alert('Player stats saved successfully!');
            } catch (error) {
                console.error("Error saving player stats:", error);
                alert('Error saving player stats. Please try again.');
            }
        }
        function closePlayerStatsModal() {
            document.getElementById('player-stats-modal').style.display = 'none';
        }
        // Results Functions
        function filterResults() {
            const selectedDivision = document.getElementById('results-division-filter').value;
            renderResults(selectedDivision);
        }
        function renderResults(filterDivision = 'all') {
            const container = document.getElementById('results-list');
            let results = appData.results.filter(r => r.played);
            if (filterDivision !== 'all') {
                results = results.filter(r => r.division === filterDivision);
            }
            results = results.sort((a, b) => new Date(b.date) - new Date(a.date));
            let html = '';
            if (results.length === 0) {
                html = '<div class="loading"><p>No results available for this division.</p></div>';
            } else {
                results.forEach(result => {
                    let resultText, winnerText, winnerClass = '';
                    if (result.forfeit) {
                        const forfeitingTeam = result.forfeitTeam === 'home' ? result.homeTeam : result.awayTeam;
                        const winningTeam = result.forfeitTeam === 'home' ? result.awayTeam : result.homeTeam;
                        resultText = 'FORFEIT';
                        winnerText = `${forfeitingTeam} forfeited - Winner: ${winningTeam}`;
                        winnerClass = 'status-forfeit';
                    } else {
                        resultText = `${result.homeScore} - ${result.awayScore}`;
                        const winner = result.homeScore > result.awayScore ? result.homeTeam : 
                                      result.homeScore < result.awayScore ? result.awayTeam : null;
                        winnerText = winner ? `Winner: ${winner}` : 'Match ended in a tie';
                        winnerClass = winner ? 'status-win' : '';
                    }
                    html += `
                        <div class="match-card">
                            <div class="match-header">
                                <span><i class="fas fa-medal"></i> ${getDivisionName(result.division)}</span>
                                <span><i class="fas fa-calendar-alt"></i> ${result.date}</span>
                            </div>
                            <div class="team-vs">
                                <div class="team-info">
                                    ${getTeamLogo(result.division, result.homeTeam)}
                                    <strong>${result.homeTeam}</strong>
                                    <small style="opacity: 0.7;">(Home)</small>
                                </div>
                                <div class="vs-divider">${resultText}</div>
                                <div class="team-info" style="text-align: right;">
                                    <small style="opacity: 0.7;">(Away)</small>
                                    <strong>${result.awayTeam}</strong>
                                    ${getTeamLogo(result.division, result.awayTeam)}
                                </div>
                            </div>
                            <div class="match-result">
                                <span class="${winnerClass}"><i class="fas fa-trophy"></i> ${winnerText}</span>
                            </div>
                        </div>
                    `;
                });
            }
            container.innerHTML = html;
        }
        async function removeResult(resultId) {
            if (!confirm('Are you sure you want to remove this match result? This will revert it to a scheduled fixture.')) {
                return;
            }
            try {
                await db.collection("fixtures").doc(resultId).update({
                    played: false,
                    homeScore: firebase.firestore.FieldValue.delete(),
                    awayScore: firebase.firestore.FieldValue.delete(),
                    forfeit: firebase.firestore.FieldValue.delete(),
                    forfeitTeam: firebase.firestore.FieldValue.delete()
                });
                alert('Match result removed successfully!');
            } catch (error) {
                console.error("Error removing result:", error);
                alert('Error removing result. Please try again.');
            }
        }
        function renderAdminResults() {
            const container = document.getElementById('admin-results-list');
            const selectedDivision = document.getElementById('admin-results-division-filter').value;
            if (!appData.results || appData.results.length === 0) {
                container.innerHTML = '<p style="text-align: center; opacity: 0.7;">No results loaded yet.</p>';
                return;
            }
            let results = appData.results.filter(r => r.played);
            if (selectedDivision !== 'all') {
                results = results.filter(r => r.division === selectedDivision);
            }
            results.sort((a, b) => new Date(b.date) - new Date(a.date));
            let html = '<h4><i class="fas fa-clipboard-list"></i> Recorded Results:</h4>';
            if (results.length === 0) {
                html += '<p style="text-align: center; opacity: 0.7;">No results recorded for this division.</p>';
            } else {
                results.forEach(result => {
                    let resultText;
                    if (result.forfeit) {
                        const forfeitingTeam = result.forfeitTeam === 'home' ? result.homeTeam : result.awayTeam;
                        resultText = `FORFEIT by ${forfeitingTeam}`;
                    } else {
                        resultText = `${result.homeScore} - ${result.awayScore}`;
                    }
                    html += `
                        <div class="card" style="margin-bottom: 1rem;">
                            <div style="display: flex; justify-content: space-between; align-items: flex-start; gap: 1rem;">
                                <div style="flex: 1;">
                                    <strong><i class="fas fa-medal"></i> ${getDivisionName(result.division)}</strong><br>
                                    <span>${result.homeTeam} vs ${result.awayTeam}</span><br>
                                    <small><i class="fas fa-calendar-alt"></i> ${result.date}</small><br>
                                    <span><strong>Result:</strong> ${resultText}</span>
                                </div>
                                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                                    <button class="btn btn-danger" style="padding: 0.5rem 1rem; font-size: 0.8rem;" onclick="removeResult('${result.id}')">
                                        <i class="fas fa-trash"></i> Remove Result
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                });
            }
            container.innerHTML = html;
        }
        // Settings Functions
        async function uploadMainLogo() {
            const logoData = currentImageData['main-logo-upload'];
            if (!logoData) {
                alert('Please select a logo first');
                return;
            }
            try {
                await db.collection("settings").doc("mainLogo").set({
                     logoData,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });
                updateMainLogo(logoData);
                alert('Main logo updated successfully!');
            } catch (error) {
                console.error("Error uploading main logo:", error);
                alert('Error uploading logo. Please try again.');
            }
        }
        async function uploadCoverPhoto() {
            const coverData = currentImageData['cover-photo-upload'];
            if (!coverData) {
                alert('Please select a cover photo first');
                return;
            }
            try {
                await db.collection("settings").doc("coverPhoto").set({
                     coverData,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });
                updateCoverPhoto(coverData);
                alert('Cover photo updated successfully!');
            } catch (error) {
                console.error("Error uploading cover photo:", error);
                alert('Error uploading cover photo. Please try again.');
            }
        }
        // Team Details & Standings
        function showDivisionStandings(division) {
            const teams = appData.teams[division].map(team => team.name);
            const divisionResults = appData.results.filter(r => r.division === division && r.played);
            const standings = teams.map(teamName => {
                const teamResults = divisionResults.filter(result => 
                    result.homeTeam === teamName || result.awayTeam === teamName
                );
                let wins = 0, losses = 0, forfeits = 0, pointsFor = 0, pointsAgainst = 0;
                teamResults.forEach(result => {
                    const isHome = result.homeTeam === teamName;
                    const teamScore = isHome ? result.homeScore : result.awayScore;
                    const opponentScore = isHome ? result.awayScore : result.homeScore;
                    pointsFor += teamScore;
                    pointsAgainst += opponentScore;
                    if (result.forfeit) {
                        if ((isHome && result.forfeitTeam === 'home') || (!isHome && result.forfeitTeam === 'away')) {
                            forfeits++;
                        } else {
                            wins++;
                        }
                    } else {
                        if (teamScore > opponentScore) {
                            wins++;
                        } else {
                            losses++;
                        }
                    }
                });
                const totalPoints = (wins * 2) + (losses * 1) + (forfeits * 0);
                return {
                    team: teamName,
                    played: teamResults.length,
                    wins,
                    losses,
                    forfeits,
                    pointsFor,
                    pointsAgainst,
                    pointsDiff: pointsFor - pointsAgainst,
                    points: totalPoints
                };
            });
            standings.sort((a, b) => {
                if (b.points !== a.points) return b.points - a.points;
                if (b.pointsDiff !== a.pointsDiff) return b.pointsDiff - a.pointsDiff;
                return b.pointsFor - a.pointsFor;
            });
            let html = `
                <h2><i class="fas fa-chart-line"></i> ${getDivisionName(division)} - Standings</h2>
                <p style="margin-bottom: 2rem; text-align: center; opacity: 0.8;">
                    <strong>Point System:</strong> 2 points for Win, 1 point for Loss, 0 points for Forfeit
                </p>
                <div class="scrollable-container">
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Pos</th>
                                    <th>Team</th>
                                    <th>P</th>
                                    <th>W</th>
                                    <th>L</th>
                                    <th>F</th>
                                    <th>PF</th>
                                    <th>PA</th>
                                    <th>PD</th>
                                    <th>Pts</th>
                                </tr>
                            </thead>
                            <tbody>
            `;
            standings.forEach((team, index) => {
                html += `
                    <tr onclick="showTeamDetails('${division}', '${team.team}')" style="cursor: pointer;">
                        <td><strong>${index + 1}</strong></td>
                        <td>
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                ${getTeamLogo(division, team.team)}
                                <span>${team.team}</span>
                            </div>
                        </td>
                        <td>${team.played}</td>
                        <td class="status-win">${team.wins}</td>
                        <td class="status-loss">${team.losses}</td>
                        <td class="status-forfeit">${team.forfeits}</td>
                        <td>${team.pointsFor}</td>
                        <td>${team.pointsAgainst}</td>
                        <td class="${team.pointsDiff >= 0 ? 'status-win' : 'status-loss'}">${team.pointsDiff >= 0 ? '+' : ''}${team.pointsDiff}</td>
                        <td style="font-weight: bold; color: var(--accent-color);">${team.points}</td>
                    </tr>
                `;
            });
            html += `
                            </tbody>
                        </table>
                    </div>
                </div>
                <p style="margin-top: 1rem; font-size: 0.9rem; opacity: 0.7;">
                    <em>P=Played, W=Won, L=Lost, F=Forfeited, PF=Points For, PA=Points Against, PD=Point Difference, Pts=League Points</em>
                </p>
            `;
            document.getElementById('modal-title').innerHTML = `<i class="fas fa-chart-line"></i> Standings`;
            document.getElementById('modal-body').innerHTML = html;
            document.getElementById('modal').style.display = 'block';
        }
        async function showTeamDetails(division, teamName) {
            const resultsSnapshot = await db.collection("fixtures")
                .where("played", "==", true)
                .where("division", "==", division)
                .get();
            const teamResults = resultsSnapshot.docs
                .filter(doc => {
                    const result = doc.data();
                    return result.homeTeam === teamName || result.awayTeam === teamName;
                })
                .map(doc => doc.data());
            let wins = 0, losses = 0, forfeits = 0, totalPointsScored = 0, totalPointsConceded = 0;
            teamResults.forEach(result => {
                const isHome = result.homeTeam === teamName;
                const teamScore = isHome ? result.homeScore : result.awayScore;
                const opponentScore = isHome ? result.awayScore : result.homeScore;
                totalPointsScored += teamScore;
                totalPointsConceded += opponentScore;
                if (result.forfeit) {
                    if ((isHome && result.forfeitTeam === 'home') || (!isHome && result.forfeitTeam === 'away')) {
                        forfeits++;
                    } else {
                        wins++;
                    }
                } else {
                    if (teamScore > opponentScore) {
                        wins++;
                    } else {
                        losses++;
                    }
                }
            });
            const totalLeaguePoints = (wins * 2) + (losses * 1) + (forfeits * 0);
            const avgPointsScored = teamResults.length > 0 ? (totalPointsScored / teamResults.length).toFixed(1) : 0;
            const avgPointsConceded = teamResults.length > 0 ? (totalPointsConceded / teamResults.length).toFixed(1) : 0;
            const winRate = teamResults.length > 0 ? ((wins/teamResults.length) * 100).toFixed(1) : 0;
            const logoSrc = appData.settings.teamLogos[`${division}-${teamName}`];
            const teamLogo = logoSrc ? 
                `<div class="team-logo" style="margin: 0 auto 0.5rem; width: 50px; height: 50px;"><img src="${logoSrc}" alt="${teamName}"></div>` :
                `<div class="team-logo" style="margin: 0 auto 0.5rem; width: 50px; height: 50px;">${teamName.charAt(0)}</div>`;
            let html = `
                <div style="text-align: center; margin-bottom: 1rem;">
                    ${teamLogo}
                    <h2 style="font-size: 1.3rem; margin-bottom: 0.3rem;">${teamName}</h2>
                    <p style="opacity: 0.8; font-size: 0.8rem; margin-bottom: 1rem;"><strong>Division:</strong> ${getDivisionName(division)}</p>
                </div>
                <div class="table-container">
                    <h3 style="margin-bottom: 0.8rem; font-size: 1.1rem;"><i class="fas fa-chart-line"></i> Season Statistics</h3>
                    <table class="table" style="font-size: 0.85rem;">
                        <tr><td><strong>Games</strong></td><td>${teamResults.length}</td></tr>
                        <tr><td><strong>Wins</strong></td><td class="status-win">${wins}</td></tr>
                        <tr><td><strong>Losses</strong></td><td class="status-loss">${losses}</td></tr>
                        <tr><td><strong>Forfeits</strong></td><td class="status-forfeit">${forfeits}</td></tr>
                        <tr><td><strong>Points Scored</strong></td><td>${totalPointsScored}</td></tr>
                        <tr><td><strong>Points Against</strong></td><td>${totalPointsConceded}</td></tr>
                        <tr><td><strong>Avg Scored</strong></td><td>${avgPointsScored}</td></tr>
                        <tr><td><strong>Avg Against</strong></td><td>${avgPointsConceded}</td></tr>
                        <tr><td><strong>League Pts</strong></td><td style="font-weight: bold; color: var(--accent-color);">${totalLeaguePoints}</td></tr>
                        <tr><td><strong>Win Rate</strong></td><td>${winRate}%</td></tr>
                    </table>
                </div>
            `;
            // Add Recent Games section (limited to 5 games for compact view)
            if (teamResults.length > 0) {
                html += `
                    <h3 style="margin: 1.5rem 0 0.8rem; font-size: 1.1rem;"><i class="fas fa-history"></i> Recent Results</h3>
                `;
                // Sort by most recent first and limit to 5 games
                const recentResults = [...teamResults].sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 5);
                recentResults.forEach(result => {
                    const isHome = result.homeTeam === teamName;
                    const opponent = isHome ? result.awayTeam : result.homeTeam;
                    const teamScore = isHome ? result.homeScore : result.awayScore;
                    const opponentScore = isHome ? result.awayScore : result.homeScore;
                    let outcome, outcomeClass, resultText;
                    if (result.forfeit) {
                        if ((isHome && result.forfeitTeam === 'home') || (!isHome && result.forfeitTeam === 'away')) {
                            outcome = 'F';
                            outcomeClass = 'status-forfeit';
                            resultText = 'FORFEIT';
                        } else {
                            outcome = 'W';
                            outcomeClass = 'status-win';
                            resultText = 'WIN';
                        }
                    } else {
                        if (teamScore > opponentScore) {
                            outcome = 'W';
                            outcomeClass = 'status-win';
                            resultText = `${teamScore}-${opponentScore}`;
                        } else {
                            outcome = 'L';
                            outcomeClass = 'status-loss';
                            resultText = `${teamScore}-${opponentScore}`;
                        }
                    }
                    html += `
                        <div style="display: flex; justify-content: space-between; align-items: center; font-size: 0.85rem; margin: 0.4rem 0; padding: 0.4rem; background: rgba(255, 255, 255, 0.05); border-radius: 8px;">
                            <span style="flex: 2;">${isHome ? 'vs' : '@'} ${opponent}</span>
                            <span style="flex: 1; text-align: center;"><strong>${resultText}</strong></span>
                            <span class="${outcomeClass}" style="padding: 0.2rem 0.6rem; border-radius: 6px; font-weight: bold; font-size: 0.8rem;">${outcome}</span>
                        </div>
                    `;
                });
            } else {
                html += '<div class="loading"><p>No games played yet.</p></div>';
            }
            document.getElementById('modal-title').innerHTML = `<i class="fas fa-user"></i> ${teamName}`;
            document.getElementById('modal-body').innerHTML = html;
            document.getElementById('modal').style.display = 'block';
        }
        // Player Stats Functions
        function renderPlayerStats() {
            // Populate team filter based on selected division
            const divisionFilter = document.getElementById('players-division-filter');
            const teamFilter = document.getElementById('players-team-filter');
            if (teamFilter) {
                teamFilter.innerHTML = '<option value="all">All Teams</option>';
                if (divisionFilter.value !== 'all') {
                    const teams = appData.teams[divisionFilter.value] || [];
                    teams.forEach(team => {
                        teamFilter.innerHTML += `<option value="${team.name}">${team.name}</option>`;
                    });
                } else {
                    // Add all teams from all divisions
                    Object.keys(appData.teams).forEach(division => {
                        appData.teams[division].forEach(team => {
                            teamFilter.innerHTML += `<option value="${team.name}">${team.name}</option>`;
                        });
                    });
                }
            }
            filterPlayers();
            updatePlayerLeaders();
        }
        function filterPlayers() {
            const selectedDivision = document.getElementById('players-division-filter').value;
            const selectedTeam = document.getElementById('players-team-filter').value;
            const sortBy = document.getElementById('players-sort-filter').value;
            let players = appData.players || [];
            // Filter by division
            if (selectedDivision !== 'all') {
                players = players.filter(p => p.division === selectedDivision);
            }
            // Filter by team
            if (selectedTeam !== 'all') {
                players = players.filter(p => p.team === selectedTeam);
            }
            // Calculate per-game stats and filter out players with 0 games
            players = players
                .filter(p => p.gamesPlayed > 0)
                .map(player => {
                    return {
                        ...player,
                        ppg: (player.totalPoints / player.gamesPlayed).toFixed(1),
                        rpg: (player.totalRebounds / player.gamesPlayed).toFixed(1),
                        apg: (player.totalAssists / player.gamesPlayed).toFixed(1),
                        spg: (player.totalSteals / player.gamesPlayed).toFixed(1),
                        bpg: (player.totalBlocks / player.gamesPlayed).toFixed(1)
                    };
                });
            // Sort players
            players.sort((a, b) => {
                let aValue, bValue;
                switch(sortBy) {
                    case 'points': aValue = parseFloat(a.ppg); bValue = parseFloat(b.ppg); break;
                    case 'rebounds': aValue = parseFloat(a.rpg); bValue = parseFloat(b.rpg); break;
                    case 'assists': aValue = parseFloat(a.apg); bValue = parseFloat(b.apg); break;
                    case 'steals': aValue = parseFloat(a.spg); bValue = parseFloat(b.spg); break;
                    case 'blocks': aValue = parseFloat(a.bpg); bValue = parseFloat(b.bpg); break;
                    default: aValue = parseFloat(a.ppg); bValue = parseFloat(b.ppg);
                }
                return bValue - aValue; // Descending order
            });
            // Render table
            const container = document.getElementById('players-stats-table');
            if (players.length === 0) {
                container.innerHTML = '<tr><td colspan="10" class="text-center">No player statistics available.</td></tr>';
                return;
            }
            let html = '';
            players.forEach((player, index) => {
                html += `
                    <tr onclick="showPlayerDetails('${player.id}')" style="cursor: pointer;">
                        <td><strong>${index + 1}</strong></td>
                        <td>
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                ${player.photo ? 
                                    `<div class="team-logo-small"><img src="${player.photo}" alt="${player.name}"></div>` : 
                                    `<div class="team-logo-small">${player.name.charAt(0)}</div>`}
                                <span>${player.name}</span>
                                ${player.number ? `(#${player.number})` : ''}
                            </div>
                        </td>
                        <td>${player.team}</td>
                        <td>${player.position}</td>
                        <td>${player.gamesPlayed}</td>
                        <td class="status-win">${player.ppg}</td>
                        <td class="status-win">${player.rpg}</td>
                        <td class="status-win">${player.apg}</td>
                        <td class="status-win">${player.spg}</td>
                        <td class="status-win">${player.bpg}</td>
                    </tr>
                `;
            });
            container.innerHTML = html;
        }
        function updatePlayerLeaders() {
            if (!appData.players || appData.players.length === 0) return;
            const playersWithGames = appData.players.filter(p => p.gamesPlayed > 0);
            if (playersWithGames.length === 0) return;
            // Points leader
            const pointsLeader = [...playersWithGames].sort((a, b) => 
                (b.totalPoints / b.gamesPlayed) - (a.totalPoints / a.gamesPlayed)
            )[0];
            if (pointsLeader) {
                document.getElementById('points-leader-name').textContent = pointsLeader.name;
                document.getElementById('points-leader-stats').textContent = 
                    `${(pointsLeader.totalPoints / pointsLeader.gamesPlayed).toFixed(1)} PPG (${pointsLeader.totalPoints} total)`;
                if (pointsLeader.photo) {
                    document.querySelector('#points-leader .team-logo').innerHTML = 
                        `<img src="${pointsLeader.photo}" alt="${pointsLeader.name}">`;
                }
            }
            // Rebounds leader
            const reboundsLeader = [...playersWithGames].sort((a, b) => 
                (b.totalRebounds / b.gamesPlayed) - (a.totalRebounds / a.gamesPlayed)
            )[0];
            if (reboundsLeader) {
                document.getElementById('rebounds-leader-name').textContent = reboundsLeader.name;
                document.getElementById('rebounds-leader-stats').textContent = 
                    `${(reboundsLeader.totalRebounds / reboundsLeader.gamesPlayed).toFixed(1)} RPG (${reboundsLeader.totalRebounds} total)`;
                if (reboundsLeader.photo) {
                    document.querySelector('#rebounds-leader .team-logo').innerHTML = 
                        `<img src="${reboundsLeader.photo}" alt="${reboundsLeader.name}">`;
                }
            }
            // Assists leader
            const assistsLeader = [...playersWithGames].sort((a, b) => 
                (b.totalAssists / b.gamesPlayed) - (a.totalAssists / a.gamesPlayed)
            )[0];
            if (assistsLeader) {
                document.getElementById('assists-leader-name').textContent = assistsLeader.name;
                document.getElementById('assists-leader-stats').textContent = 
                    `${(assistsLeader.totalAssists / assistsLeader.gamesPlayed).toFixed(1)} APG (${assistsLeader.totalAssists} total)`;
                if (assistsLeader.photo) {
                    document.querySelector('#assists-leader .team-logo').innerHTML = 
                        `<img src="${assistsLeader.photo}" alt="${assistsLeader.name}">`;
                }
            }
        }
        async function showPlayerDetails(playerId) {
            const player = appData.players.find(p => p.id === playerId);
            if (!player) return;
            // Get player's game-by-game stats
            const statsSnapshot = await db.collection("playerStats")
                .where("playerId", "==", playerId)
                .orderBy("timestamp", "desc")
                .limit(10)
                .get();
            const recentGames = statsSnapshot.docs.map(doc => doc.data());
            let html = `
                <div style="text-align: center; margin-bottom: 2rem;">
                    ${player.photo ? 
                        `<div class="team-logo" style="margin: 0 auto 1rem;"><img src="${player.photo}" alt="${player.name}"></div>` : 
                        `<div class="team-logo" style="margin: 0 auto 1rem;">${player.name.charAt(0)}</div>`}
                    <h2>${player.name}</h2>
                    <p><strong>Team:</strong> ${player.team} ${player.number ? `(#${player.number})` : ''}</p>
                    <p><strong>Position:</strong> ${player.position}</p>
                    <p><strong>Games Played:</strong> ${player.gamesPlayed}</p>
                </div>
                <div class="grid grid-5 mb-2">
                    <div class="card text-center">
                        <div class="card-title">
                            <i class="fas fa-fire"></i>
                            Points
                        </div>
                        <div class="card-content">
                            <div style="font-size: 2rem; font-weight: bold; color: var(--accent-color);">
                                ${(player.totalPoints / player.gamesPlayed).toFixed(1)}
                            </div>
                            <div style="font-size: 0.9rem;">PPG</div>
                            <div style="margin-top: 0.5rem;">${player.totalPoints} Total</div>
                        </div>
                    </div>
                    <div class="card text-center">
                        <div class="card-title">
                            <i class="fas fa-hand-paper"></i>
                            Rebounds
                        </div>
                        <div class="card-content">
                            <div style="font-size: 2rem; font-weight: bold; color: var(--accent-color);">
                                ${(player.totalRebounds / player.gamesPlayed).toFixed(1)}
                            </div>
                            <div style="font-size: 0.9rem;">RPG</div>
                            <div style="margin-top: 0.5rem;">${player.totalRebounds} Total</div>
                        </div>
                    </div>
                    <div class="card text-center">
                        <div class="card-title">
                            <i class="fas fa-handshake"></i>
                            Assists
                        </div>
                        <div class="card-content">
                            <div style="font-size: 2rem; font-weight: bold; color: var(--accent-color);">
                                ${(player.totalAssists / player.gamesPlayed).toFixed(1)}
                            </div>
                            <div style="font-size: 0.9rem;">APG</div>
                            <div style="margin-top: 0.5rem;">${player.totalAssists} Total</div>
                        </div>
                    </div>
                    <div class="card text-center">
                        <div class="card-title">
                            <i class="fas fa-user-secret"></i>
                            Steals
                        </div>
                        <div class="card-content">
                            <div style="font-size: 2rem; font-weight: bold; color: var(--accent-color);">
                                ${(player.totalSteals / player.gamesPlayed).toFixed(1)}
                            </div>
                            <div style="font-size: 0.9rem;">SPG</div>
                            <div style="margin-top: 0.5rem;">${player.totalSteals} Total</div>
                        </div>
                    </div>
                    <div class="card text-center">
                        <div class="card-title">
                            <i class="fas fa-shield-alt"></i>
                            Blocks
                        </div>
                        <div class="card-content">
                            <div style="font-size: 2rem; font-weight: bold; color: var(--accent-color);">
                                ${(player.totalBlocks / player.gamesPlayed).toFixed(1)}
                            </div>
                            <div style="font-size: 0.9rem;">BPG</div>
                            <div style="margin-top: 0.5rem;">${player.totalBlocks} Total</div>
                        </div>
                    </div>
                </div>
                <h3 style="margin: 2rem 0 1rem;"><i class="fas fa-history"></i> Recent Games</h3>
            `;
            if (recentGames.length === 0) {
                html += '<p style="text-align: center; opacity: 0.7;">No game stats recorded yet.</p>';
            } else {
                html += `
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Opponent</th>
                                    <th>PTS</th>
                                    <th>REB</th>
                                    <th>AST</th>
                                    <th>STL</th>
                                    <th>BLK</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                recentGames.forEach(game => {
                    html += `
                        <tr>
                            <td>${game.date}</td>
                            <td>${game.opponent}</td>
                            <td class="status-win">${game.points}</td>
                            <td class="status-win">${game.rebounds}</td>
                            <td class="status-win">${game.assists}</td>
                            <td class="status-win">${game.steals}</td>
                            <td class="status-win">${game.blocks}</td>
                        </tr>
                    `;
                });
                html += `
                            </tbody>
                        </table>
                    </div>
                `;
            }
            document.getElementById('modal-title').innerHTML = `<i class="fas fa-user"></i> ${player.name}`;
            document.getElementById('modal-body').innerHTML = html;
            document.getElementById('modal').style.display = 'block';
        }
        // Home Page Functions
        function loadHomeData() {
            updateQuickStats();
            renderHomeNewsPreview();
        }
        function updateQuickStats() {
            let totalTeams = 0;
            Object.keys(appData.teams).forEach(division => {
                totalTeams += appData.teams[division].length;
            });
            const totalGames = appData.results.length;
            const totalFixtures = appData.fixtures.length;
            document.getElementById('total-teams').textContent = totalTeams;
            document.getElementById('total-games').textContent = totalGames;
            document.getElementById('total-fixtures').textContent = totalFixtures;
        }
        // Admin Functions
        function adminAccess() {
            adminClickCount++;
            document.getElementById('click-counter').textContent = `Clicks: ${adminClickCount}/5`;
            document.getElementById('admin-access').style.display = 'block';
            if (adminClickCount >= 5) {
                document.body.classList.add('admin-mode');
                document.getElementById('admin-access').style.display = 'none';
                alert('Admin mode activated!');
                adminClickCount = 0;
            }
            setTimeout(() => {
                document.getElementById('admin-access').style.display = 'none';
            }, 2000);
        }
        function toggleAdmin() {
            const panel = document.getElementById('admin-panel');
            panel.classList.toggle('show');
        }
        function showAdminTab(tabName) {
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            document.querySelectorAll('.admin-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`admin-${tabName}`).classList.add('active');
            if (tabName === 'fixtures') {
                updateFixtureTeams();
                renderAdminFixtures();
            } else if (tabName === 'matches') {
                updateMatchTeams();
            } else if (tabName === 'news') {
                renderAdminNews();
            } else if (tabName === 'players') {
                updatePlayerTeams();
                renderAdminPlayers();
            } else if (tabName === 'results') {
                setTimeout(() => {
                    renderAdminResults();
                }, 500);
            }
        }
        // Utility Functions
        function getDivisionName(division) {
            const names = {
                'first': 'First Division',
                'second': 'Second Division',
                'female': 'Female Division',
                'third-jj': 'Third Division - JJ Roberts',
                'third-ej': 'Third Division - EJ Roye'
            };
            return names[division] || division;
        }
        function getTeamLogo(division, teamName) {
            const logoKey = `${division}-${teamName}`;
            const logoSrc = appData.settings.teamLogos[logoKey];
            if (logoSrc) {
                return `<div class="team-logo-small"><img src="${logoSrc}" alt="${teamName}" style="width: 25px; height: 25px;"></div>`;
            } else {
                return `<div class="team-logo-small" style="width: 25px; height: 25px; font-size: 0.7rem;">${teamName.charAt(0)}</div>`;
            }
        }
        function closeModal() {
            document.getElementById('modal').style.display = 'none';
        }
        // Notification System
        let notificationCount = 0;
        let notifications = [];
        function showNotification(title, message, type = 'info') {
            const notificationId = Date.now();
            const now = new Date();
            const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            const notification = {
                id: notificationId,
                title,
                message,
                type,
                time: timeString,
                timestamp: now.getTime()
            };
            notifications.push(notification);
            notificationCount++;
            // Update badge
            const badge = document.getElementById('notification-badge');
            badge.textContent = notificationCount;
            badge.classList.remove('hidden');
            // Create notification element
            const notificationElement = document.createElement('div');
            notificationElement.className = `notification ${type}`;
            notificationElement.id = `notification-${notificationId}`;
            notificationElement.innerHTML = `
                <div class="notification-header">
                    <span>${title}</span>
                    <button class="notification-close" onclick="closeNotification(${notificationId})">×</button>
                </div>
                <div class="notification-content">${message}</div>
                <div class="notification-time">${timeString}</div>
            `;
            // Add to container
            const container = document.getElementById('notification-container');
            container.appendChild(notificationElement);
            // Play sound (optional)
            const sound = document.getElementById('notification-sound');
            if (sound) {
                sound.play().catch(e => console.log('Sound play error:', e));
            }
            // Auto-remove after 5 seconds
            setTimeout(() => {
                closeNotification(notificationId);
            }, 5000);
        }
        function closeNotification(notificationId) {
            const notificationElement = document.getElementById(`notification-${notificationId}`);
            if (notificationElement) {
                notificationElement.style.animation = 'slideOutRight 0.3s ease-out';
                notificationElement.addEventListener('animationend', () => {
                    notificationElement.remove();
                });
                // Update notifications array
                notifications = notifications.filter(n => n.id !== notificationId);
                notificationCount = Math.max(0, notificationCount - 1);
                // Update badge
                const badge = document.getElementById('notification-badge');
                if (notificationCount > 0) {
                    badge.textContent = notificationCount;
                } else {
                    badge.classList.add('hidden');
                }
            }
        }
        // Error Handling
        window.addEventListener('error', function(e) {
            console.error('JavaScript Error:', e.error);
        });
    </script>
</body>
</html>
