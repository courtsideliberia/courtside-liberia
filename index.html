<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Courtside Liberia - Promoting Excellence in Liberian Basketball</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    
    <style>
        /* CSS VARIABLES */
        :root {
            --primary-gradient: linear-gradient(135deg, #0f1b3c 0%, #1a237e 100%);
            --secondary-gradient: linear-gradient(45deg, #2196F3, #1976D2);
            --accent-color: #FF6B35;
            --text-light: #ffffff;
            --text-dark: #333333;
            --card-bg: rgba(255, 255, 255, 0.1);
            --card-hover-bg: rgba(255, 255, 255, 0.15);
            --border-radius: 16px;
            --box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            --fiba-blue: #003f7f;
            --fiba-orange: #ff6900;
        }

        /* RESET AND BASE STYLES */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--primary-gradient);
            color: var(--text-light);
            line-height: 1.6;
        }

        /* HEADER STYLES */
        .header {
            background: rgba(15, 27, 60, 0.95);
            backdrop-filter: blur(20px);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            padding: 1rem 0;
            box-shadow: var(--box-shadow);
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo {
            width: 50px;
            height: 50px;
            background: var(--secondary-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            transition: transform 0.3s ease;
            overflow: hidden;
        }

        .logo:hover {
            transform: scale(1.1);
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .site-title {
            font-size: 1.5rem;
            font-weight: bold;
            background: linear-gradient(45deg, #ffffff, #64B5F6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 2rem;
            align-items: center;
        }

        .nav-item a {
            color: var(--text-light);
            text-decoration: none;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 500;
        }

        .nav-item a:hover,
        .nav-item a.active {
            background: var(--card-bg);
            transform: translateY(-2px);
        }

        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .admin-btn {
            background: var(--secondary-gradient);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            display: none;
        }

        body.admin-mode .admin-btn {
            display: block;
        }

        /* HERO SECTION */
        .hero {
            margin-top: 80px;
            background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.5)), 
                        url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 600'%3E%3Crect fill='%23001122' width='1200' height='600'/%3E%3Ccircle cx='600' cy='300' r='80' fill='none' stroke='%23ffffff' stroke-width='2' opacity='0.1'/%3E%3Ccircle cx='600' cy='300' r='120' fill='none' stroke='%23FF6B35' stroke-width='3' opacity='0.3'/%3E%3Cpath d='M300,50 L300,550 M900,50 L900,550 M200,150 L1000,150 M200,450 L1000,450' stroke='%23ffffff' stroke-width='1' opacity='0.1'/%3E%3C/svg%3E");
            background-size: cover;
            background-position: center;
            text-align: center;
            padding: 4rem 0 6rem;
        }

        .hero-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .hero h1 {
            font-size: clamp(2.5rem, 6vw, 4rem);
            margin-bottom: 1rem;
            background: linear-gradient(45deg, #ffffff, #FF6B35, #2196F3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
        }

        .hero-subtitle {
            font-size: clamp(1.2rem, 3vw, 1.5rem);
            margin-bottom: 2rem;
            opacity: 0.9;
        }

        /* MAIN CONTENT */
        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .section {
            padding: 3rem 0;
            display: none;
        }

        .section.active {
            display: block;
        }

        .section-title {
            font-size: 2.5rem;
            text-align: center;
            margin-bottom: 3rem;
            position: relative;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: var(--accent-color);
            border-radius: 2px;
        }

        /* GRID LAYOUTS */
        .grid {
            display: grid;
            gap: 2rem;
        }

        .grid-2 { grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); }
        .grid-3 { grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); }
        .grid-4 { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); }

        /* CARD COMPONENTS */
        .card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .card:hover {
            background: var(--card-hover-bg);
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
        }

        .card-title {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .card-content {
            opacity: 0.9;
            line-height: 1.6;
        }

        /* NEWS COMPONENTS */
        .news-card {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .news-image {
            width: 100%;
            height: 200px;
            background: var(--card-hover-bg);
            border-radius: var(--border-radius);
            margin-bottom: 1rem;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .news-meta {
            font-size: 0.9rem;
            opacity: 0.7;
            margin-bottom: 0.5rem;
        }

        .news-excerpt {
            flex-grow: 1;
            margin-bottom: 1rem;
        }

        /* COMMENTS SYSTEM */
        .comments-section {
            background: rgba(0, 0, 0, 0.3);
            border-radius: var(--border-radius);
            padding: 2rem;
            margin-top: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .comment-form {
            margin-bottom: 2rem;
        }

        .comment-input {
            width: 100%;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius);
            color: white;
            resize: vertical;
            min-height: 100px;
        }

        .comment-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .comment-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
            border-left: 4px solid var(--accent-color);
        }

        .comment-author {
            font-weight: bold;
            color: var(--accent-color);
            margin-bottom: 0.5rem;
        }

        .comment-date {
            font-size: 0.8rem;
            opacity: 0.7;
            float: right;
        }

        /* PLAYER STATS COMPONENTS */
        .player-stats-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .player-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .player-name {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--accent-color);
        }

        .player-number {
            background: var(--fiba-blue);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-weight: bold;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .stat-item {
            text-align: center;
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }

        .stat-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--accent-color);
        }

        .stat-label {
            font-size: 0.7rem;
            opacity: 0.8;
            text-transform: uppercase;
        }

        /* MOBILE COMPONENTS */
        .mobile-standings {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            margin-bottom: 1rem;
            overflow: hidden;
        }

        .mobile-standings-header {
            background: var(--fiba-blue);
            color: white;
            padding: 1rem;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .mobile-team-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.02);
            cursor: pointer;
        }

        .mobile-team-row:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .mobile-team-row:last-child {
            border-bottom: none;
        }

        .mobile-team-info {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            flex: 1;
        }

        .mobile-team-position {
            background: var(--fiba-orange);
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.8rem;
        }

        .mobile-team-name {
            font-weight: 500;
            flex: 1;
        }

        .mobile-team-stats {
            display: flex;
            gap: 1rem;
            font-size: 0.9rem;
        }

        .mobile-stat {
            text-align: center;
        }

        .mobile-stat-value {
            font-weight: bold;
            color: var(--accent-color);
        }

        .mobile-stat-label {
            font-size: 0.7rem;
            opacity: 0.7;
            text-transform: uppercase;
        }

        .mobile-match-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            margin-bottom: 1rem;
            overflow: hidden;
        }

        .mobile-match-header {
            background: var(--fiba-blue);
            color: white;
            padding: 0.8rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
        }

        .mobile-match-body {
            padding: 1.5rem 1rem;
        }

        .mobile-teams-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .mobile-team {
            text-align: center;
            flex: 1;
        }

        .mobile-team-logo {
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 50%;
            margin: 0 auto 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--text-dark);
            overflow: hidden;
        }

        .mobile-score {
            font-size: 2rem;
            font-weight: bold;
            color: var(--accent-color);
            padding: 0 1rem;
        }

        .mobile-match-info {
            text-align: center;
            padding-top: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .mobile-player-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            margin-bottom: 1rem;
            overflow: hidden;
        }

        .mobile-player-header {
            background: linear-gradient(45deg, var(--fiba-blue), var(--fiba-orange));
            color: white;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .mobile-player-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .mobile-player-number {
            background: rgba(255, 255, 255, 0.2);
            padding: 0.5rem;
            border-radius: 8px;
            font-weight: bold;
            min-width: 40px;
            text-align: center;
        }

        .mobile-stats-row {
            display: flex;
            justify-content: space-around;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.03);
        }

        .mobile-quick-stat {
            text-align: center;
        }

        .mobile-quick-stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent-color);
        }

        .mobile-quick-stat-label {
            font-size: 0.7rem;
            opacity: 0.8;
            text-transform: uppercase;
        }

        /* PLAYOFF BRACKET */
        .playoff-bracket {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 2rem;
            margin: 2rem 0;
            overflow-x: auto;
        }

        .bracket-round {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            min-width: 200px;
            margin-right: 2rem;
        }

        .bracket-match {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 1rem;
            border: 2px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }

        .bracket-team {
            padding: 0.5rem;
            margin: 0.2rem 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .bracket-team.winner {
            background: rgba(76, 175, 80, 0.2);
            border-left: 4px solid #4CAF50;
        }

        /* FORM COMPONENTS */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 1rem;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--accent-color);
        }

        .form-textarea {
            resize: vertical;
            min-height: 120px;
        }

        .filter-section {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* BUTTONS */
        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            margin: 0.5rem;
            font-size: 1rem;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--secondary-gradient);
            color: white;
        }

        .btn-success {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(45deg, #f44336, #d32f2f);
            color: white;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        /* MODALS */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            backdrop-filter: blur(10px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--primary-gradient);
            padding: 2rem;
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 2rem;
            color: white;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .modal-close:hover {
            color: var(--accent-color);
        }

        /* ADMIN PANEL */
        .admin-panel {
            background: rgba(0, 0, 0, 0.9);
            border-radius: var(--border-radius);
            padding: 2rem;
            margin: 2rem 0;
            border: 2px solid rgba(255, 255, 255, 0.2);
            display: none;
        }

        .admin-panel.show {
            display: block;
        }

        .admin-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .admin-tab {
            padding: 1rem 1.5rem;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .admin-tab.active {
            background: var(--secondary-gradient);
            border-color: #2196F3;
        }

        .admin-content {
            display: none;
        }

        .admin-content.active {
            display: block;
        }

        /* TABLE STYLES */
        .table-container {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            overflow: hidden;
            margin: 2rem 0;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th,
        .table td {
            padding: 1rem 0.8rem;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .table th {
            background: white;
            color: var(--text-dark);
            font-weight: bold;
        }

        .table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        /* STATUS INDICATORS */
        .status-win { color: #4CAF50; }
        .status-loss { color: #f44336; }
        .status-forfeit { color: #FF9800; }

        /* UTILITY CLASSES */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .hidden { display: none !important; }
        .mb-1 { margin-bottom: 1rem; }
        .mb-2 { margin-bottom: 2rem; }
        .mt-1 { margin-top: 1rem; }
        .mt-2 { margin-top: 2rem; }

        .loading {
            text-align: center;
            padding: 2rem;
            opacity: 0.7;
        }

        .spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--accent-color);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* RESPONSIVE DESIGN */
        @media (max-width: 768px) {
            .mobile-optimized {
                display: block;
            }

            .desktop-only {
                display: none;
            }

            .nav-menu {
                position: fixed;
                top: 80px;
                left: -100%;
                width: 100%;
                height: calc(100vh - 80px);
                background: rgba(15, 27, 60, 0.98);
                flex-direction: column;
                padding: 2rem;
                transition: left 0.3s ease;
            }

            .nav-menu.show {
                left: 0;
            }

            .mobile-menu-toggle {
                display: block;
            }

            .hero {
                padding: 2rem 0 4rem;
            }

            .section {
                padding: 2rem 0;
            }

            .main-content {
                padding: 0 1rem;
            }

            .admin-tabs {
                flex-direction: column;
            }

            .grid {
                gap: 1rem;
            }

            .table-container {
                display: none;
            }

            .mobile-table-replacement {
                display: block;
            }
        }

        @media (min-width: 769px) {
            .mobile-optimized {
                display: none;
            }

            .mobile-table-replacement {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- HEADER -->
    <header class="header">
        <div class="nav-container">
            <div class="logo-section">
                <div class="logo" id="main-logo" ondblclick="adminAccess()">
                    CL
                </div>
                <h2 class="site-title">Courtside Liberia</h2>
            </div>
            <nav>
                <ul class="nav-menu" id="nav-menu">
                    <li class="nav-item"><a href="#" class="nav-link active" data-section="home"><i class="fas fa-home"></i> Home</a></li>
                    <li class="nav-item"><a href="#" class="nav-link" data-section="news"><i class="fas fa-newspaper"></i> News</a></li>
                    <li class="nav-item"><a href="#" class="nav-link" data-section="divisions"><i class="fas fa-trophy"></i> Divisions</a></li>
                    <li class="nav-item"><a href="#" class="nav-link" data-section="fixtures"><i class="fas fa-calendar-alt"></i> Fixtures</a></li>
                    <li class="nav-item"><a href="#" class="nav-link" data-section="results"><i class="fas fa-clipboard-check"></i> Results</a></li>
                    <li class="nav-item"><a href="#" class="nav-link" data-section="players"><i class="fas fa-user"></i> Players</a></li>
                    <li class="nav-item"><a href="#" class="nav-link" data-section="playoffs"><i class="fas fa-trophy"></i> Playoffs</a></li>
                </ul>
            </nav>
            <button class="mobile-menu-toggle" id="mobile-menu-toggle">
                <i class="fas fa-bars"></i>
            </button>
            <button class="admin-btn" onclick="toggleAdmin()">
                <i class="fas fa-cog"></i> Admin Panel
            </button>
        </div>
    </header>

    <!-- HERO SECTION -->
    <section class="hero">
        <div class="hero-content">
            <h1>Courtside Liberia</h1>
            <p class="hero-subtitle">Promoting Excellence in Liberian Basketball Association</p>
            <p>Dedicated to developing talent and bringing professional basketball to communities across Liberia</p>
        </div>
    </section>

    <!-- MAIN CONTENT -->
    <main class="main-content">
        <!-- HOME SECTION -->
        <section id="home" class="section active">
            <div class="section-title">Welcome to Courtside Liberia! We Live For The Culture! 231</div>
            <div class="grid grid-3">
                <div class="card" onclick="NavigationManager.showSection('news')">
                    <div class="card-title">
                        <i class="fas fa-newspaper"></i>
                        Latest News
                    </div>
                    <div class="card-content">
                        Stay updated with the latest basketball news, player transfers, and league announcements
                    </div>
                </div>
                <div class="card" onclick="NavigationManager.showSection('divisions')">
                    <div class="card-title">
                        <i class="fas fa-trophy"></i>
                        League Divisions
                    </div>
                    <div class="card-content">
                        Explore all divisions from First Division to Development leagues across Liberia
                    </div>
                </div>
                <div class="card" onclick="NavigationManager.showSection('players')">
                    <div class="card-title">
                        <i class="fas fa-user"></i>
                        Player Statistics
                    </div>
                    <div class="card-content">
                        View detailed player statistics, performances, and career records
                    </div>
                </div>
            </div>
            
            <!-- Latest News Preview -->
            <div id="home-news-preview">
                <h3 style="margin: 3rem 0 2rem; text-align: center;">Latest News</h3>
                <div id="home-news-grid" class="grid grid-3"></div>
            </div>

            <!-- Quick Stats -->
            <div style="margin-top: 3rem;">
                <h3 style="text-align: center; margin-bottom: 2rem;">League Statistics</h3>
                <div class="grid grid-4" id="quick-stats">
                    <div class="card text-center">
                        <div class="card-title">
                            <i class="fas fa-users"></i>
                            Total Teams
                        </div>
                        <div class="card-content">
                            <span id="total-teams" style="font-size: 2rem; font-weight: bold; color: var(--accent-color);">0</span>
                        </div>
                    </div>
                    <div class="card text-center">
                        <div class="card-title">
                            <i class="fas fa-gamepad"></i>
                            Games Played
                        </div>
                        <div class="card-content">
                            <span id="total-games" style="font-size: 2rem; font-weight: bold; color: var(--accent-color);">0</span>
                        </div>
                    </div>
                    <div class="card text-center">
                        <div class="card-title">
                            <i class="fas fa-calendar"></i>
                            Upcoming Matches
                        </div>
                        <div class="card-content">
                            <span id="total-fixtures" style="font-size: 2rem; font-weight: bold; color: var(--accent-color);">0</span>
                        </div>
                    </div>
                    <div class="card text-center">
                        <div class="card-title">
                            <i class="fas fa-trophy"></i>
                            Active Divisions
                        </div>
                        <div class="card-content">
                            <span id="total-divisions" style="font-size: 2rem; font-weight: bold; color: var(--accent-color);">5</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- NEWS SECTION -->
        <section id="news" class="section">
            <div class="section-title">Latest News</div>
            <div id="news-grid" class="grid grid-3"></div>
        </section>

        <!-- DIVISIONS SECTION -->
        <section id="divisions" class="section">
            <div class="section-title">League Divisions</div>
            <div class="grid grid-3">
                <div class="card" onclick="DivisionManager.showDivisionDetails('first')">
                    <div class="card-title">
                        <i class="fas fa-medal"></i>
                        First Division
                    </div>
                    <div class="card-content">
                        Premier teams competing at the highest level of Liberian basketball (10 teams, 18 games each)
                    </div>
                </div>
                <div class="card" onclick="DivisionManager.showDivisionDetails('second')">
                    <div class="card-title">
                        <i class="fas fa-medal"></i>
                        Second Division
                    </div>
                    <div class="card-content">
                        Rising teams seeking promotion (18 teams, 17 games each - single game format)
                    </div>
                </div>
                <div class="card" onclick="DivisionManager.showDivisionDetails('female')">
                    <div class="card-title">
                        <i class="fas fa-female"></i>
                        Female Division
                    </div>
                    <div class="card-content">
                        Women's professional basketball league (7 teams, 11 games each)
                    </div>
                </div>
                <div class="card" onclick="DivisionManager.showDivisionDetails('third-jj')">
                    <div class="card-title">
                        <i class="fas fa-medal"></i>
                        Third Division - JJ Roberts
                    </div>
                    <div class="card-content">
                        Development league - JJ Roberts Conference for emerging talent
                    </div>
                </div>
                <div class="card" onclick="DivisionManager.showDivisionDetails('third-ej')">
                    <div class="card-title">
                        <i class="fas fa-medal"></i>
                        Third Division - EJ Roye
                    </div>
                    <div class="card-content">
                        Development league - EJ Roye Conference for emerging talent
                    </div>
                </div>
            </div>
        </section>

        <!-- DIVISION DETAILS SECTION -->
        <section id="division-details" class="section">
            <button class="btn btn-success mb-2" onclick="NavigationManager.showSection('divisions')">
                <i class="fas fa-arrow-left"></i> Back to Divisions
            </button>
            <div id="division-title" class="section-title">Division Details</div>
            
            <!-- Desktop Table -->
            <div class="desktop-only">
                <div id="division-teams" class="grid grid-4"></div>
                <button id="standings-btn" class="btn btn-primary mt-2">
                    <i class="fas fa-chart-line"></i> View Standings
                </button>
            </div>

            <!-- Mobile FIBA-style Layout -->
            <div class="mobile-optimized">
                <div id="mobile-division-standings"></div>
            </div>
        </section>

        <!-- FIXTURES SECTION -->
        <section id="fixtures" class="section">
            <div class="section-title">Upcoming Fixtures</div>
            <div class="filter-section">
                <div class="form-group">
                    <label class="form-label">Filter by Division</label>
                    <select id="fixtures-division-filter" class="form-select" onchange="FixtureManager.filterFixtures()">
                        <option value="all">All Divisions</option>
                        <option value="first">First Division</option>
                        <option value="second">Second Division</option>
                        <option value="female">Female Division</option>
                        <option value="third-jj">Third Division - JJ Roberts</option>
                        <option value="third-ej">Third Division - EJ Roye</option>
                    </select>
                </div>
            </div>
            <div id="fixtures-list"></div>
        </section>

        <!-- RESULTS SECTION -->
        <section id="results" class="section">
            <div class="section-title">Match Results</div>
            <div class="filter-section">
                <div class="form-group">
                    <label class="form-label">Filter by Division</label>
                    <select id="results-division-filter" class="form-select" onchange="ResultManager.filterResults()">
                        <option value="all">All Divisions</option>
                        <option value="first">First Division</option>
                        <option value="second">Second Division</option>
                        <option value="female">Female Division</option>
                        <option value="third-jj">Third Division - JJ Roberts</option>
                        <option value="third-ej">Third Division - EJ Roye</option>
                    </select>
                </div>
            </div>
            <div id="results-list"></div>
        </section>

        <!-- PLAYERS SECTION -->
        <section id="players" class="section">
            <div class="section-title">Player Statistics</div>
            <div class="filter-section">
                <div class="form-group">
                    <label class="form-label">Filter by Division</label>
                    <select id="players-division-filter" class="form-select" onchange="PlayerManager.filterPlayers()">
                        <option value="all">All Divisions</option>
                        <option value="first">First Division</option>
                        <option value="second">Second Division</option>
                        <option value="female">Female Division</option>
                        <option value="third-jj">Third Division - JJ Roberts</option>
                        <option value="third-ej">Third Division - EJ Roye</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Filter by Team</label>
                    <select id="players-team-filter" class="form-select" onchange="PlayerManager.filterPlayers()">
                        <option value="all">All Teams</option>
                    </select>
                </div>
            </div>
            
            <!-- Desktop Player Stats -->
            <div class="desktop-only">
                <div id="players-list"></div>
            </div>

            <!-- Mobile Player Stats -->
            <div class="mobile-optimized">
                <div id="mobile-players-list"></div>
            </div>
        </section>

        <!-- PLAYOFFS SECTION -->
        <section id="playoffs" class="section">
            <div class="section-title">Playoff Progression</div>
            <div class="filter-section">
                <div class="form-group">
                    <label class="form-label">Select Division</label>
                    <select id="playoffs-division-filter" class="form-select" onchange="PlayoffManager.showPlayoffBracket()">
                        <option value="first">First Division</option>
                        <option value="second">Second Division</option>
                        <option value="female">Female Division</option>
                        <option value="third-jj">Third Division - JJ Roberts</option>
                        <option value="third-ej">Third Division - EJ Roye</option>
                    </select>
                </div>
            </div>
            <div id="playoff-bracket-container"></div>
        </section>

        <!-- ADMIN PANEL -->
        <div id="admin-panel" class="admin-panel">
            <h2 class="section-title">Admin Panel</h2>
            <div class="admin-tabs">
                <button class="admin-tab active" onclick="AdminManager.showTab('news')">
                    <i class="fas fa-newspaper"></i> Manage News
                </button>
                <button class="admin-tab" onclick="AdminManager.showTab('teams')">
                    <i class="fas fa-users"></i> Manage Teams
                </button>
                <button class="admin-tab" onclick="AdminManager.showTab('fixtures')">
                    <i class="fas fa-calendar-plus"></i> Add Fixtures
                </button>
                <button class="admin-tab" onclick="AdminManager.showTab('matches')">
                    <i class="fas fa-trophy"></i> Add Results
                </button>
                <button class="admin-tab" onclick="AdminManager.showTab('stats')">
                    <i class="fas fa-chart-bar"></i> Player Stats
                </button>
                <button class="admin-tab" onclick="AdminManager.showTab('results')">
                    <i class="fas fa-clipboard-list"></i> Manage Results
                </button>
            </div>

            <!-- Admin Content Sections -->
            <div id="admin-news" class="admin-content active">
                <h3><i class="fas fa-newspaper"></i> News Management</h3>
                <div class="grid grid-2 mb-2">
                    <div class="card">
                        <h4>Add New Article</h4>
                        <form id="news-form">
                            <div class="form-group">
                                <label class="form-label">Article Title</label>
                                <input type="text" id="news-title" class="form-input" placeholder="Enter article title">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Article Content</label>
                                <textarea id="news-content" class="form-textarea" placeholder="Enter article content"></textarea>
                            </div>
                            <button type="button" class="btn btn-success" onclick="NewsManager.addNews()">
                                <i class="fas fa-plus"></i> Add Article
                            </button>
                        </form>
                    </div>
                </div>
                <div id="admin-news-list"></div>
            </div>

            <div id="admin-teams" class="admin-content">
                <h3><i class="fas fa-users"></i> Team Management</h3>
                <div class="grid grid-2 mb-2">
                    <div class="card">
                        <h4>Add New Team</h4>
                        <div class="form-group">
                            <label class="form-label">Division</label>
                            <select id="team-division" class="form-select">
                                <option value="first">First Division</option>
                                <option value="second">Second Division</option>
                                <option value="female">Female Division</option>
                                <option value="third-jj">Third Division - JJ Roberts</option>
                                <option value="third-ej">Third Division - EJ Roye</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Team Name</label>
                            <input type="text" id="team-name" class="form-input" placeholder="Enter team name">
                        </div>
                        <button class="btn btn-success" onclick="TeamManager.addTeam()">
                            <i class="fas fa-plus"></i> Add Team
                        </button>
                    </div>
                </div>
                <div id="admin-teams-list"></div>
            </div>

            <div id="admin-fixtures" class="admin-content">
                <h3><i class="fas fa-calendar-plus"></i> Add Fixture</h3>
                <div class="grid grid-2 mb-2">
                    <div class="card">
                        <div class="form-group">
                            <label class="form-label">Division</label>
                            <select id="fixture-division" class="form-select" onchange="FixtureManager.updateFixtureTeams()">
                                <option value="first">First Division</option>
                                <option value="second">Second Division</option>
                                <option value="female">Female Division</option>
                                <option value="third-jj">Third Division - JJ Roberts</option>
                                <option value="third-ej">Third Division - EJ Roye</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Home Team</label>
                            <select id="fixture-home-team" class="form-select"></select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Away Team</label>
                            <select id="fixture-away-team" class="form-select"></select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Match Date</label>
                            <input type="date" id="fixture-date" class="form-input">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Match Time</label>
                            <input type="time" id="fixture-time" class="form-input">
                        </div>
                        <button class="btn btn-success" onclick="FixtureManager.addFixture()">
                            <i class="fas fa-plus"></i> Add Fixture
                        </button>
                    </div>
                </div>
                <div id="admin-fixtures-list"></div>
            </div>

            <div id="admin-matches" class="admin-content">
                <h3><i class="fas fa-trophy"></i> Add Match Result</h3>
                <div class="grid grid-2 mb-2">
                    <div class="card">
                        <div class="form-group">
                            <label class="form-label">Division</label>
                            <select id="match-division" class="form-select" onchange="ResultManager.updateMatchTeams()">
                                <option value="first">First Division</option>
                                <option value="second">Second Division</option>
                                <option value="female">Female Division</option>
                                <option value="third-jj">Third Division - JJ Roberts</option>
                                <option value="third-ej">Third Division - EJ Roye</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Home Team</label>
                            <select id="match-home-team" class="form-select"></select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Away Team</label>
                            <select id="match-away-team" class="form-select"></select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Match Date</label>
                            <input type="date" id="match-date" class="form-input">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Result Type</label>
                            <select id="match-result-type" class="form-select" onchange="ResultManager.toggleMatchInputs()">
                                <option value="normal">Normal Game</option>
                                <option value="forfeit">Forfeit</option>
                            </select>
                        </div>
                        <div id="match-normal-inputs">
                            <div class="form-group">
                                <label class="form-label">Home Score</label>
                                <input type="number" id="match-home-score" class="form-input" min="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Away Score</label>
                                <input type="number" id="match-away-score" class="form-input" min="0">
                            </div>
                        </div>
                        <div id="match-forfeit-inputs" class="hidden">
                            <div class="form-group">
                                <label class="form-label">Team that Forfeited</label>
                                <select id="match-forfeit-team" class="form-select">
                                    <option value="home">Home Team</option>
                                    <option value="away">Away Team</option>
                                </select>
                            </div>
                        </div>
                        <button class="btn btn-success" onclick="ResultManager.addMatchResult()">
                            <i class="fas fa-plus"></i> Add Result
                        </button>
                    </div>
                </div>
            </div>

            <div id="admin-stats" class="admin-content">
                <h3><i class="fas fa-chart-bar"></i> Player Statistics Management</h3>
                <div class="grid grid-2 mb-2">
                    <div class="card">
                        <h4>Add Player Stats</h4>
                        <div class="form-group">
                            <label class="form-label">Player Name</label>
                            <input type="text" id="player-name" class="form-input" placeholder="Enter player name">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Player Number</label>
                            <input type="number" id="player-number" class="form-input" placeholder="Jersey number">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Division</label>
                            <select id="player-division" class="form-select" onchange="PlayerManager.updatePlayerTeams()">
                                <option value="first">First Division</option>
                                <option value="second">Second Division</option>
                                <option value="female">Female Division</option>
                                <option value="third-jj">Third Division - JJ Roberts</option>
                                <option value="third-ej">Third Division - EJ Roye</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Team</label>
                            <select id="player-team" class="form-select">
                                <option value="">Select Team</option>
                            </select>
                        </div>
                        
                        <h5>Game Statistics</h5>
                        <div class="grid grid-3">
                            <div class="form-group">
                                <label class="form-label">Points</label>
                                <input type="number" id="player-points" class="form-input" min="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">2PM</label>
                                <input type="number" id="player-2pm" class="form-input" min="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">2PA</label>
                                <input type="number" id="player-2pa" class="form-input" min="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">3PM</label>
                                <input type="number" id="player-3pm" class="form-input" min="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">3PA</label>
                                <input type="number" id="player-3pa" class="form-input" min="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">FTM</label>
                                <input type="number" id="player-ftm" class="form-input" min="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">FTA</label>
                                <input type="number" id="player-fta" class="form-input" min="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Off Rebounds</label>
                                <input type="number" id="player-oreb" class="form-input" min="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Def Rebounds</label>
                                <input type="number" id="player-dreb" class="form-input" min="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Assists</label>
                                <input type="number" id="player-assists" class="form-input" min="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Turnovers</label>
                                <input type="number" id="player-turnovers" class="form-input" min="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Steals</label>
                                <input type="number" id="player-steals" class="form-input" min="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Fouls</label>
                                <input type="number" id="player-fouls" class="form-input" min="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Blocks</label>
                                <input type="number" id="player-blocks" class="form-input" min="0">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Match Date</label>
                            <input type="date" id="stats-match-date" class="form-input">
                        </div>
                        
                        <button class="btn btn-success" onclick="PlayerManager.addPlayerStats()">
                            <i class="fas fa-plus"></i> Add Player Stats
                        </button>
                    </div>
                </div>
                <div id="admin-stats-list"></div>
            </div>

            <div id="admin-results" class="admin-content">
                <h3><i class="fas fa-clipboard-list"></i> Results Management</h3>
                <div class="filter-section">
                    <div class="form-group">
                        <label class="form-label">Filter by Division</label>
                        <select id="admin-results-division-filter" class="form-select" onchange="AdminManager.renderResults()">
                            <option value="all">All Divisions</option>
                            <option value="first">First Division</option>
                            <option value="second">Second Division</option>
                            <option value="female">Female Division</option>
                            <option value="third-jj">Third Division - JJ Roberts</option>
                            <option value="third-ej">Third Division - EJ Roye</option>
                        </select>
                    </div>
                </div>
                <div id="admin-results-list"></div>
            </div>
        </div>
    </main>

    <!-- MODALS -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">Details</h2>
                <button class="modal-close" onclick="ModalManager.closeModal()">&times;</button>
            </div>
            <div id="modal-body"></div>
        </div>
    </div>

    <div id="news-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="news-modal-title">News Article</h2>
                <button class="modal-close" onclick="ModalManager.closeNewsModal()">&times;</button>
            </div>
            <div id="news-modal-body"></div>
            <div id="news-comments-section" class="comments-section">
                <h3><i class="fas fa-comments"></i> Comments</h3>
                <div class="comment-form">
                    <div class="form-group">
                        <input type="text" id="comment-author" class="form-input" placeholder="Your name" style="margin-bottom: 1rem;">
                        <textarea id="comment-text" class="comment-input" placeholder="Write your comment here..."></textarea>
                    </div>
                    <button class="btn btn-primary" onclick="CommentManager.addComment()">
                        <i class="fas fa-paper-plane"></i> Post Comment
                    </button>
                </div>
                <div id="comments-list"></div>
            </div>
        </div>
    </div>

    <!-- JAVASCRIPT -->
    <script>
        // ========================================
        // FIREBASE CONFIGURATION
        // ========================================
        const firebaseConfig = {
            apiKey: "AIzaSyAlwLvdfEVwDatmIcmdjdAu-0t0ALY6XIc",
            authDomain: "courtside-liberia-52aa8.firebaseapp.com",
            databaseURL: "https://courtside-liberia-52aa8-default-rtdb.firebaseio.com",
            projectId: "courtside-liberia-52aa8",
            storageBucket: "courtside-liberia-52aa8.firebasestorage.app",
            messagingSenderId: "154829379760",
            appId: "1:154829379760:web:000df31f9245329d990375",
            measurementId: "G-QPJHY0QLE8"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // ========================================
        // DATA STORE
        // ========================================
        const AppData = {
            teams: {
                first: [],
                second: [],
                female: [],
                'third-jj': [],
                'third-ej': []
            },
            fixtures: [],
            results: [],
            news: [],
            players: [],
            comments: {},
            settings: {
                teamLogos: {}
            }
        };

        // ========================================
        // LEAGUE CONFIGURATION
        // ========================================
        const LeagueConfig = {
            first: {
                teams: 10,
                gamesPerTeam: 18,
                playoffTeams: 6,
                finalTeams: 2,
                rounds: ['Round Robin', 'Big Four', 'Finals']
            },
            second: {
                teams: 18,
                gamesPerTeam: 17,
                playoffTeams: 10,
                subDivisions: 2,
                teamsPerSubDivision: 5,
                superSixTeams: 3
            },
            female: {
                teams: 7,
                gamesPerTeam: 11,
                playoffTeams: 4,
                finalTeams: 2,
                rounds: ['Round Robin', 'Finals']
            },
            'third-jj': {
                teams: 5,
                playoffTeams: 3
            },
            'third-ej': {
                teams: 5,
                playoffTeams: 3
            }
        };

        // ========================================
        // UTILITY FUNCTIONS
        // ========================================
        const Utils = {
            getDivisionName: (division) => {
                const names = {
                    'first': 'First Division',
                    'second': 'Second Division',
                    'female': 'Female Division',
                    'third-jj': 'Third Division - JJ Roberts',
                    'third-ej': 'Third Division - EJ Roye'
                };
                return names[division] || division;
            },

            formatDate: (timestamp) => {
                if (!timestamp) return 'Unknown date';
                const date = timestamp.seconds ? new Date(timestamp.seconds * 1000) : new Date(timestamp);
                return date.toLocaleDateString();
            },

            calculatePercentage: (made, attempted) => {
                return attempted > 0 ? ((made / attempted) * 100).toFixed(1) : '0.0';
            },

            calculateAverage: (total, games) => {
                return games > 0 ? (total / games).toFixed(1) : '0.0';
            }
        };

        // ========================================
        // DATA LOADER
        // ========================================
        const DataLoader = {
            init: () => {
                DataLoader.loadTeams();
                DataLoader.loadFixtures();
                DataLoader.loadResults();
                DataLoader.loadNews();
                DataLoader.loadPlayers();
                DataLoader.loadComments();
            },

            loadTeams: () => {
                db.collection("teams").onSnapshot((snapshot) => {
                    Object.keys(AppData.teams).forEach(division => {
                        AppData.teams[division] = [];
                    });

                    snapshot.forEach((doc) => {
                        const team = { id: doc.id, ...doc.data() };
                        if (AppData.teams[team.division]) {
                            AppData.teams[team.division].push(team);
                        }
                    });

                    AdminManager.renderTeams();
                    FixtureManager.updateAllTeamSelects();
                    StatsManager.updateQuickStats();
                    PlayerManager.updatePlayerTeams();
                });
            },

            loadFixtures: () => {
                db.collection("fixtures").where("played", "==", false).onSnapshot((snapshot) => {
                    AppData.fixtures = [];
                    snapshot.forEach((doc) => {
                        AppData.fixtures.push({ id: doc.id, ...doc.data() });
                    });
                    FixtureManager.render();
                    AdminManager.renderFixtures();
                    StatsManager.updateQuickStats();
                });
            },

            loadResults: () => {
                db.collection("fixtures").where("played", "==", true).onSnapshot((snapshot) => {
                    AppData.results = [];
                    snapshot.forEach((doc) => {
                        AppData.results.push({ id: doc.id, ...doc.data() });
                    });
                    AppData.results.sort((a, b) => new Date(b.date) - new Date(a.date));
                    ResultManager.render();
                    StatsManager.updateQuickStats();
                });
            },

            loadNews: () => {
                db.collection("news").orderBy("timestamp", "desc").onSnapshot((snapshot) => {
                    AppData.news = [];
                    snapshot.forEach((doc) => {
                        AppData.news.push({ id: doc.id, ...doc.data() });
                    });
                    NewsManager.render();
                    AdminManager.renderNews();
                    StatsManager.loadHomeData();
                });
            },

            loadPlayers: () => {
                db.collection("players").onSnapshot((snapshot) => {
                    AppData.players = [];
                    snapshot.forEach((doc) => {
                        AppData.players.push({ id: doc.id, ...doc.data() });
                    });
                    PlayerManager.render();
                    PlayerManager.renderMobile();
                });
            },

            loadComments: () => {
                db.collection("comments").onSnapshot((snapshot) => {
                    AppData.comments = {};
                    snapshot.forEach((doc) => {
                        const comment = { id: doc.id, ...doc.data() };
                        if (!AppData.comments[comment.newsId]) {
                            AppData.comments[comment.newsId] = [];
                        }
                        AppData.comments[comment.newsId].push(comment);
                    });
                    Object.keys(AppData.comments).forEach(newsId => {
                        AppData.comments[newsId].sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));
                    });
                });
            }
        };

        // ========================================
        // NAVIGATION MANAGER
        // ========================================
        const NavigationManager = {
            currentSection: 'home',
            adminClickCount: 0,

            init: () => {
                NavigationManager.setupEventListeners();
                NavigationManager.showSection('home');
            },

            setupEventListeners: () => {
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.addEventListener('click', function(e) {
                        e.preventDefault();
                        NavigationManager.showSection(this.dataset.section);
                    });
                });

                document.getElementById('mobile-menu-toggle').addEventListener('click', function() {
                    document.getElementById('nav-menu').classList.toggle('show');
                });

                document.querySelectorAll('.nav-link').forEach(link => {
                    link.addEventListener('click', function() {
                        document.getElementById('nav-menu').classList.remove('show');
                    });
                });

                window.addEventListener('click', function(event) {
                    const modal = document.getElementById('modal');
                    const newsModal = document.getElementById('news-modal');
                    if (event.target === modal) {
                        ModalManager.closeModal();
                    }
                    if (event.target === newsModal) {
                        ModalManager.closeNewsModal();
                    }
                });
            },

            showSection: (sectionName) => {
                document.querySelectorAll('.section').forEach(section => {
                    section.classList.remove('active');
                });
                document.getElementById(sectionName).classList.add('active');

                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.remove('active');
                });
                const targetLink = document.querySelector(`[data-section="${sectionName}"]`);
                if (targetLink) targetLink.classList.add('active');

                NavigationManager.currentSection = sectionName;

                switch(sectionName) {
                    case 'home':
                        StatsManager.loadHomeData();
                        break;
                    case 'news':
                        NewsManager.render();
                        break;
                    case 'fixtures':
                        FixtureManager.render();
                        break;
                    case 'results':
                        ResultManager.render();
                        break;
                    case 'players':
                        PlayerManager.render();
                        PlayerManager.renderMobile();
                        break;
                    case 'playoffs':
                        PlayoffManager.showPlayoffBracket();
                        break;
                }
            },

            adminAccess: () => {
                NavigationManager.adminClickCount++;
                if (NavigationManager.adminClickCount >= 5) {
                    document.body.classList.add('admin-mode');
                    alert('Admin mode activated!');
                    NavigationManager.adminClickCount = 0;
                }
            },

            toggleAdmin: () => {
                const panel = document.getElementById('admin-panel');
                panel.classList.toggle('show');
            }
        };

        // ========================================
        // NEWS MANAGER
        // ========================================
        const NewsManager = {
            render: () => {
                const container = document.getElementById('news-grid');
                let html = '';

                if (AppData.news.length === 0) {
                    html = '<div class="loading"><div class="spinner"></div><p>Loading news...</p></div>';
                } else {
                    AppData.news.forEach(article => {
                        const commentCount = AppData.comments[article.id] ? AppData.comments[article.id].length : 0;
                        html += `
                            <div class="card news-card" onclick="NewsManager.showDetails('${article.id}')">
                                <div class="news-image">
                                    <i class="fas fa-newspaper" style="font-size: 3rem; opacity: 0.3;"></i>
                                </div>
                                <div class="news-meta">
                                    <i class="fas fa-calendar-alt"></i> ${article.date || 'No date'}
                                    <span style="float: right;"><i class="fas fa-comments"></i> ${commentCount}</span>
                                </div>
                                <h3>${article.title}</h3>
                                <div class="news-excerpt">
                                    ${article.content.substring(0, 150)}${article.content.length > 150 ? '...' : ''}
                                </div>
                                <div style="color: var(--accent-color); font-weight: bold;">
                                    Read More <i class="fas fa-arrow-right"></i>
                                </div>
                            </div>
                        `;
                    });
                }
                container.innerHTML = html;
            },

            renderHome: () => {
                const container = document.getElementById('home-news-grid');
                const latestNews = AppData.news.slice(0, 3);
                
                let html = '';
                if (latestNews.length === 0) {
                    html = '<div class="loading"><p>No news articles yet.</p></div>';
                } else {
                    latestNews.forEach(article => {
                        const commentCount = AppData.comments[article.id] ? AppData.comments[article.id].length : 0;
                        html += `
                            <div class="card news-card" onclick="NewsManager.showDetails('${article.id}')">
                                <div class="news-image">
                                    <i class="fas fa-newspaper" style="font-size: 3rem; opacity: 0.3;"></i>
                                </div>
                                <div class="news-meta">
                                    <i class="fas fa-calendar-alt"></i> ${article.date || 'No date'}
                                    <span style="float: right;"><i class="fas fa-comments"></i> ${commentCount}</span>
                                </div>
                                <h3>${article.title}</h3>
                                <div class="news-excerpt">
                                    ${article.content.substring(0, 100)}${article.content.length > 100 ? '...' : ''}
                                </div>
                                <div style="color: var(--accent-color); font-weight: bold;">
                                    Read More <i class="fas fa-arrow-right"></i>
                                </div>
                            </div>
                        `;
                    });
                }
                container.innerHTML = html;
            },

            showDetails: (newsId) => {
                const article = AppData.news.find(n => n.id === newsId);
                if (!article) return;

                CommentManager.currentNewsId = newsId;
                document.getElementById('news-modal-title').innerHTML = `<i class="fas fa-newspaper"></i> ${article.title}`;
                document.getElementById('news-modal-body').innerHTML = `
                    <div style="margin-bottom: 1rem;">
                        <p style="opacity: 0.7;"><i class="fas fa-calendar-alt"></i> ${article.date}</p>
                    </div>
                    <div style="line-height: 1.8; white-space: pre-line;">
                        ${article.content}
                    </div>
                `;
                
                CommentManager.renderComments(newsId);
                document.getElementById('news-modal').style.display = 'block';
            },

            addNews: async () => {
                const title = document.getElementById('news-title').value.trim();
                const content = document.getElementById('news-content').value.trim();

                if (!title || !content) {
                    alert('Please fill in title and content');
                    return;
                }

                try {
                    await db.collection("news").add({
                        title,
                        content,
                        timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                        date: new Date().toISOString().split('T')[0]
                    });

                    document.getElementById('news-title').value = '';
                    document.getElementById('news-content').value = '';
                    alert('News article added successfully!');
                } catch (error) {
                    console.error("Error adding news:", error);
                    alert('Error adding news article. Please try again.');
                }
            },

            removeNews: async (newsId) => {
                if (!confirm('Are you sure you want to remove this news article?')) {
                    return;
                }
                
                try {
                    await db.collection("news").doc(newsId).delete();
                    const comments = await db.collection("comments").where("newsId", "==", newsId).get();
                    const batch = db.batch();
                    comments.docs.forEach(doc => {
                        batch.delete(doc.ref);
                    });
                    await batch.commit();
                    alert('News article and its comments removed successfully!');
                } catch (error) {
                    console.error("Error removing news:", error);
                    alert('Error removing news article. Please try again.');
                }
            }
        };

        // ========================================
        // COMMENT MANAGER
        // ========================================
        const CommentManager = {
            currentNewsId: null,

            renderComments: (newsId) => {
                const commentsList = document.getElementById('comments-list');
                const comments = AppData.comments[newsId] || [];
                
                let html = '';
                if (comments.length === 0) {
                    html = '<p style="text-align: center; opacity: 0.7;">No comments yet. Be the first to comment!</p>';
                } else {
                    comments.forEach(comment => {
                        const date = Utils.formatDate(comment.timestamp);
                        html += `
                            <div class="comment-item">
                                <div class="comment-author">
                                    ${comment.author}
                                    <span class="comment-date">${date}</span>
                                </div>
                                <div class="comment-content">${comment.text}</div>
                            </div>
                        `;
                    });
                }
                commentsList.innerHTML = html;
            },

            addComment: async () => {
                if (!CommentManager.currentNewsId) return;

                const author = document.getElementById('comment-author').value.trim();
                const text = document.getElementById('comment-text').value.trim();

                if (!author || !text) {
                    alert('Please enter your name and comment');
                    return;
                }

                try {
                    await db.collection("comments").add({
                        newsId: CommentManager.currentNewsId,
                        author,
                        text,
                        timestamp: firebase.firestore.FieldValue.serverTimestamp()
                    });

                    document.getElementById('comment-author').value = '';
                    document.getElementById('comment-text').value = '';
                    alert('Comment added successfully!');
                } catch (error) {
                    console.error("Error adding comment:", error);
                    alert('Error adding comment. Please try again.');
                }
            }
        };

        // ========================================
        // STANDINGS MANAGER
        // ========================================
        const StandingsManager = {
            showStandings: (division) => {
                const teams = AppData.teams[division].map(team => team.name);
                const divisionResults = AppData.results.filter(r => r.division === division && r.played);
                
                const standings = teams.map(teamName => {
                    const teamResults = divisionResults.filter(result => 
                        result.homeTeam === teamName || result.awayTeam === teamName
                    );

                    let wins = 0, losses = 0, forfeits = 0, pointsFor = 0, pointsAgainst = 0;

                    teamResults.forEach(result => {
                        const isHome = result.homeTeam === teamName;
                        const teamScore = isHome ? result.homeScore : result.awayScore;
                        const opponentScore = isHome ? result.awayScore : result.homeScore;

                        pointsFor += teamScore;
                        pointsAgainst += opponentScore;

                        if (result.forfeit) {
                            if ((isHome && result.forfeitTeam === 'home') || (!isHome && result.forfeitTeam === 'away')) {
                                forfeits++;
                            } else {
                                wins++;
                            }
                        } else {
                            if (teamScore > opponentScore) {
                                wins++;
                            } else {
                                losses++;
                            }
                        }
                    });

                    const totalPoints = (wins * 2) + (losses * 1) + (forfeits * 0);
                    return {
                        team: teamName,
                        played: teamResults.length,
                        wins,
                        losses,
                        forfeits,
                        pointsFor,
                        pointsAgainst,
                        pointsDiff: pointsFor - pointsAgainst,
                        points: totalPoints
                    };
                });

                standings.sort((a, b) => {
                    if (b.points !== a.points) return b.points - a.points;
                    if (b.pointsDiff !== a.pointsDiff) return b.pointsDiff - a.pointsDiff;
                    return b.pointsFor - a.pointsFor;
                });

                let html = `
                    <div class="mobile-standings">
                        <div class="mobile-standings-header">
                            <span><i class="fas fa-chart-line"></i> ${Utils.getDivisionName(division)} - Standings</span>
                            <span>Point System: 2 for Win, 1 for Loss, 0 for Forfeit</span>
                        </div>
                `;

                standings.forEach((team, index) => {
                    const structure = LeagueConfig[division];
                    const qualifiesForPlayoffs = index < (structure?.playoffTeams || 0);
                    
                    html += `
                        <div class="mobile-team-row" onclick="TeamManager.showTeamDetails('${division}', '${team.team}')">
                            <div class="mobile-team-info">
                                <div class="mobile-team-position" style="${qualifiesForPlayoffs ? 'background: #4CAF50;' : 'background: var(--fiba-orange);'}">${index + 1}</div>
                                <div class="mobile-team-name">${team.team}</div>
                            </div>
                            <div class="mobile-team-stats">
                                <div class="mobile-stat">
                                    <div class="mobile-stat-value">${team.played}</div>
                                    <div class="mobile-stat-label">P</div>
                                </div>
                                <div class="mobile-stat">
                                    <div class="mobile-stat-value status-win">${team.wins}</div>
                                    <div class="mobile-stat-label">W</div>
                                </div>
                                <div class="mobile-stat">
                                    <div class="mobile-stat-value">${team.pointsDiff >= 0 ? '+' : ''}${team.pointsDiff}</div>
                                    <div class="mobile-stat-label">PD</div>
                                </div>
                                <div class="mobile-stat">
                                    <div class="mobile-stat-value" style="color: var(--accent-color); font-weight: bold;">${team.points}</div>
                                    <div class="mobile-stat-label">Pts</div>
                                </div>
                            </div>
                        </div>
                    `;
                });

                html += '</div>';
                html += `
                    <p style="margin-top: 1rem; font-size: 0.9rem; opacity: 0.7;">
                        <em>P=Played, W=Won, PD=Point Difference, Pts=League Points</em>
                    </p>
                `;

                document.getElementById('modal-title').innerHTML = `<i class="fas fa-chart-line"></i> Standings`;
                document.getElementById('modal-body').innerHTML = html;
                document.getElementById('modal').style.display = 'block';
            }
        };

        // ========================================
        // FIXTURE MANAGER
        // ========================================
        const FixtureManager = {
            render: (filterDivision = 'all') => {
                const container = document.getElementById('fixtures-list');
                let fixtures = AppData.fixtures.filter(f => !f.played);
                
                if (filterDivision !== 'all') {
                    fixtures = fixtures.filter(f => f.division === filterDivision);
                }
                
                fixtures = fixtures.sort((a, b) => new Date(a.date) - new Date(b.date));

                let html = '';
                if (fixtures.length === 0) {
                    html = '<div class="loading"><p>No fixtures scheduled for this division.</p></div>';
                } else {
                    fixtures.forEach(fixture => {
                        html += `
                            <div class="mobile-match-card">
                                <div class="mobile-match-header">
                                    <span><i class="fas fa-medal"></i> ${Utils.getDivisionName(fixture.division)}</span>
                                    <span><i class="fas fa-calendar-alt"></i> ${fixture.date} ${fixture.time}</span>
                                </div>
                                <div class="mobile-match-body">
                                    <div class="mobile-teams-container">
                                        <div class="mobile-team">
                                            <div class="mobile-team-logo">${fixture.homeTeam.charAt(0)}</div>
                                            <div style="font-weight: bold;">${fixture.homeTeam}</div>
                                            <div style="font-size: 0.8rem; opacity: 0.7;">Home</div>
                                        </div>
                                        <div class="mobile-score">VS</div>
                                        <div class="mobile-team">
                                            <div class="mobile-team-logo">${fixture.awayTeam.charAt(0)}</div>
                                            <div style="font-weight: bold;">${fixture.awayTeam}</div>
                                            <div style="font-size: 0.8rem; opacity: 0.7;">Away</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                }
                container.innerHTML = html;
            },

            filterFixtures: () => {
                const selectedDivision = document.getElementById('fixtures-division-filter').value;
                FixtureManager.render(selectedDivision);
            },

            addFixture: async () => {
                const division = document.getElementById('fixture-division').value;
                const homeTeam = document.getElementById('fixture-home-team').value;
                const awayTeam = document.getElementById('fixture-away-team').value;
                const date = document.getElementById('fixture-date').value;
                const time = document.getElementById('fixture-time').value;

                if (!homeTeam || !awayTeam || !date || !time) {
                    alert('Please fill in all fields');
                    return;
                }

                if (homeTeam === awayTeam) {
                    alert('Home and Away teams cannot be the same!');
                    return;
                }

                try {
                    await db.collection("fixtures").add({
                        division,
                        homeTeam,
                        awayTeam,
                        date,
                        time,
                        played: false,
                        timestamp: firebase.firestore.FieldValue.serverTimestamp()
                    });

                    document.getElementById('fixture-date').value = '';
                    document.getElementById('fixture-time').value = '';
                    alert("Fixture added successfully!");
                } catch (error) {
                    console.error("Error adding fixture:", error);
                    alert("Error adding fixture. Please try again.");
                }
            },

            removeFixture: async (fixtureId) => {
                if (!confirm('Are you sure you want to remove this fixture?')) {
                    return;
                }
                
                try {
                    await db.collection("fixtures").doc(fixtureId).delete();
                    alert("Fixture removed successfully!");
                } catch (error) {
                    console.error("Error removing fixture:", error);
                    alert("Error removing fixture. Please try again.");
                }
            },

            updateFixtureTeams: () => {
                const division = document.getElementById('fixture-division').value;
                const homeSelect = document.getElementById('fixture-home-team');
                const awaySelect = document.getElementById('fixture-away-team');
                
                homeSelect.innerHTML = '';
                awaySelect.innerHTML = '';

                const teams = AppData.teams[division] || [];
                teams.forEach(team => {
                    homeSelect.innerHTML += `<option value="${team.name}">${team.name}</option>`;
                    awaySelect.innerHTML += `<option value="${team.name}">${team.name}</option>`;
                });
            },

            updateAllTeamSelects: () => {
                FixtureManager.updateFixtureTeams();
                ResultManager.updateMatchTeams();
                PlayerManager.updatePlayerTeams();
            }
        };

        // ========================================
        // RESULT MANAGER
        // ========================================
        const ResultManager = {
            render: (filterDivision = 'all') => {
                const container = document.getElementById('results-list');
                let results = AppData.results.filter(r => r.played);
                
                if (filterDivision !== 'all') {
                    results = results.filter(r => r.division === filterDivision);
                }
                
                results = results.sort((a, b) => new Date(b.date) - new Date(a.date));

                let html = '';
                if (results.length === 0) {
                    html = '<div class="loading"><p>No results available for this division.</p></div>';
                } else {
                    results.forEach(result => {
                        let resultText, winnerText, winnerClass = '';
                        
                        if (result.forfeit) {
                            const forfeitingTeam = result.forfeitTeam === 'home' ? result.homeTeam : result.awayTeam;
                            const winningTeam = result.forfeitTeam === 'home' ? result.awayTeam : result.homeTeam;
                            resultText = 'FORFEIT';
                            winnerText = `Winner: ${winningTeam}`;
                            winnerClass = 'status-forfeit';
                        } else {
                            resultText = `${result.homeScore} - ${result.awayScore}`;
                            const winner = result.homeScore > result.awayScore ? result.homeTeam : 
                                          result.homeScore < result.awayScore ? result.awayTeam : null;
                            winnerText = winner ? `Winner: ${winner}` : 'Match ended in a tie';
                            winnerClass = winner ? 'status-win' : '';
                        }

                        html += `
                            <div class="mobile-match-card">
                                <div class="mobile-match-header">
                                    <span><i class="fas fa-medal"></i> ${Utils.getDivisionName(result.division)}</span>
                                    <span><i class="fas fa-calendar-alt"></i> ${result.date}</span>
                                </div>
                                <div class="mobile-match-body">
                                    <div class="mobile-teams-container">
                                        <div class="mobile-team">
                                            <div class="mobile-team-logo">${result.homeTeam.charAt(0)}</div>
                                            <div style="font-weight: bold;">${result.homeTeam}</div>
                                            <div style="font-size: 0.8rem; opacity: 0.7;">Home</div>
                                        </div>
                                        <div class="mobile-score">${resultText}</div>
                                        <div class="mobile-team">
                                            <div class="mobile-team-logo">${result.awayTeam.charAt(0)}</div>
                                            <div style="font-weight: bold;">${result.awayTeam}</div>
                                            <div style="font-size: 0.8rem; opacity: 0.7;">Away</div>
                                        </div>
                                    </div>
                                    <div class="mobile-match-info">
                                        <span class="${winnerClass}"><i class="fas fa-trophy"></i> ${winnerText}</span>
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                }
                container.innerHTML = html;
            },

            filterResults: () => {
                const selectedDivision = document.getElementById('results-division-filter').value;
                ResultManager.render(selectedDivision);
            },

            addMatchResult: async () => {
                const division = document.getElementById('match-division').value;
                const homeTeam = document.getElementById('match-home-team').value;
                const awayTeam = document.getElementById('match-away-team').value;
                const date = document.getElementById('match-date').value;
                const resultType = document.getElementById('match-result-type').value;

                if (!homeTeam || !awayTeam || !date) {
                    alert('Please fill in all required fields');
                    return;
                }

                let resultData = {
                    division,
                    homeTeam,
                    awayTeam,
                    date,
                    played: true,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                };

                if (resultType === 'normal') {
                    const homeScore = parseInt(document.getElementById('match-home-score').value, 10);
                    const awayScore = parseInt(document.getElementById('match-away-score').value, 10);

                    if (isNaN(homeScore) || isNaN(awayScore)) {
                        alert("Please enter both scores");
                        return;
                    }

                    resultData.homeScore = homeScore;
                    resultData.awayScore = awayScore;
                } else if (resultType === 'forfeit') {
                    const forfeitTeam = document.getElementById('match-forfeit-team').value;
                    resultData.forfeit = true;
                    resultData.forfeitTeam = forfeitTeam;
                    resultData.homeScore = forfeitTeam === "home" ? 0 : 20;
                    resultData.awayScore = forfeitTeam === "away" ? 0 : 20;
                }

                try {
                    const querySnapshot = await db.collection("fixtures")
                        .where("division", "==", division)
                        .where("homeTeam", "==", homeTeam)
                        .where("awayTeam", "==", awayTeam)
                        .where("date", "==", date)
                        .limit(1)
                        .get();

                    if (!querySnapshot.empty) {
                        await db.collection("fixtures").doc(querySnapshot.docs[0].id).update(resultData);
                    } else {
                        await db.collection("fixtures").add(resultData);
                    }

                    // Clear form
                    document.getElementById('match-home-score').value = '';
                    document.getElementById('match-away-score').value = '';
                    document.getElementById('match-date').value = '';
                    alert("Match result recorded successfully!");
                } catch (error) {
                    console.error("Error recording match result:", error);
                    alert("Error recording match result. Please try again.");
                }
            },

            toggleMatchInputs: () => {
                const resultType = document.getElementById('match-result-type').value;
                const normalInputs = document.getElementById('match-normal-inputs');
                const forfeitInputs = document.getElementById('match-forfeit-inputs');

                if (resultType === 'forfeit') {
                    normalInputs.classList.add('hidden');
                    forfeitInputs.classList.remove('hidden');
                } else {
                    normalInputs.classList.remove('hidden');
                    forfeitInputs.classList.add('hidden');
                }
            },

            updateMatchTeams: () => {
                const division = document.getElementById('match-division').value;
                const homeSelect = document.getElementById('match-home-team');
                const awaySelect = document.getElementById('match-away-team');
                
                homeSelect.innerHTML = '';
                awaySelect.innerHTML = '';

                const teams = AppData.teams[division] || [];
                teams.forEach(team => {
                    homeSelect.innerHTML += `<option value="${team.name}">${team.name}</option>`;
                    awaySelect.innerHTML += `<option value="${team.name}">${team.name}</option>`;
                });
            },

            removeResult: async (resultId) => {
                if (!confirm('Are you sure you want to remove this match result? This will revert it to a scheduled fixture.')) {
                    return;
                }
                
                try {
                    await db.collection("fixtures").doc(resultId).update({
                        played: false,
                        homeScore: firebase.firestore.FieldValue.delete(),
                        awayScore: firebase.firestore.FieldValue.delete(),
                        forfeit: firebase.firestore.FieldValue.delete(),
                        forfeitTeam: firebase.firestore.FieldValue.delete()
                    });
                    alert('Match result removed successfully!');
                } catch (error) {
                    console.error("Error removing result:", error);
                    alert('Error removing result. Please try again.');
                }
            }
        };

        // ========================================
        // PLAYER MANAGER
        // ========================================
        const PlayerManager = {
            render: () => {
                const container = document.getElementById('players-list');
                const selectedDivision = document.getElementById('players-division-filter').value;
                const selectedTeam = document.getElementById('players-team-filter').value;

                let filteredPlayers = AppData.players;

                if (selectedDivision !== 'all') {
                    filteredPlayers = filteredPlayers.filter(p => p.division === selectedDivision);
                }

                if (selectedTeam !== 'all') {
                    filteredPlayers = filteredPlayers.filter(p => p.team === selectedTeam);
                }

                filteredPlayers.sort((a, b) => (b.totalPoints || 0) - (a.totalPoints || 0));

                let html = '';
                if (filteredPlayers.length === 0) {
                    html = '<div class="loading"><p>No player statistics available.</p></div>';
                } else {
                    filteredPlayers.forEach(player => {
                        const avgPoints = Utils.calculateAverage(player.totalPoints, player.gamesPlayed);
                        const avgRebounds = Utils.calculateAverage(player.totalRebounds, player.gamesPlayed);
                        const avgAssists = Utils.calculateAverage(player.totalAssists, player.gamesPlayed);
                        
                        const fg2Pct = Utils.calculatePercentage(player.total2PM, player.total2PA);
                        const fg3Pct = Utils.calculatePercentage(player.total3PM, player.total3PA);
                        const ftPct = Utils.calculatePercentage(player.totalFTM, player.totalFTA);

                        html += `
                            <div class="player-stats-card" onclick="PlayerManager.showPlayerDetails('${player.id}')">
                                <div class="player-header">
                                    <div>
                                        <div class="player-name">${player.name}</div>
                                        <div style="font-size: 0.9rem; opacity: 0.8;">${player.team} • ${Utils.getDivisionName(player.division)}</div>
                                    </div>
                                    <div class="player-number">#${player.number || '--'}</div>
                                </div>
                                <div class="stats-grid">
                                    <div class="stat-item">
                                        <div class="stat-value">${player.gamesPlayed || 0}</div>
                                        <div class="stat-label">GP</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value">${avgPoints}</div>
                                        <div class="stat-label">PPG</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value">${avgRebounds}</div>
                                        <div class="stat-label">RPG</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value">${avgAssists}</div>
                                        <div class="stat-label">APG</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value">${fg2Pct}%</div>
                                        <div class="stat-label">FG2%</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value">${fg3Pct}%</div>
                                        <div class="stat-label">FG3%</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value">${ftPct}%</div>
                                        <div class="stat-label">FT%</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value">${player.totalPoints || 0}</div>
                                        <div class="stat-label">PTS</div>
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                }
                container.innerHTML = html;
            },

            renderMobile: () => {
                const container = document.getElementById('mobile-players-list');
                const selectedDivision = document.getElementById('players-division-filter').value;
                const selectedTeam = document.getElementById('players-team-filter').value;

                let filteredPlayers = AppData.players;

                if (selectedDivision !== 'all') {
                    filteredPlayers = filteredPlayers.filter(p => p.division === selectedDivision);
                }

                if (selectedTeam !== 'all') {
                    filteredPlayers = filteredPlayers.filter(p => p.team === selectedTeam);
                }

                filteredPlayers.sort((a, b) => (b.totalPoints || 0) - (a.totalPoints || 0));

                let html = '';
                if (filteredPlayers.length === 0) {
                    html = '<div class="loading"><p>No player statistics available.</p></div>';
                } else {
                    filteredPlayers.forEach(player => {
                        const avgPoints = Utils.calculateAverage(player.totalPoints, player.gamesPlayed);
                        const avgRebounds = Utils.calculateAverage(player.totalRebounds, player.gamesPlayed);
                        const avgAssists = Utils.calculateAverage(player.totalAssists, player.gamesPlayed);

                        html += `
                            <div class="mobile-player-card" onclick="PlayerManager.showPlayerDetails('${player.id}')">
                                <div class="mobile-player-header">
                                    <div class="mobile-player-info">
                                        <div class="mobile-player-number">#${player.number || '--'}</div>
                                        <div>
                                            <div style="font-weight: bold; font-size: 1.1rem;">${player.name}</div>
                                            <div style="font-size: 0.9rem; opacity: 0.8;">${player.team}</div>
                                        </div>
                                    </div>
                                    <div style="text-align: right;">
                                        <div style="font-size: 0.8rem; opacity: 0.8;">${Utils.getDivisionName(player.division)}</div>
                                        <div style="font-size: 0.8rem; opacity: 0.8;">${player.gamesPlayed || 0} GP</div>
                                    </div>
                                </div>
                                <div class="mobile-stats-row">
                                    <div class="mobile-quick-stat">
                                        <div class="mobile-quick-stat-value">${avgPoints}</div>
                                        <div class="mobile-quick-stat-label">PPG</div>
                                    </div>
                                    <div class="mobile-quick-stat">
                                        <div class="mobile-quick-stat-value">${avgRebounds}</div>
                                        <div class="mobile-quick-stat-label">RPG</div>
                                    </div>
                                    <div class="mobile-quick-stat">
                                        <div class="mobile-quick-stat-value">${avgAssists}</div>
                                        <div class="mobile-quick-stat-label">APG</div>
                                    </div>
                                    <div class="mobile-quick-stat">
                                        <div class="mobile-quick-stat-value">${player.totalPoints || 0}</div>
                                        <div class="mobile-quick-stat-label">TOT PTS</div>
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                }
                container.innerHTML = html;
            },

            filterPlayers: () => {
                PlayerManager.render();
                PlayerManager.renderMobile();
            },

            updatePlayerTeams: () => {
                const division = document.getElementById('player-division').value;
                const teamSelect = document.getElementById('player-team');
                
                teamSelect.innerHTML = '<option value="">Select Team</option>';
                
                const teams = AppData.teams[division] || [];
                teams.forEach(team => {
                    teamSelect.innerHTML += `<option value="${team.name}">${team.name}</option>`;
                });

                // Update player filter team select as well
                const filterTeamSelect = document.getElementById('players-team-filter');
                const currentFilter = filterTeamSelect.value;
                filterTeamSelect.innerHTML = '<option value="all">All Teams</option>';
                
                const selectedDivision = document.getElementById('players-division-filter').value;
                if (selectedDivision !== 'all') {
                    const divisionTeams = AppData.teams[selectedDivision] || [];
                    divisionTeams.forEach(team => {
                        filterTeamSelect.innerHTML += `<option value="${team.name}">${team.name}</option>`;
                    });
                }
                
                if (currentFilter !== 'all') {
                    filterTeamSelect.value = currentFilter;
                }
            },

            addPlayerStats: async () => {
                const playerData = {
                    name: document.getElementById('player-name').value.trim(),
                    number: parseInt(document.getElementById('player-number').value),
                    team: document.getElementById('player-team').value,
                    division: document.getElementById('player-division').value,
                    points: parseInt(document.getElementById('player-points').value) || 0,
                    twoPointsMade: parseInt(document.getElementById('player-2pm').value) || 0,
                    twoPointsAttempted: parseInt(document.getElementById('player-2pa').value) || 0,
                    threePointsMade: parseInt(document.getElementById('player-3pm').value) || 0,
                    threePointsAttempted: parseInt(document.getElementById('player-3pa').value) || 0,
                    freeThrowsMade: parseInt(document.getElementById('player-ftm').value) || 0,
                    freeThrowsAttempted: parseInt(document.getElementById('player-fta').value) || 0,
                    offensiveRebounds: parseInt(document.getElementById('player-oreb').value) || 0,
                    defensiveRebounds: parseInt(document.getElementById('player-dreb').value) || 0,
                    assists: parseInt(document.getElementById('player-assists').value) || 0,
                    turnovers: parseInt(document.getElementById('player-turnovers').value) || 0,
                    steals: parseInt(document.getElementById('player-steals').value) || 0,
                    fouls: parseInt(document.getElementById('player-fouls').value) || 0,
                    blocks: parseInt(document.getElementById('player-blocks').value) || 0,
                    matchDate: document.getElementById('stats-match-date').value,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                };

                if (!playerData.name || !playerData.team) {
                    alert('Please fill in player name and team');
                    return;
                }

                try {
                    const existingPlayer = AppData.players.find(p => 
                        p.name === playerData.name && p.team === playerData.team
                    );

                    if (existingPlayer) {
                        await db.collection("players").doc(existingPlayer.id).update({
                            gamesPlayed: (existingPlayer.gamesPlayed || 0) + 1,
                            totalPoints: (existingPlayer.totalPoints || 0) + playerData.points,
                            totalAssists: (existingPlayer.totalAssists || 0) + playerData.assists,
                            totalRebounds: (existingPlayer.totalRebounds || 0) + playerData.offensiveRebounds + playerData.defensiveRebounds,
                            totalSteals: (existingPlayer.totalSteals || 0) + playerData.steals,
                            totalBlocks: (existingPlayer.totalBlocks || 0) + playerData.blocks,
                            total2PM: (existingPlayer.total2PM || 0) + playerData.twoPointsMade,
                            total2PA: (existingPlayer.total2PA || 0) + playerData.twoPointsAttempted,
                            total3PM: (existingPlayer.total3PM || 0) + playerData.threePointsMade,
                            total3PA: (existingPlayer.total3PA || 0) + playerData.threePointsAttempted,
                            totalFTM: (existingPlayer.totalFTM || 0) + playerData.freeThrowsMade,
                            totalFTA: (existingPlayer.totalFTA || 0) + playerData.freeThrowsAttempted,
                            lastGamePoints: playerData.points,
                            lastGameDate: playerData.matchDate
                        });
                    } else {
                        await db.collection("players").add({
                            name: playerData.name,
                            number: playerData.number,
                            team: playerData.team,
                            division: playerData.division,
                            gamesPlayed: 1,
                            totalPoints: playerData.points,
                            totalAssists: playerData.assists,
                            totalRebounds: playerData.offensiveRebounds + playerData.defensiveRebounds,
                            totalSteals: playerData.steals,
                            totalBlocks: playerData.blocks,
                            total2PM: playerData.twoPointsMade,
                            total2PA: playerData.twoPointsAttempted,
                            total3PM: playerData.threePointsMade,
                            total3PA: playerData.threePointsAttempted,
                            totalFTM: playerData.freeThrowsMade,
                            totalFTA: playerData.freeThrowsAttempted,
                            lastGamePoints: playerData.points,
                            lastGameDate: playerData.matchDate,
                            timestamp: firebase.firestore.FieldValue.serverTimestamp()
                        });
                    }

                    await db.collection("game_stats").add(playerData);

                    // Clear form
                    const formFields = ['player-name', 'player-number', 'player-points', 'player-2pm', 'player-2pa', 
                                       'player-3pm', 'player-3pa', 'player-ftm', 'player-fta', 'player-oreb', 
                                       'player-dreb', 'player-assists', 'player-turnovers', 'player-steals', 
                                       'player-fouls', 'player-blocks', 'stats-match-date'];
                    
                    formFields.forEach(field => {
                        document.getElementById(field).value = '';
                    });

                    alert('Player statistics added successfully!');
                } catch (error) {
                    console.error("Error adding player stats:", error);
                    alert('Error adding player statistics. Please try again.');
                }
            },

            showPlayerDetails: (playerId) => {
                const player = AppData.players.find(p => p.id === playerId);
                if (!player) return;

                const avgPoints = Utils.calculateAverage(player.totalPoints, player.gamesPlayed);
                const avgRebounds = Utils.calculateAverage(player.totalRebounds, player.gamesPlayed);
                const avgAssists = Utils.calculateAverage(player.totalAssists, player.gamesPlayed);
                
                const fg2Pct = Utils.calculatePercentage(player.total2PM, player.total2PA);
                const fg3Pct = Utils.calculatePercentage(player.total3PM, player.total3PA);
                const ftPct = Utils.calculatePercentage(player.totalFTM, player.totalFTA);
                
                const totalFGM = (player.total2PM || 0) + (player.total3PM || 0);
                const totalFGA = (player.total2PA || 0) + (player.total3PA || 0);
                const fgPct = Utils.calculatePercentage(totalFGM, totalFGA);

                document.getElementById('modal-title').innerHTML = `<i class="fas fa-user"></i> ${player.name} (#${player.number || '--'})`;
                document.getElementById('modal-body').innerHTML = `
                    <div style="text-align: center; margin-bottom: 2rem;">
                        <h3>${player.name}</h3>
                        <p style="opacity: 0.8;"><strong>Team:</strong> ${player.team} • <strong>Division:</strong> ${Utils.getDivisionName(player.division)}</p>
                        <p style="opacity: 0.8;"><strong>Jersey Number:</strong> #${player.number || '--'}</p>
                    </div>
                    
                    <div class="grid grid-2">
                        <div>
                            <h4><i class="fas fa-chart-line"></i> Season Averages</h4>
                            <div class="mobile-standings">
                                <div class="mobile-team-row"><div class="mobile-team-info"><strong>Games Played</strong></div><div class="mobile-team-stats">${player.gamesPlayed || 0}</div></div>
                                <div class="mobile-team-row"><div class="mobile-team-info"><strong>Points per Game</strong></div><div class="mobile-team-stats">${avgPoints}</div></div>
                                <div class="mobile-team-row"><div class="mobile-team-info"><strong>Rebounds per Game</strong></div><div class="mobile-team-stats">${avgRebounds}</div></div>
                                <div class="mobile-team-row"><div class="mobile-team-info"><strong>Assists per Game</strong></div><div class="mobile-team-stats">${avgAssists}</div></div>
                                <div class="mobile-team-row"><div class="mobile-team-info"><strong>Steals per Game</strong></div><div class="mobile-team-stats">${Utils.calculateAverage(player.totalSteals, player.gamesPlayed)}</div></div>
                                <div class="mobile-team-row"><div class="mobile-team-info"><strong>Blocks per Game</strong></div><div class="mobile-team-stats">${Utils.calculateAverage(player.totalBlocks, player.gamesPlayed)}</div></div>
                            </div>
                        </div>
                        
                        <div>
                            <h4><i class="fas fa-percentage"></i> Shooting Percentages</h4>
                            <div class="mobile-standings">
                                <div class="mobile-team-row"><div class="mobile-team-info"><strong>Field Goal %</strong></div><div class="mobile-team-stats">${fgPct}% (${totalFGM}/${totalFGA})</div></div>
                                <div class="mobile-team-row"><div class="mobile-team-info"><strong>2-Point %</strong></div><div class="mobile-team-stats">${fg2Pct}% (${player.total2PM || 0}/${player.total2PA || 0})</div></div>
                                <div class="mobile-team-row"><div class="mobile-team-info"><strong>3-Point %</strong></div><div class="mobile-team-stats">${fg3Pct}% (${player.total3PM || 0}/${player.total3PA || 0})</div></div>
                                <div class="mobile-team-row"><div class="mobile-team-info"><strong>Free Throw %</strong></div><div class="mobile-team-stats">${ftPct}% (${player.totalFTM || 0}/${player.totalFTA || 0})</div></div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 2rem;">
                        <h4><i class="fas fa-trophy"></i> Season Totals</h4>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <div class="stat-value">${player.totalPoints || 0}</div>
                                <div class="stat-label">Total Points</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${player.totalRebounds || 0}</div>
                                <div class="stat-label">Total Rebounds</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${player.totalAssists || 0}</div>
                                <div class="stat-label">Total Assists</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${player.totalSteals || 0}</div>
                                <div class="stat-label">Total Steals</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${player.totalBlocks || 0}</div>
                                <div class="stat-label">Total Blocks</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${player.lastGamePoints || 0}</div>
                                <div class="stat-label">Last Game Points</div>
                            </div>
                        </div>
                    </div>
                    
                    ${player.lastGameDate ? `
                        <div style="margin-top: 1rem; text-align: center; opacity: 0.8;">
                            <small><strong>Last Game:</strong> ${player.lastGameDate}</small>
                        </div>
                    ` : ''}
                `;
                document.getElementById('modal').style.display = 'block';
            }
        };

        // ========================================
        // PLAYOFF MANAGER
        // ========================================
        const PlayoffManager = {
            showPlayoffBracket: () => {
                const division = document.getElementById('playoffs-division-filter').value;
                const container = document.getElementById('playoff-bracket-container');
                const structure = LeagueConfig[division];
                
                if (!structure) {
                    container.innerHTML = '<div class="loading"><p>Playoff structure not defined for this division.</p></div>';
                    return;
                }

                const teams = AppData.teams[division].map(team => team.name);
                const divisionResults = AppData.results.filter(r => r.division === division && r.played);
                
                const standings = teams.map(teamName => {
                    const teamResults = divisionResults.filter(result => 
                        result.homeTeam === teamName || result.awayTeam === teamName
                    );

                    let wins = 0, losses = 0, pointsFor = 0, pointsAgainst = 0;

                    teamResults.forEach(result => {
                        const isHome = result.homeTeam === teamName;
                        const teamScore = isHome ? result.homeScore : result.awayScore;
                        const opponentScore = isHome ? result.awayScore : result.homeScore;

                        pointsFor += teamScore;
                        pointsAgainst += opponentScore;

                        if (!result.forfeit) {
                            if (teamScore > opponentScore) wins++;
                            else losses++;
                        }
                    });

                    const totalPoints = (wins * 2) + (losses * 1);
                    return {
                        team: teamName,
                        wins,
                        losses,
                        pointsFor,
                        pointsAgainst,
                        points: totalPoints
                    };
                });

                standings.sort((a, b) => {
                    if (b.points !== a.points) return b.points - a.points;
                    return (b.pointsFor - b.pointsAgainst) - (a.pointsFor - a.pointsAgainst);
                });

                let html = `<div class="playoff-bracket">`;
                
                if (division === 'first') {
                    const qualifiedTeams = standings.slice(0, 6);
                    html += `
                        <h3><i class="fas fa-trophy"></i> First Division Playoff Progression</h3>
                        <div class="bracket-round">
                            <h4>Round Robin Qualifiers (Top 6)</h4>
                            ${qualifiedTeams.map((team, index) => `
                                <div class="bracket-match">
                                    <div class="bracket-team ${index < 4 ? 'winner' : ''}">
                                        <span>${index + 1}. ${team.team}</span>
                                        <span>${team.points} pts</span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        <div class="bracket-round">
                            <h4>Big Four Playoffs</h4>
                            ${qualifiedTeams.slice(0, 4).map((team, index) => `
                                <div class="bracket-match">
                                    <div class="bracket-team ${index < 2 ? 'winner' : ''}">
                                        <span>${index + 1}. ${team.team}</span>
                                        <span>Qualified</span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        <div class="bracket-round">
                            <h4>Finals</h4>
                            ${qualifiedTeams.slice(0, 2).map((team, index) => `
                                <div class="bracket-match">
                                    <div class="bracket-team winner">
                                        <span>${index + 1}. ${team.team}</span>
                                        <span>Finalist</span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                } else if (division === 'second') {
                    const qualifiedTeams = standings.slice(0, 10);
                    const subDiv1 = qualifiedTeams.slice(0, 5);
                    const subDiv2 = qualifiedTeams.slice(5, 10);
                    const superSix = [...subDiv1.slice(0, 3), ...subDiv2.slice(0, 3)];
                    
                    html += `
                        <h3><i class="fas fa-trophy"></i> Second Division Playoff Progression</h3>
                        <div class="bracket-round">
                            <h4>Round Robin Qualifiers (Top 10)</h4>
                            ${qualifiedTeams.map((team, index) => `
                                <div class="bracket-match">
                                    <div class="bracket-team winner">
                                        <span>${index + 1}. ${team.team}</span>
                                        <span>${team.points} pts</span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        <div class="bracket-round">
                            <h4>Sub-Division A</h4>
                            ${subDiv1.map((team, index) => `
                                <div class="bracket-match">
                                    <div class="bracket-team ${index < 3 ? 'winner' : ''}">
                                        <span>${team.team}</span>
                                        <span>${index < 3 ? 'To Super Six' : 'Eliminated'}</span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        <div class="bracket-round">
                            <h4>Sub-Division B</h4>
                            ${subDiv2.map((team, index) => `
                                <div class="bracket-match">
                                    <div class="bracket-team ${index < 3 ? 'winner' : ''}">
                                        <span>${team.team}</span>
                                        <span>${index < 3 ? 'To Super Six' : 'Eliminated'}</span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        <div class="bracket-round">
                            <h4>Super Six Playoffs</h4>
                            ${superSix.map((team) => `
                                <div class="bracket-match">
                                    <div class="bracket-team winner">
                                        <span>${team.team}</span>
                                        <span>Super Six</span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                } else if (division === 'female') {
                    const qualifiedTeams = standings.slice(0, 4);
                    html += `
                        <h3><i class="fas fa-female"></i> Female Division Playoff Progression</h3>
                        <div class="bracket-round">
                            <h4>Round Robin Qualifiers (Top 4)</h4>
                            ${qualifiedTeams.map((team, index) => `
                                <div class="bracket-match">
                                    <div class="bracket-team ${index < 2 ? 'winner' : ''}">
                                        <span>${index + 1}. ${team.team}</span>
                                        <span>${team.points} pts</span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        <div class="bracket-round">
                            <h4>Finals</h4>
                            ${qualifiedTeams.slice(0, 2).map((team, index) => `
                                <div class="bracket-match">
                                    <div class="bracket-team winner">
                                        <span>${index + 1}. ${team.team}</span>
                                        <span>Finalist</span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                } else {
                    const qualifiedTeams = standings.slice(0, 3);
                    html += `
                        <h3><i class="fas fa-medal"></i> ${Utils.getDivisionName(division)} Playoff Progression</h3>
                        <div class="bracket-round">
                            <h4>Playoff Qualifiers (Top 3)</h4>
                            ${qualifiedTeams.map((team, index) => `
                                <div class="bracket-match">
                                    <div class="bracket-team winner">
                                        <span>${index + 1}. ${team.team}</span>
                                        <span>${team.points} pts</span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                }

                html += `</div>`;
                
                html += `
                    <div style="margin-top: 2rem; padding: 1.5rem; background: rgba(255, 255, 255, 0.05); border-radius: 15px;">
                        <h4><i class="fas fa-info-circle"></i> ${Utils.getDivisionName(division)} Structure</h4>
                        <p><strong>Total Teams:</strong> ${structure.teams}</p>
                        <p><strong>Games per Team:</strong> ${structure.gamesPerTeam || 'Variable'}</p>
                        <p><strong>Playoff Format:</strong> ${structure.rounds ? structure.rounds.join(' → ') : 'Standard elimination'}</p>
                        ${structure.subDivisions ? `<p><strong>Sub-divisions:</strong> ${structure.subDivisions} (${structure.teamsPerSubDivision} teams each)</p>` : ''}
                    </div>
                `;

                container.innerHTML = html;
            }
        };

        // ========================================
        // STATS MANAGER
        // ========================================
        const StatsManager = {
            updateQuickStats: () => {
                let totalTeams = 0;
                Object.keys(AppData.teams).forEach(division => {
                    totalTeams += AppData.teams[division].length;
                });

                const totalGames = AppData.results.length;
                const totalFixtures = AppData.fixtures.length;

                document.getElementById('total-teams').textContent = totalTeams;
                document.getElementById('total-games').textContent = totalGames;
                document.getElementById('total-fixtures').textContent = totalFixtures;
            },

            loadHomeData: () => {
                StatsManager.updateQuickStats();
                NewsManager.renderHome();
            }
        };

        // ========================================
        // ADMIN MANAGER
        // ========================================
        const AdminManager = {
            showTab: (tabName) => {
                document.querySelectorAll('.admin-tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                event.target.classList.add('active');

                document.querySelectorAll('.admin-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(`admin-${tabName}`).classList.add('active');

                switch(tabName) {
                    case 'fixtures':
                        FixtureManager.updateFixtureTeams();
                        AdminManager.renderFixtures();
                        break;
                    case 'matches':
                        ResultManager.updateMatchTeams();
                        break;
                    case 'news':
                        AdminManager.renderNews();
                        break;
                    case 'stats':
                        PlayerManager.updatePlayerTeams();
                        break;
                    case 'results':
                        setTimeout(() => {
                            AdminManager.renderResults();
                        }, 500);
                        break;
                }
            },

            renderNews: () => {
                const container = document.getElementById('admin-news-list');
                let html = '<h4><i class="fas fa-list"></i> Published Articles:</h4>';
                
                if (AppData.news.length === 0) {
                    html += '<p style="text-align: center; opacity: 0.7;">No news articles yet.</p>';
                } else {
                    AppData.news.forEach(article => {
                        const commentCount = AppData.comments[article.id] ? AppData.comments[article.id].length : 0;
                        html += `
                            <div class="card" style="margin-bottom: 1rem;">
                                <div style="display: flex; justify-content: space-between; align-items: flex-start; gap: 1rem;">
                                    <div style="flex: 1;">
                                        <h4>${article.title}</h4>
                                        <p style="opacity: 0.7; margin: 0.5rem 0;">${article.date}</p>
                                        <p>${article.content.substring(0, 100)}${article.content.length > 100 ? '...' : ''}</p>
                                        <small style="opacity: 0.6;"><i class="fas fa-comments"></i> ${commentCount} comments</small>
                                    </div>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="btn btn-danger" style="padding: 0.5rem 1rem; font-size: 0.8rem;" onclick="NewsManager.removeNews('${article.id}')">
                                            <i class="fas fa-trash"></i> Remove
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                }
                container.innerHTML = html;
            },

            renderTeams: () => {
                const container = document.getElementById('admin-teams-list');
                let html = '<h4><i class="fas fa-list"></i> Current Teams:</h4>';
                let hasTeams = false;

                Object.keys(AppData.teams).forEach(division => {
                    if (AppData.teams[division].length > 0) {
                        hasTeams = true;
                        html += `<h5>${Utils.getDivisionName(division)}:</h5>`;
                        AppData.teams[division].forEach(team => {
                            html += `
                                <div class="card" style="margin-bottom: 0.5rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div style="display: flex; align-items: center; gap: 1rem;">
                                            <div class="mobile-team-logo">${team.name.charAt(0)}</div>
                                            <span>${team.name}</span>
                                        </div>
                                        <button class="btn btn-danger" style="padding: 0.5rem 1rem; font-size: 0.8rem;" onclick="TeamManager.removeTeam('${team.id}')">
                                            <i class="fas fa-trash"></i> Remove
                                        </button>
                                    </div>
                                </div>
                            `;
                        });
                    }
                });

                if (!hasTeams) {
                    html += '<p style="text-align: center; opacity: 0.7;">No teams added yet.</p>';
                }
                container.innerHTML = html;
            },

            renderFixtures: () => {
                const container = document.getElementById('admin-fixtures-list');
                const upcomingFixtures = AppData.fixtures.filter(f => !f.played).sort((a, b) => new Date(a.date) - new Date(b.date));
                let html = '<h4><i class="fas fa-calendar-alt"></i> Upcoming Fixtures:</h4>';

                if (upcomingFixtures.length === 0) {
                    html += '<p style="text-align: center; opacity: 0.7;">No upcoming fixtures scheduled.</p>';
                } else {
                    upcomingFixtures.forEach(fixture => {
                        html += `
                            <div class="card" style="margin-bottom: 1rem;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <strong><i class="fas fa-medal"></i> ${Utils.getDivisionName(fixture.division)}</strong><br>
                                        <span>${fixture.homeTeam} vs ${fixture.awayTeam}</span><br>
                                        <small><i class="fas fa-calendar-alt"></i> ${fixture.date} <i class="fas fa-clock"></i> ${fixture.time}</small>
                                    </div>
                                    <button class="btn btn-danger" style="padding: 0.5rem 1rem; font-size: 0.8rem;" onclick="FixtureManager.removeFixture('${fixture.id}')">
                                        <i class="fas fa-trash"></i> Remove
                                    </button>
                                </div>
                            </div>
                        `;
                    });
                }
                container.innerHTML = html;
            },

            renderResults: () => {
                const container = document.getElementById('admin-results-list');
                const selectedDivision = document.getElementById('admin-results-division-filter').value;

                if (!AppData.results || AppData.results.length === 0) {
                    container.innerHTML = '<p style="text-align: center; opacity: 0.7;">No results loaded yet.</p>';
                    return;
                }

                let results = AppData.results.filter(r => r.played);
                if (selectedDivision !== 'all') {
                    results = results.filter(r => r.division === selectedDivision);
                }
                results.sort((a, b) => new Date(b.date) - new Date(a.date));

                let html = '<h4><i class="fas fa-clipboard-list"></i> Recorded Results:</h4>';
                if (results.length === 0) {
                    html += '<p style="text-align: center; opacity: 0.7;">No results recorded for this division.</p>';
                } else {
                    results.forEach(result => {
                        let resultText;
                        if (result.forfeit) {
                            const forfeitingTeam = result.forfeitTeam === 'home' ? result.homeTeam : result.awayTeam;
                            resultText = `FORFEIT by ${forfeitingTeam}`;
                        } else {
                            resultText = `${result.homeScore} - ${result.awayScore}`;
                        }

                        html += `
                            <div class="card" style="margin-bottom: 1rem;">
                                <div style="display: flex; justify-content: space-between; align-items: flex-start; gap: 1rem;">
                                    <div style="flex: 1;">
                                        <strong><i class="fas fa-medal"></i> ${Utils.getDivisionName(result.division)}</strong><br>
                                        <span>${result.homeTeam} vs ${result.awayTeam}</span><br>
                                        <small><i class="fas fa-calendar-alt"></i> ${result.date}</small><br>
                                        <span><strong>Result:</strong> ${resultText}</span>
                                    </div>
                                    <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                                        <button class="btn btn-danger" style="padding: 0.5rem 1rem; font-size: 0.8rem;" onclick="ResultManager.removeResult('${result.id}')">
                                            <i class="fas fa-trash"></i> Remove Result
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                }
                container.innerHTML = html;
            }
        };

        // ========================================
        // MODAL MANAGER
        // ========================================
        const ModalManager = {
            closeModal: () => {
                document.getElementById('modal').style.display = 'none';
            },

            closeNewsModal: () => {
                document.getElementById('news-modal').style.display = 'none';
                CommentManager.currentNewsId = null;
            }
        };

        // ========================================
        // TEAM MANAGER
        // ========================================
        const TeamManager = {
            addTeam: async () => {
                const division = document.getElementById('team-division').value;
                const name = document.getElementById('team-name').value.trim();

                if (!name) {
                    alert('Please enter a team name');
                    return;
                }

                const existingTeam = AppData.teams[division].find(team => team.name === name);
                if (existingTeam) {
                    alert('Team name already exists in this division');
                    return;
                }

                try {
                    await db.collection("teams").add({
                        division,
                        name,
                        timestamp: firebase.firestore.FieldValue.serverTimestamp()
                    });

                    document.getElementById('team-name').value = '';
                    alert('Team added successfully!');
                } catch (error) {
                    console.error("Error adding team:", error);
                    alert('Error adding team. Please try again.');
                }
            },

            removeTeam: async (teamId) => {
                if (!confirm('Are you sure you want to remove this team?')) {
                    return;
                }
                
                try {
                    await db.collection("teams").doc(teamId).delete();
                    alert('Team removed successfully!');
                } catch (error) {
                    console.error("Error removing team:", error);
                    alert('Error removing team. Please try again.');
                }
            },

            showTeamDetails: async (division, teamName) => {
                const results = AppData.results.filter(result => 
                    result.division === division && 
                    (result.homeTeam === teamName || result.awayTeam === teamName)
                );

                let wins = 0, losses = 0, forfeits = 0, totalPointsScored = 0, totalPointsConceded = 0;

                results.forEach(result => {
                    const isHome = result.homeTeam === teamName;
                    const teamScore = isHome ? result.homeScore : result.awayScore;
                    const opponentScore = isHome ? result.awayScore : result.homeScore;

                    totalPointsScored += teamScore;
                    totalPointsConceded += opponentScore;

                    if (result.forfeit) {
                        if ((isHome && result.forfeitTeam === 'home') || (!isHome && result.forfeitTeam === 'away')) {
                            forfeits++;
                        } else {
                            wins++;
                        }
                    } else {
                        if (teamScore > opponentScore) {
                            wins++;
                        } else {
                            losses++;
                        }
                    }
                });

                const totalLeaguePoints = (wins * 2) + (losses * 1) + (forfeits * 0);
                const avgPointsScored = Utils.calculateAverage(totalPointsScored, results.length);
                const avgPointsConceded = Utils.calculateAverage(totalPointsConceded, results.length);
                const winRate = results.length > 0 ? ((wins/results.length) * 100).toFixed(1) : 0;

                let html = `
                    <div style="text-align: center;">
                        <div class="mobile-team-logo" style="margin: 0 auto 2rem;">${teamName.charAt(0)}</div>
                        <h2>${teamName}</h2>
                        <p style="opacity: 0.8; margin-bottom: 2rem;"><strong>Division:</strong> ${Utils.getDivisionName(division)}</p>
                    </div>
                    <div class="mobile-table-replacement">
                        <div class="mobile-standings">
                            <div class="mobile-standings-header">
                                <span><i class="fas fa-chart-line"></i> Season Statistics</span>
                            </div>
                            <div class="mobile-team-row">
                                <div class="mobile-team-info"><strong>Games Played</strong></div>
                                <div class="mobile-team-stats">${results.length}</div>
                            </div>
                            <div class="mobile-team-row">
                                <div class="mobile-team-info"><strong>Wins</strong></div>
                                <div class="mobile-team-stats status-win">${wins}</div>
                            </div>
                            <div class="mobile-team-row">
                                <div class="mobile-team-info"><strong>Losses</strong></div>
                                <div class="mobile-team-stats status-loss">${losses}</div>
                            </div>
                            <div class="mobile-team-row">
                                <div class="mobile-team-info"><strong>Forfeits</strong></div>
                                <div class="mobile-team-stats status-forfeit">${forfeits}</div>
                            </div>
                            <div class="mobile-team-row">
                                <div class="mobile-team-info"><strong>Average Points Scored</strong></div>
                                <div class="mobile-team-stats">${avgPointsScored}</div>
                            </div>
                            <div class="mobile-team-row">
                                <div class="mobile-team-info"><strong>League Points</strong></div>
                                <div class="mobile-team-stats" style="color: var(--accent-color); font-weight: bold;">${totalLeaguePoints}</div>
                            </div>
                            <div class="mobile-team-row">
                                <div class="mobile-team-info"><strong>Win Rate</strong></div>
                                <div class="mobile-team-stats">${winRate}%</div>
                            </div>
                        </div>
                    </div>
                `;

                // Recent results
                if (results.length > 0) {
                    html += `<h3 style="margin: 2rem 0 1rem;"><i class="fas fa-history"></i> Recent Results</h3>`;
                    const recentResults = results.slice(-5).reverse();
                    recentResults.forEach(result => {
                        const isHome = result.homeTeam === teamName;
                        const opponent = isHome ? result.awayTeam : result.homeTeam;
                        const teamScore = isHome ? result.homeScore : result.awayScore;
                        const opponentScore = isHome ? result.awayScore : result.homeScore;
                        
                        let outcome, outcomeClass, resultText;
                        
                        if (result.forfeit) {
                            if ((isHome && result.forfeitTeam === 'home') || (!isHome && result.forfeitTeam === 'away')) {
                                outcome = 'F';
                                outcomeClass = 'status-forfeit';
                                resultText = 'FORFEIT';
                            } else {
                                outcome = 'W';
                                outcomeClass = 'status-win';
                                resultText = 'WIN (Opponent Forfeit)';
                            }
                        } else {
                            if (teamScore > opponentScore) {
                                outcome = 'W';
                                outcomeClass = 'status-win';
                                resultText = `${teamScore} - ${opponentScore}`;
                            } else {
                                outcome = 'L';
                                outcomeClass = 'status-loss';
                                resultText = `${teamScore} - ${opponentScore}`;
                            }
                        }

                        html += `
                            <div class="mobile-match-card">
                                <div class="mobile-match-body">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <span>${isHome ? 'vs' : '@'} ${opponent}</span>
                                        <span><strong>${resultText}</strong></span>
                                        <span class="${outcomeClass}" style="padding: 0.3rem 0.8rem; border-radius: 8px; font-weight: bold;">${outcome}</span>
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                } else {
                    html += '<div class="loading"><p>No games played yet.</p></div>';
                }

                document.getElementById('modal-title').innerHTML = `<i class="fas fa-user"></i> Team Details`;
                document.getElementById('modal-body').innerHTML = html;
                document.getElementById('modal').style.display = 'block';
            }
        };

        // ========================================
        // DIVISION MANAGER
        // ========================================
        const DivisionManager = {
            showDivisionDetails: (division) => {
                document.getElementById('division-title').innerHTML = `<i class="fas fa-trophy"></i> ${Utils.getDivisionName(division)}`;
                DivisionManager.renderDivisionTeams(division);
                DivisionManager.renderMobileDivisionStandings(division);
                const standingsBtn = document.getElementById('standings-btn');
                if (standingsBtn) {
                    standingsBtn.onclick = function() { StandingsManager.showStandings(division); };
                }
                NavigationManager.showSection('division-details');
            },

            renderDivisionTeams: (division) => {
                const container = document.getElementById('division-teams');
                const teams = AppData.teams[division] || [];
                
                let html = '';
                if (teams.length === 0) {
                    html = '<div class="loading"><p>No teams in this division yet.</p></div>';
                } else {
                    teams.forEach(team => {
                        html += `
                            <div class="card team-card" onclick="TeamManager.showTeamDetails('${division}', '${team.name}')">
                                <div class="mobile-team-logo" style="margin: 0 auto 1rem;">${team.name.charAt(0)}</div>
                                <h4>${team.name}</h4>
                            </div>
                        `;
                    });
                }
                container.innerHTML = html;
            },

            renderMobileDivisionStandings: (division) => {
                const container = document.getElementById('mobile-division-standings');
                const teams = AppData.teams[division].map(team => team.name);
                const divisionResults = AppData.results.filter(r => r.division === division && r.played);
                
                const standings = teams.map(teamName => {
                    const teamResults = divisionResults.filter(result => 
                        result.homeTeam === teamName || result.awayTeam === teamName
                    );

                    let wins = 0, losses = 0, forfeits = 0, pointsFor = 0, pointsAgainst = 0;

                    teamResults.forEach(result => {
                        const isHome = result.homeTeam === teamName;
                        const teamScore = isHome ? result.homeScore : result.awayScore;
                        const opponentScore = isHome ? result.awayScore : result.homeScore;

                        pointsFor += teamScore;
                        pointsAgainst += opponentScore;

                        if (result.forfeit) {
                            if ((isHome && result.forfeitTeam === 'home') || (!isHome && result.forfeitTeam === 'away')) {
                                forfeits++;
                            } else {
                                wins++;
                            }
                        } else {
                            if (teamScore > opponentScore) {
                                wins++;
                            } else {
                                losses++;
                            }
                        }
                    });

                    const totalPoints = (wins * 2) + (losses * 1) + (forfeits * 0);
                    return {
                        team: teamName,
                        played: teamResults.length,
                        wins,
                        losses,
                        forfeits,
                        pointsFor,
                        pointsAgainst,
                        points: totalPoints
                    };
                });

                standings.sort((a, b) => {
                    if (b.points !== a.points) return b.points - a.points;
                    if (b.pointsFor - b.pointsAgainst !== a.pointsFor - a.pointsAgainst) 
                        return (b.pointsFor - b.pointsAgainst) - (a.pointsFor - a.pointsAgainst);
                    return b.pointsFor - a.pointsFor;
                });

                let html = `
                    <div class="mobile-standings">
                        <div class="mobile-standings-header">
                            <span><i class="fas fa-trophy"></i> ${Utils.getDivisionName(division)} Standings</span>
                            <span>GP: Games • W: Wins • Pts: Points</span>
                        </div>
                `;

                standings.forEach((team, index) => {
                    const structure = LeagueConfig[division];
                    const qualifiesForPlayoffs = index < (structure?.playoffTeams || 0);

                    html += `
                        <div class="mobile-team-row" onclick="TeamManager.showTeamDetails('${division}', '${team.team}')">
                            <div class="mobile-team-info">
                                <div class="mobile-team-position" style="${qualifiesForPlayoffs ? 'background: #4CAF50;' : 'background: var(--fiba-orange);'}">${index + 1}</div>
                                <div class="mobile-team-name">${team.team}</div>
                            </div>
                            <div class="mobile-team-stats">
                                <div class="mobile-stat">
                                    <div class="mobile-stat-value">${team.played}</div>
                                    <div class="mobile-stat-label">GP</div>
                                </div>
                                <div class="mobile-stat">
                                    <div class="mobile-stat-value status-win">${team.wins}</div>
                                    <div class="mobile-stat-label">W</div>
                                </div>
                                <div class="mobile-stat">
                                    <div class="mobile-stat-value">${team.points}</div>
                                    <div class="mobile-stat-label">Pts</div>
                                </div>
                            </div>
                        </div>
                    `;
                });

                html += '</div>';

                const structure = LeagueConfig[division];
                if (structure) {
                    html += `
                        <div style="margin-top: 1rem; padding: 1rem; background: rgba(255, 255, 255, 0.05); border-radius: 10px; font-size: 0.9rem;">
                            <h4 style="margin-bottom: 0.5rem;"><i class="fas fa-info-circle"></i> Playoff Structure</h4>
                            <p><strong>Teams:</strong> ${structure.teams} • <strong>Games per team:</strong> ${structure.gamesPerTeam || 'Variable'}</p>
                            <p><strong>Playoff spots:</strong> Top ${structure.playoffTeams} teams advance</p>
                            ${structure.finalTeams ? `<p><strong>Finals:</strong> Top ${structure.finalTeams} teams</p>` : ''}
                        </div>
                    `;
                }

                container.innerHTML = html;
            }
        };

        // ========================================
        // INITIALIZATION
        // ========================================
        document.addEventListener('DOMContentLoaded', function() {
            DataLoader.init();
            NavigationManager.init();
            
            // Auto-update player teams dropdown when division filter changes
            document.getElementById('players-division-filter').addEventListener('change', function() {
                PlayerManager.updatePlayerTeams();
                PlayerManager.filterPlayers();
            });
            
            // Initialize playoff bracket
            PlayoffManager.showPlayoffBracket();
        });

        // ========================================
        // GLOBAL FUNCTION BINDINGS
        // ========================================
        window.adminAccess = NavigationManager.adminAccess;
        window.toggleAdmin = NavigationManager.toggleAdmin;
    </script>
</body>
</html>
